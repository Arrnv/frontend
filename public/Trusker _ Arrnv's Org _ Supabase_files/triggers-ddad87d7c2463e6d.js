!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="0bd27b60-aacc-4bb7-a91e-40265289a115",e._sentryDebugIdIdentifier="sentry-dbid-0bd27b60-aacc-4bb7-a91e-40265289a115")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4253,4986],{2356:(e,t,n)=>{"use strict";n.d(t,{F:()=>m});var a=n(80263),s=n(53239),r=n(70800),i=n(55071),l=n(41699),o=n(70758),c=n(54753),d=n(25643);let u={danger:(0,a.jsx)(i.A,{strokeWidth:1.5,size:18}),success:(0,a.jsx)(l.A,{strokeWidth:1.5,size:18}),warning:(0,a.jsx)(o.A,{strokeWidth:1.5,size:18}),info:(0,a.jsx)(c.A,{strokeWidth:1.5,size:18}),neutral:(0,a.jsx)(a.Fragment,{})};function m(e){let{variant:t="neutral",className:n,title:i,withIcon:l,closable:o,children:c,icon:m,actions:h}=e,g=(0,r.A)("alert"),[x,f]=(0,s.useState)(!0),p=[g.base];p.push(g.variant[t].base),n&&p.push(n);let j=[g.description,g.variant[t].description],v=[g.close];return(0,a.jsx)(a.Fragment,{children:x&&(0,a.jsxs)("div",{className:p.join(" "),children:[l?(0,a.jsx)("div",{className:g.variant[t].icon,children:l&&u[t]}):null,m&&m,(0,a.jsxs)("div",{className:"flex flex-1 items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:[g.variant[t].header,g.header].join(" "),children:i}),(0,a.jsx)("div",{className:j.join(" "),children:c})]}),h]}),o&&(0,a.jsx)("button",{"aria-label":"Close alert",onClick:()=>f(!1),className:v.join(" "),children:(0,a.jsx)(d.A,{strokeWidth:2,size:16})})]})})}},5043:(e,t,n)=>{"use strict";n.d(t,{Lh:()=>u,T_:()=>x});var a=n(32144),s=n(80251),r=n(73969),i=n(26616),l=n.n(i),o=n(15629),c=n(48054),d=n(92403);let u="pgmq_public",m=l()("\ncreate schema if not exists ".concat(u,";\ngrant usage on schema ").concat(u," to postgres, anon, authenticated, service_role;\n\ncreate or replace function ").concat(u,".pop(\n    queue_name text\n)\n  returns setof pgmq.message_record\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.pop(\n        queue_name := queue_name\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".pop(queue_name text) is 'Retrieves and locks the next message from the specified queue.';\n\n\ncreate or replace function ").concat(u,".send(\n    queue_name text,\n    message jsonb,\n    sleep_seconds integer default 0  -- renamed from 'delay'\n)\n  returns setof bigint\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.send(\n        queue_name := queue_name,\n        msg := message,\n        delay := sleep_seconds\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".send(queue_name text, message jsonb, sleep_seconds integer) is 'Sends a message to the specified queue, optionally delaying its availability by a number of seconds.';\n\n\ncreate or replace function ").concat(u,".send_batch(\n    queue_name text,\n    messages jsonb[],\n    sleep_seconds integer default 0  -- renamed from 'delay'\n)\n  returns setof bigint\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.send_batch(\n        queue_name := queue_name,\n        msgs := messages,\n        delay := sleep_seconds\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".send_batch(queue_name text, messages jsonb[], sleep_seconds integer) is 'Sends a batch of messages to the specified queue, optionally delaying their availability by a number of seconds.';\n\n\ncreate or replace function ").concat(u,".archive(\n    queue_name text,\n    message_id bigint\n)\n  returns boolean\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return\n    pgmq.archive(\n        queue_name := queue_name,\n        msg_id := message_id\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".archive(queue_name text, message_id bigint) is 'Archives a message by moving it from the queue to a permanent archive.';\n\n\ncreate or replace function ").concat(u,".delete(\n    queue_name text,\n    message_id bigint\n)\n  returns boolean\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return\n    pgmq.delete(\n        queue_name := queue_name,\n        msg_id := message_id\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".delete(queue_name text, message_id bigint) is 'Permanently deletes a message from the specified queue.';\n\ncreate or replace function ").concat(u,".read(\n    queue_name text,\n    sleep_seconds integer,\n    n integer\n)\n  returns setof pgmq.message_record\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.read(\n        queue_name := queue_name,\n        vt := sleep_seconds,\n        qty := n\n    );\nend;\n$$;\n\ncomment on function ").concat(u,'.read(queue_name text, sleep_seconds integer, n integer) is \'Reads up to "n" messages from the specified queue with an optional "sleep_seconds" (visibility timeout).\';\n\n-- Grant execute permissions on wrapper functions to roles\ngrant execute on function ').concat(u,".pop(text) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.pop(text) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".send(text, jsonb, integer) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.send(text, jsonb, integer) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".send_batch(text, jsonb[], integer) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.send_batch(text, jsonb[], integer) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".archive(text, bigint) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.archive(text, bigint) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".delete(text, bigint) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.delete(text, bigint) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".read(text, integer, integer) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.read(text, integer, integer) to postgres, service_role, anon, authenticated;\n\n-- For the service role, we want full access\n-- Grant permissions on existing tables\ngrant all privileges on all tables in schema pgmq to postgres, service_role;\n\n-- Ensure service_role has permissions on future tables\nalter default privileges in schema pgmq grant all privileges on tables to postgres, service_role;\n\ngrant usage on schema pgmq to postgres, anon, authenticated, service_role;\n\n\n/*\n  Grant access to sequences to API roles by default. Existing table permissions\n  continue to enforce insert restrictions. This is necessary to accommodate the\n  on-backup hook that rebuild queue table primary keys to avoid a pg_dump segfault.\n  This can be removed once logical backups are completely retired.\n*/\ngrant usage, select, update\non all sequences in schema pgmq\nto anon, authenticated, service_role;\n\nalter default privileges in schema pgmq\ngrant usage, select, update\non sequences\nto anon, authenticated, service_role;\n")),h=l()("\n  drop function if exists \n    ".concat(u,".pop(queue_name text),\n    ").concat(u,".send(queue_name text, message jsonb, sleep_seconds integer),\n    ").concat(u,".send_batch(queue_name text, message jsonb[], sleep_seconds integer),\n    ").concat(u,".archive(queue_name text, message_id bigint),\n    ").concat(u,".delete(queue_name text, message_id bigint),\n    ").concat(u,".read(queue_name text, sleep integer, n integer)\n  ;\n\n  -- Revoke execute permissions on inner pgmq functions to roles (inverse of enabling)\n  do $$\n  begin\n      if exists (select 1 from pg_namespace where nspname = 'pgmq') then\n          -- Revoke privileges on the schema itself\n          revoke all on schema pgmq from anon, authenticated, service_role;\n          \n          -- Revoke default privileges for future objects\n          alter default privileges in schema pgmq revoke all on tables from anon, authenticated, service_role;\n          alter default privileges in schema pgmq revoke all on sequences from anon, authenticated, service_role;\n          alter default privileges in schema pgmq revoke all on functions from anon, authenticated, service_role;\n      end if;\n  end $$;\n\n  drop schema if exists ").concat(u,";\n"));async function g(e){let{projectRef:t,connectionString:n,enable:a}=e,{result:s}=await (0,o.E)({projectRef:t,connectionString:n,sql:a?m:h,queryKey:["toggle-queues-exposure"]});return s}let x=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,a.jE)();return(0,s.n)(e=>g(e),{async onSuccess(t,n,a){let{projectRef:s}=n;await i.invalidateQueries(c.m.exposePostgrestStatus(s)),i.invalidateQueries(d.c.schemas(s)),await (null==e?void 0:e(t,n,a))},async onError(e,n,a){void 0===t?r.oR.error("Failed to toggle queue exposure via PostgREST: ".concat(e.message)):t(e,n,a)},...n})}},12006:(e,t,n)=>{"use strict";n.d(t,{RB:()=>l,ov:()=>o});var a=n(56947),s=n(15629),r=n(48895);let i=()=>"\n    select\n      s.oid as \"id\",\n      w.fdwname as \"name\",\n      s.srvname as \"server_name\",\n      s.srvoptions as \"server_options\",\n      c.proname as \"handler\",\n      (\n        select jsonb_agg(\n          jsonb_build_object(\n            'id', c.oid::bigint,\n            'schema', relnamespace::regnamespace::text,\n            'name', c.relname,\n            'columns', (\n              select jsonb_agg(\n                jsonb_build_object(\n                  'name', a.attname,\n                  'type', pg_catalog.format_type(a.atttypid, a.atttypmod)\n                )\n              )\n              from pg_catalog.pg_attribute a\n              where a.attrelid = c.oid and a.attnum > 0 and not a.attisdropped\n            ),\n            'options', t.ftoptions\n          )\n        )\n        from pg_catalog.pg_class c\n        join pg_catalog.pg_foreign_table t on c.oid = t.ftrelid\n        where c.oid = any (select t.ftrelid from pg_catalog.pg_foreign_table t where t.ftserver = s.oid)\n      ) as \"tables\"\n    from pg_catalog.pg_foreign_server s\n    join pg_catalog.pg_foreign_data_wrapper w on s.srvfdw = w.oid\n    join pg_catalog.pg_proc c on w.fdwhandler = c.oid;\n  ";async function l(e,t){let{projectRef:n,connectionString:a}=e,r=i(),{result:l}=await (0,s.E)({projectRef:n,connectionString:a,sql:r,queryKey:["fdws"]},t);return l}let o=function(e){let{projectRef:t,connectionString:n}=e,{enabled:s=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(r.Y.list(t),e=>{let{signal:a}=e;return l({projectRef:t,connectionString:n},a)},{enabled:s&&void 0!==t,...i})}},14528:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var a=n(80263),s=n(58378),r=n(69724),i=n(23445),l=n(15601),o=n.n(l),c=n(53239),d=n(40022);let u=(0,c.forwardRef)((e,t)=>{let{icon:n,title:l,description:u,url:m,urlLabel:h="Read more",defaultVisibility:g=!1,hideCollapse:x=!1,button:f,className:p="",block:j=!1}=e,[v,y]=(0,c.useState)(g);return(0,a.jsx)("div",{ref:t,role:"alert",className:"".concat(j?"block w-full":"","\n      block w-full rounded-md border bg-surface-300/25 py-3 ").concat(p),children:(0,a.jsxs)("div",{className:"flex flex-col px-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex w-full space-x-3 items-center",children:[n&&(0,a.jsx)("span",{className:"text-foreground-lighter",children:n}),(0,a.jsx)("div",{className:"flex-grow",children:(0,a.jsx)("h5",{className:"text-foreground",children:l})})]}),u&&!x?(0,a.jsx)("div",{className:"cursor-pointer text-foreground-lighter",onClick:()=>y(!v),children:v?(0,a.jsx)(s.A,{size:14,strokeWidth:1.5}):(0,a.jsx)(r.A,{size:14,strokeWidth:1.5})}):null]}),(u||m||f)&&(0,a.jsxs)("div",{className:"flex flex-col space-y-3 overflow-hidden transition-all ".concat(v?"mt-3":""),style:{maxHeight:500*!!v},children:[(0,a.jsx)("div",{className:"text-foreground-light text-sm",children:u}),m&&(0,a.jsx)("div",{children:(0,a.jsx)(d.$,{asChild:!0,type:"default",icon:(0,a.jsx)(i.A,{}),children:(0,a.jsx)(o(),{href:m,target:"_blank",rel:"noreferrer",children:h})})}),f&&(0,a.jsx)("div",{children:f})]})]})})});u.displayName="InformationBox";let m=u},24771:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var a=n(80263);n(53239);let s=function(e){let{children:t,target:n="_blank",href:s,className:r,onClick:i,style:l}=e;return(0,a.jsx)("a",{onClick:i,href:s,target:n,rel:"noopener noreferrer",style:l,"data-sentry-component":"Link","data-sentry-source-file":"Link.tsx",children:t})}},25176:(e,t,n)=>{"use strict";n.d(t,{Y:()=>d});var a=n(32144),s=n(80251),r=n(73969),i=n(47319),l=n(35021),o=n(15629);async function c(e){let{projectRef:t,connectionString:n,payload:a}=e,{sql:s}=i.A.triggers.create(a),{result:r}=await (0,o.E)({projectRef:t,connectionString:n,sql:s,queryKey:["trigger","create"]});return r}let d=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,a.jE)();return(0,s.n)(e=>c(e),{async onSuccess(t,n,a){let{projectRef:s}=n;await i.invalidateQueries(l.U.list(s)),await (null==e?void 0:e(t,n,a))},async onError(e,n,a){void 0===t?r.oR.error("Failed to create database trigger: ".concat(e.message)):t(e,n,a)},...n})}},43242:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>h});var a=n(80263),s=n(53239),r=n(70800),i=n(51500),l=n(24771);function o(e){let{children:t,className:n,tag:s="div",style:r}=e;return(0,a.jsx)("".concat(s),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Typography","data-sentry-source-file":"Typography.tsx",children:t})}o.Title=function(e){let{className:t,level:n=1,children:s,style:r}=e;return(0,a.jsx)("h".concat(n),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Title","data-sentry-source-file":"Title.tsx",children:s})},o.Text=function(e){let{className:t,children:n,style:s,type:r,disabled:i,mark:l,code:o,keyboard:c,underline:d,strikethrough:u,strong:m,small:h}=e;return o?(0,a.jsx)("code",{style:s,children:n}):l?(0,a.jsx)("mark",{style:s,children:n}):c?(0,a.jsx)("kbd",{style:s,children:n}):m?(0,a.jsx)("strong",{style:s,children:n}):(0,a.jsx)("span",{style:s,"data-sentry-component":"Text","data-sentry-source-file":"Text.tsx",children:n})},o.Link=l.A;let c=(0,s.createContext)({type:"text"}),d=e=>{let{type:t}=e;return(0,a.jsx)(c.Provider,{value:{type:t},"data-sentry-element":"unknown","data-sentry-component":"MenuContextProvider","data-sentry-source-file":"MenuContext.tsx",children:e.children})},u=()=>{let e=(0,s.useContext)(c);if(void 0===e)throw Error("MenuContext must be used within a MenuContextProvider.");return e};function m(e){let{children:t,className:n,ulClassName:s,style:r,type:i="text"}=e;return(0,a.jsx)("nav",{role:"menu","aria-label":"Sidebar","aria-orientation":"vertical","aria-labelledby":"options-menu",className:n,style:r,"data-sentry-component":"Menu","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)(d,{type:i,"data-sentry-element":"MenuContextProvider","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)("ul",{className:s,children:t})})})}m.Item=function(e){let{children:t,icon:n,active:s,rounded:l,onClick:o,doNotCloseOverlay:c=!1,showActiveBar:d=!1,style:m}=e,h=(0,r.A)("menu"),{type:g}=u(),x=[h.item.base];x.push(h.item.variants[g].base),s?x.push(h.item.variants[g].active):x.push(h.item.variants[g].normal);let f=[h.item.content.base];s?f.push(h.item.content.active):f.push(h.item.content.normal);let p=[h.item.icon.base];return s?p.push(h.item.icon.active):p.push(h.item.icon.normal),(0,a.jsxs)("li",{role:"menuitem",className:(0,i.cn)("outline-none",x),style:m,onClick:o,"aria-current":s?"page":void 0,"data-sentry-component":"Item","data-sentry-source-file":"Menu.tsx",children:[n&&(0,a.jsx)("div",{className:"".concat(p.join(" ")," min-w-fit"),children:n}),(0,a.jsx)("span",{className:f.join(" "),children:t})]})},m.Group=function(e){let{children:t,icon:n,title:s}=e,i=(0,r.A)("menu"),{type:l}=u();return(0,a.jsxs)("div",{className:[i.group.base,i.group.variants[l]].join(" "),"data-sentry-component":"Group","data-sentry-source-file":"Menu.tsx",children:[n&&(0,a.jsx)("span",{className:i.group.icon,children:n}),(0,a.jsx)("span",{className:i.group.content,children:s}),t]})},m.Misc=function(e){let{children:t}=e;return(0,a.jsx)("div",{"data-sentry-component":"Misc","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)(o.Text,{"data-sentry-element":"unknown","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)("span",{children:t})})})};let h=m},46221:(e,t,n)=>{"use strict";n.d(t,{A:()=>x});var a=n(80263),s=n(24400),r=n(72035),i=n(90226),l=n(91435),o=n(20438),c=n(5483),d=n(52361),u=n(54660),m=n(7737),h=n(97175);let g=()=>{let{data:e}=(0,c.YA)(),t=(0,s.useRouter)().pathname.split("/")[4],{data:n}=(0,l.z)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString}),{data:d}=(0,o.Q)({projectRef:null==e?void 0:e.ref}),m=void 0!==(null!=n?n:[]).find(e=>"pg_net"===e.name),g=(null==d?void 0:d.selected_addons.find(e=>"pitr"===e.type))!==void 0,x=(0,r.p4)(),f=(0,u._P)("enablePgReplicate");return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(i.l,{page:t,menu:(0,h.k)(e,{pgNetExtensionExists:m,pitrEnabled:g,columnLevelPrivileges:x,enablePgReplicate:f}),"data-sentry-element":"ProductMenu","data-sentry-source-file":"DatabaseLayout.tsx"})})},x=(0,d.r)(e=>{let{children:t}=e;return(0,a.jsx)(m.A,{product:"Database",productMenu:(0,a.jsx)(g,{}),isBlocking:!1,"data-sentry-element":"ProjectLayout","data-sentry-component":"DatabaseLayout","data-sentry-source-file":"DatabaseLayout.tsx",children:t})})},48054:(e,t,n)=>{"use strict";n.d(t,{m:()=>a});let a={create:()=>["queues","create"],delete:e=>["queues",e,"delete"],purge:e=>["queues",e,"purge"],getMessagesInfinite:(e,t,n)=>["projects",e,"queue-messages",t,n].filter(Boolean),list:e=>["projects",e,"queues"],metrics:(e,t)=>["projects",e,"queue-metrics",t],exposePostgrestStatus:e=>["projects",e,"queue-expose-status"]}},56776:(e,t,n)=>{"use strict";n.d(t,{$O:()=>u,BQ:()=>g,Uu:()=>h});var a=n(74722),s=n.n(a),r=n(53239),i=n(23229),l=n(3914),o=n(5043),c=n(12006),d=n(5483);let u=["auth","cron","extensions","information_schema","net","pgsodium","pgsodium_masks","pgbouncer","pgtle","realtime","storage","supabase_functions","supabase_migrations","vault","graphql","graphql_public",o.Lh],m=()=>{let{data:e}=(0,d.YA)(),t=(0,c.ov)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString}),n=(0,r.useMemo)(()=>{var e;let n=null==(e=t.data)?void 0:e.filter(e=>(0,l.vN)({handlerName:i.U.ICEBERG,server:{options:[]}},e)),a=null==n?void 0:n.map(e=>(0,l.WV)(e.server_options)).map(e=>e.supabase_target_schema).flatMap(e=>null==e?void 0:e.split(",")).filter(Boolean);return s()(a)},[t.data]);return{...t,data:n}},h=function(){let{excludeSchemas:e=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,r.useMemo)(()=>e,[JSON.stringify(e)]),n=m(),a=(0,r.useMemo)(()=>{var e;let a=u.map(e=>({name:e,type:"internal"})),r=null==(e=n.data)?void 0:e.map(e=>({name:e,type:"fdw"}));return s()([...a,...r]).filter(e=>!t.includes(e.name))},[n.data,t]);return{...n,data:a}},g=e=>{let{schema:t,excludedSchemas:n=[]}=e,{data:a}=h({excludeSchemas:n}),s=a.find(e=>e.name===t);return s?{isSchemaLocked:!0,reason:s.type}:{isSchemaLocked:!1,reason:void 0}}},59024:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var a=n(80263),s=n(14360),r=n(83927),i=n.n(r),l=n(53239),o=n(34487);let c=e=>{let{queryId:t,language:n="pgsql",defaultValue:r="",readOnly:c=!1,contextmenu:d=!0,onInputChange:u=i()}=e,m=(0,s.useMonaco)(),h=(0,l.useRef)();return(0,l.useEffect)(()=>{if(m){let e=m.languages.registerDocumentFormattingEditProvider("pgsql",{async provideDocumentFormattingEdits(e){let t=e.getValue(),n=(0,o.A)(t);return[{range:e.getFullModelRange(),text:n}]}});return()=>{e.dispose()}}},[m]),(0,l.useEffect)(()=>{if(h.current){var e;null==(e=h.current)||e.changeViewZones(e=>{e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})})}},[t]),(0,a.jsx)(s.default,{className:"monaco-editor",theme:"supabase",defaultLanguage:n,defaultValue:r,path:t,loading:(0,a.jsx)(()=>(0,a.jsx)("h4",{className:"text-lg","data-sentry-component":"Loading","data-sentry-source-file":"SqlEditor.tsx",children:"Loading"}),{}),options:{readOnly:c,tabSize:2,fontSize:13,minimap:{enabled:!1},wordWrap:"on",fixedOverflowWidgets:!0,contextmenu:d},onMount:(e,t)=>{h.current=e,e.changeViewZones(e=>{e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})})},onChange:u,"data-sentry-element":"Editor","data-sentry-component":"SqlEditor","data-sentry-source-file":"SqlEditor.tsx"})}},63219:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>eZ});var a=n(80263),s=n(60045),r=n(53239),i=n(72035),l=n(73969),o=n(89293),c=n(5483),d=n(20168);let u=e=>{let{trigger:t,visible:n,setVisible:s}=e,{data:r}=(0,c.YA)(),{name:i,schema:u}=null!=t?t:{},{mutate:m,isLoading:h}=(0,o.R)();async function g(){return r?t?void m({projectRef:r.ref,connectionString:r.connectionString,trigger:t},{onSuccess:()=>{l.oR.success("Successfully removed ".concat(i)),s(!1)}}):console.error("Trigger ID is required"):console.error("Project is required")}return(0,a.jsx)(d.A,{variant:"warning",visible:n,onCancel:()=>s(!n),onConfirm:g,title:"Delete this trigger",loading:h,confirmLabel:"Delete trigger ".concat(i),confirmPlaceholder:"Type in name of trigger",confirmString:null!=i?i:"",text:(0,a.jsxs)(a.Fragment,{children:["This will delete your trigger called"," ",(0,a.jsx)("span",{className:"text-bold text-foreground",children:i})," of schema"," ",(0,a.jsx)("span",{className:"text-bold text-foreground",children:u})]}),alert:{title:"You cannot recover this trigger once deleted."},"data-sentry-element":"TextConfirmModal","data-sentry-component":"DeleteTrigger","data-sentry-source-file":"DeleteTrigger.tsx"})};var m=n(32981),h=n(55705),g=n(87494),x=n(10663);let f=e=>{let{icon:t,text:n}=e;return(0,a.jsxs)("div",{className:"flex items-center justify-center flex-row py-4 space-x-2","data-sentry-component":"FormBoxEmpty","data-sentry-source-file":"FormBoxEmpty.tsx",children:[(0,a.jsx)("div",{className:"relative bg-surface-100 text-foreground-lighter w-6 h-6 rounded-full flex items-center justify-center",children:t}),(0,a.jsx)("p",{className:"text-foreground-light",children:n})]})};var p=n(25176),j=n(32144),v=n(80251),y=n(47319),b=n(35021),N=n(15629);async function w(e){let{originalTrigger:t,projectRef:n,connectionString:a,payload:s}=e,{sql:r}=y.A.triggers.update(t,s),{result:i}=await (0,N.E)({projectRef:n,connectionString:a,sql:r,queryKey:["trigger","update",t.id]});return i}let _=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,j.jE)();return(0,v.n)(e=>w(e),{async onSuccess(t,n,s){let{projectRef:r}=n;await a.invalidateQueries(b.U.list(r)),await (null==e?void 0:e(t,n,s))},async onError(e,n,a){void 0===t?l.oR.error("Failed to update database trigger: ".concat(e.message)):t(e,n,a)},...n})};var S=n(9319),A=n(56776),C=n(9919),E=n(47452),q=n(93210),T=n(40990),k=n(77635),R=n(74245),F=n(51500),I=n(40022),M=n(61395),L=n(15903),D=n(80535),P=n(76803),z=n.n(P),$=n(86727),W=n.n($),B=n(15601),O=n.n(B),Y=n(24400),V=n(24332),G=n(93074),U=n(14528),H=n(59024),Q=n(92303),J=n(63159),X=n(72259);let Z=e=>{let{visible:t,onChange:n,setVisible:s}=e,{data:r}=(0,c.YA)(),{data:i=[]}=(0,Q.e)({projectRef:null==r?void 0:r.ref,connectionString:null==r?void 0:r.connectionString}),l=i.filter(e=>"trigger"===e.return_type),o=l.length>=1,d=z()(W()(l,"schema"),"schema"),u=e=>{let a=l.find(t=>t.id===e);a&&n(a),s(!t)};return(0,a.jsx)(V.Ay,{size:"large",header:"Pick a function",visible:t,onCancel:()=>s(!t),className:"hooks-sidepanel","data-sentry-element":"SidePanel","data-sentry-component":"ChooseFunctionForm","data-sentry-source-file":"ChooseFunctionForm.tsx",children:(0,a.jsx)("div",{className:"py-6",children:o?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(K,{}),d.map(e=>(0,a.jsx)(et,{schema:e,functions:l.filter(t=>t.schema==e),selectFunction:u},e))]}):(0,a.jsx)(ee,{})})})},K=()=>{let{ref:e}=(0,D.g)();return(0,a.jsx)("div",{className:"px-6","data-sentry-component":"NoticeBox","data-sentry-source-file":"ChooseFunctionForm.tsx",children:(0,a.jsx)(U.A,{icon:(0,a.jsx)(J.A,{size:"20",strokeWidth:1.5}),title:"Only functions that return a trigger will be displayed below",description:"You can make functions by using the Database Functions",button:(0,a.jsx)(I.$,{asChild:!0,type:"default",children:(0,a.jsx)(O(),{href:"/project/".concat(e,"/database/functions"),children:"Go to Functions"})}),"data-sentry-element":"InformationBox","data-sentry-source-file":"ChooseFunctionForm.tsx"})})},ee=()=>{let e=(0,Y.useRouter)(),{ref:t}=e.query;return(0,a.jsx)(G.A,{title:"No Trigger Functions found in database",ctaButtonLabel:"Create a trigger function",onClickCta:()=>{e.push("/project/".concat(t,"/database/functions"))},"data-sentry-element":"ProductEmptyState","data-sentry-component":"NoFunctionsState","data-sentry-source-file":"ChooseFunctionForm.tsx",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"You will need to create a trigger based function before you can add it to your trigger."})})},et=e=>{let{schema:t,functions:n,selectFunction:s}=e;return(0,a.jsxs)("div",{className:"space-y-4","data-sentry-component":"SchemaFunctionGroup","data-sentry-source-file":"ChooseFunctionForm.tsx",children:[(0,a.jsxs)("div",{className:"sticky top-0 flex items-center space-x-1 px-6 backdrop-blur backdrop-filter",children:[(0,a.jsx)("h5",{className:"text-foreground-light",children:"schema"}),(0,a.jsx)("h5",{children:t})]}),(0,a.jsx)("div",{className:"space-y-0 divide-y border-t border-b border-default",children:n.map(e=>(0,a.jsx)(en,{id:e.id,completeStatement:e.complete_statement,name:e.name,onClick:s},e.id))})]})},en=e=>{let{id:t,completeStatement:n,name:s,onClick:i}=e,[l,o]=(0,r.useState)(!1);return(0,a.jsxs)("div",{className:"cursor-pointer rounded p-3 px-6 hover:bg-studio",onClick:()=>i(t),"data-sentry-component":"Function","data-sentry-source-file":"ChooseFunctionForm.tsx",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between space-x-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-center rounded bg-foreground p-1 text-background",children:(0,a.jsx)(h.A,{strokeWidth:2,size:14,"data-sentry-element":"Terminal","data-sentry-source-file":"ChooseFunctionForm.tsx"})}),(0,a.jsx)("p",{className:"mb-0 text-sm",children:s})]}),(0,a.jsx)(I.$,{type:"text",onClick:e=>{e.stopPropagation(),o(!l)},icon:(0,a.jsx)(X.A,{className:l?"rotate-180 transform":"rotate-0 transform"}),"data-sentry-element":"Button","data-sentry-source-file":"ChooseFunctionForm.tsx",children:l?"Hide definition":"View definition"})]}),(0,a.jsx)(L.e,{show:l,enter:"transition ease-out duration-300",enterFrom:"transform opacity-0",enterTo:"transform opacity-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100",leaveTo:"transform opacity-0","data-sentry-element":"Transition","data-sentry-source-file":"ChooseFunctionForm.tsx",children:(0,a.jsx)("div",{className:"mt-4 h-64 border border-default",children:(0,a.jsx)(H.A,{defaultValue:n,readOnly:!0,contextmenu:!1,"data-sentry-element":"SqlEditor","data-sentry-source-file":"ChooseFunctionForm.tsx"})})})]})},ea=[{value:"INSERT",label:"Insert",description:"Any insert operation on the table"},{value:"UPDATE",label:"Update",description:"Any update operation of any column on the table"},{value:"DELETE",label:"Delete",description:"Any delete operation of a record"}],es=[{value:"BEFORE",label:"Before the event",description:"Trigger fires before the operation is attempted"},{value:"AFTER",label:"After the event",description:"Trigger fires before the operation has completed"}],er=[{value:"ROW",label:"Row",description:"Fires once for each processed row"},{value:"STATEMENT",label:"Statement",description:"Fires once for each statement"}],ei=[{value:"ORIGIN",label:"Origin",description:"This is the default behaviour"},{value:"REPLICA",label:"Replica",description:'Will only fire if the session is in "replica" mode'},{value:"ALWAYS",label:"Always",description:"Will fire regardless of the replication role"},{value:"DISABLED",label:"Disabled",description:"Will not fire"}],el="create-trigger",eo=x.Ik({name:x.Yj().min(1,"Please provide a name for your trigger").regex(/^\S+$/,"Name should not contain spaces or whitespaces"),schema:x.Yj(),table:x.Yj(),activation:x.k5(["BEFORE","AFTER","INSTEAD OF"]),enabled_mode:x.k5(["ORIGIN","REPLICA","ALWAYS","DISABLED"]),orientation:x.k5(["ROW","STATEMENT"]),function_name:x.Yj().min(1,"Please select a database function for your trigger to call"),function_schema:x.Yj(),events:x.YO(x.Yj()).min(1,"Please select at least one event"),tableId:x.Yj().optional()}),ec={name:"",schema:"",table:"",activation:"AFTER",orientation:"ROW",function_name:"",function_schema:"",enabled_mode:"ORIGIN",events:[]},ed=e=>{let{selectedTrigger:t,open:n,setOpen:s}=e,{data:i}=(0,c.YA)(),[o,d]=(0,r.useState)(!1),{mutate:u,isLoading:x}=(0,p.Y)({onSuccess:e=>{l.oR.success("Successfully created trigger ".concat(e.name)),s(!1)},onError:e=>{l.oR.error("Failed to create trigger: ".concat(e.message))}}),{mutate:j,isLoading:v}=_({onSuccess:e=>{l.oR.success("Successfully updated trigger ".concat(e.name)),s(!1)},onError:e=>{l.oR.error("Failed to update trigger: ".concat(e.message))}}),{data:y=[],isSuccess:b}=(0,S.LW)({projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString}),{data:N,isSuccess:w}=(0,A.Uu)(),L=b&&w,D=y.sort((e,t)=>e.schema.localeCompare(t.schema)).filter(e=>!N.find(t=>t.name===e.schema)),P=!!t,z=(0,g.mN)({mode:"onSubmit",reValidateMode:"onSubmit",resolver:(0,m.u)(eo),defaultValues:ec}),{function_name:$,function_schema:W}=z.watch(),B=async e=>{if(!i)return console.error("Project is required");let{tableId:n,...a}=e;P?j({projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString,originalTrigger:t,payload:{name:a.name,enabled_mode:a.enabled_mode}}):u({projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString,payload:a})};return(0,r.useEffect)(()=>{n&&L&&(z.clearErrors(),P?z.reset(t):D.length>0&&z.reset({...ec,tableId:D[0].id.toString(),table:D[0].name,schema:D[0].schema}))},[n,L]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(C.cj,{open:n,onOpenChange:s,"data-sentry-element":"Sheet","data-sentry-source-file":"TriggerSheet.tsx",children:(0,a.jsxs)(C.h,{size:"lg",className:"flex flex-col gap-0","data-sentry-element":"SheetContent","data-sentry-source-file":"TriggerSheet.tsx",children:[(0,a.jsx)(C.Fm,{"data-sentry-element":"SheetHeader","data-sentry-source-file":"TriggerSheet.tsx",children:(0,a.jsx)(C.qp,{"data-sentry-element":"SheetTitle","data-sentry-source-file":"TriggerSheet.tsx",children:P?"Edit database trigger: ".concat(t.name):"Create a new database trigger"})}),(0,a.jsx)(E.lV,{...z,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"TriggerSheet.tsx",children:(0,a.jsxs)("form",{id:el,className:"flex-1 flex flex-col gap-y-6 overflow-auto py-6",onSubmit:z.handleSubmit(B),children:[(0,a.jsx)(E.zB,{name:"name",control:z.control,render:e=>{let{field:t}=e;return(0,a.jsx)(M.M,{className:"px-5",layout:"horizontal",label:"Name of trigger",description:"Do not use spaces/whitespace.",children:(0,a.jsx)(E.MJ,{children:(0,a.jsx)(q.p,{...t,placeholder:"Name of trigger"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"TriggerSheet.tsx"}),P?(0,a.jsx)(E.zB,{name:"enabled_mode",control:z.control,render:e=>{var t;let{field:n}=e;return(0,a.jsx)(M.M,{className:"px-5",layout:"horizontal",label:"Enabled mode",description:"Determines if a trigger should or should not fire. Can also be used to disable a trigger, but not delete it.",children:(0,a.jsx)(E.MJ,{children:(0,a.jsxs)(T.l6,{defaultValue:n.value,onValueChange:n.onChange,children:[(0,a.jsx)(T.bq,{className:"col-span-8",children:null==(t=ei.find(e=>e.value===n.value))?void 0:t.label}),(0,a.jsx)(T.gC,{children:ei.map(e=>(0,a.jsxs)(T.eb,{value:e.value,children:[(0,a.jsx)("p",{className:"text-foreground",children:e.label}),(0,a.jsx)("p",{className:"text-foreground-lighter",children:e.description})]},e.value))})]})})})}}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.w,{}),(0,a.jsx)(E.zB,{name:"tableId",control:z.control,render:e=>{let{field:t}=e;return(0,a.jsx)(M.M,{className:"px-5",layout:"horizontal",label:"Table",description:"Trigger will watch for changes on this table",children:(0,a.jsx)(E.MJ,{children:(0,a.jsxs)(T.l6,{defaultValue:t.value,onValueChange:e=>{let t=D.find(t=>t.id.toString()===e);t&&(z.setValue("table",t.name),z.setValue("schema",t.schema))},children:[(0,a.jsx)(T.bq,{className:"col-span-8",children:(0,a.jsx)(T.yv,{})}),(0,a.jsx)(T.gC,{children:D.map(e=>(0,a.jsxs)(T.eb,{value:e.id.toString(),children:[(0,a.jsxs)("span",{className:"text-foreground-light",children:[e.schema,"."]}),(0,a.jsx)("span",{className:"text-foreground",children:e.name})]},e.id))})]})})})}}),(0,a.jsx)(E.zB,{name:"events",control:z.control,render:()=>(0,a.jsx)(M.M,{className:"px-5",layout:"horizontal",label:"Events",description:"These are the events that are watched by the trigger, only the events selected above will fire the trigger on the table you've selected.",children:ea.map(e=>(0,a.jsx)(E.zB,{control:z.control,name:"events",render:t=>{var n;let{field:s}=t;return(0,a.jsx)(M.M,{hideMessage:!0,layout:"flex",label:e.label,description:e.description,children:(0,a.jsx)(E.MJ,{children:(0,a.jsx)(R.S,{className:"translate-y-[2px]",checked:null==(n=s.value)?void 0:n.includes(e.value),onCheckedChange:t=>{var n;return t?s.onChange([...s.value,e.value]):s.onChange(null==(n=s.value)?void 0:n.filter(t=>t!==e.value))}})})})}},e.value))})}),(0,a.jsx)(E.zB,{name:"activation",control:z.control,render:e=>{var t;let{field:n}=e;return(0,a.jsx)(M.M,{className:"px-5",layout:"horizontal",label:"Trigger type",description:"Determines when your trigger fires",children:(0,a.jsx)(E.MJ,{children:(0,a.jsxs)(T.l6,{defaultValue:n.value,onValueChange:n.onChange,children:[(0,a.jsx)(T.bq,{className:"col-span-8",children:null==(t=es.find(e=>e.value===n.value))?void 0:t.label}),(0,a.jsx)(T.gC,{children:es.map(e=>(0,a.jsxs)(T.eb,{value:e.value,children:[(0,a.jsx)("p",{className:"text-foreground",children:e.label}),(0,a.jsx)("p",{className:"text-foreground-lighter",children:e.description})]},e.value))})]})})})}}),(0,a.jsx)(E.zB,{name:"orientation",control:z.control,render:e=>{var t;let{field:n}=e;return(0,a.jsx)(M.M,{className:"px-5",layout:"horizontal",label:"Orientation",description:"Identifies whether the trigger fires once for each processed row or once for each statement",children:(0,a.jsx)(E.MJ,{children:(0,a.jsxs)(T.l6,{defaultValue:n.value,onValueChange:n.onChange,children:[(0,a.jsx)(T.bq,{className:"col-span-8",children:null==(t=er.find(e=>e.value===n.value))?void 0:t.label}),(0,a.jsx)(T.gC,{children:er.map(e=>(0,a.jsxs)(T.eb,{value:e.value,children:[(0,a.jsx)("p",{className:"text-foreground",children:e.label}),(0,a.jsx)("p",{className:"text-foreground-lighter",children:e.description})]},e.value))})]})})})}}),(0,a.jsx)(k.w,{}),(0,a.jsx)(E.zB,{name:"function_name",control:z.control,render:()=>(0,a.jsx)(M.M,{layout:"vertical",className:"px-5",children:(0,a.jsx)(E.MJ,{children:(0,a.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,a.jsx)("p",{className:"text-smn",children:"Function to trigger"}),0===$.length?(0,a.jsx)("button",{type:"button",className:(0,F.cn)("relative w-full rounded border border-default","bg-surface-200 px-5 py-1 shadow-sm transition-all","hover:border-strong hover:bg-overlay-hover"),onClick:()=>d(!0),children:(0,a.jsx)(f,{icon:(0,a.jsx)(h.A,{size:14,strokeWidth:2}),text:"Choose a function to trigger"})}):(0,a.jsxs)("div",{className:(0,F.cn)("relative w-full flex items-center justify-between","space-x-3 px-5 py-4 border border-default","rounded shadow-sm transition-shadow"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded bg-foreground text-background focus-within:bg-opacity-10",children:(0,a.jsx)(h.A,{size:"18",strokeWidth:2,width:14})}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-sm text-foreground-light",children:W}),".",(0,a.jsx)("span",{className:"text-sm text-foreground",children:$})]})]}),(0,a.jsx)(I.$,{type:"default",onClick:()=>d(!0),children:"Change function"})]})]})})})})]})]})}),(0,a.jsxs)(C.XW,{className:"shrink-0","data-sentry-element":"SheetFooter","data-sentry-source-file":"TriggerSheet.tsx",children:[(0,a.jsx)(I.$,{type:"default",htmlType:"reset",disabled:x||v,onClick:()=>s(!1),"data-sentry-element":"Button","data-sentry-source-file":"TriggerSheet.tsx",children:"Cancel"}),(0,a.jsx)(I.$,{form:el,htmlType:"submit",loading:x||v,"data-sentry-element":"Button","data-sentry-source-file":"TriggerSheet.tsx",children:"Create trigger"})]})]})}),(0,a.jsx)(Z,{visible:o,setVisible:d,onChange:e=>{z.setValue("function_name",e.name),z.setValue("function_schema",e.schema)},"data-sentry-element":"ChooseFunctionForm","data-sentry-source-file":"TriggerSheet.tsx"})]})},eu=e=>{let t=e.events.join(" OR "),n=e.function_args.length>0?"(".concat(e.function_args.join(", "),")"):"()",a='\nDROP TRIGGER IF EXISTS "'.concat(e.name,'" ON "').concat(e.schema,'"."').concat(e.table,'";\n\nCREATE TRIGGER "').concat(e.name,'"\n').concat(e.activation," ").concat(t,'\nON "').concat(e.schema,'"."').concat(e.table,'"\nFOR EACH ').concat(e.orientation,"\n");return e.condition&&(a+="WHEN (".concat(e.condition,")\n")),(a+='EXECUTE FUNCTION "'.concat(e.function_schema,'"."').concat(e.function_name,'"').concat(n,";")).trim()};var em=n(83927),eh=n.n(em),eg=n(75189),ex=n(3689),ef=n(2356);let ep=()=>(0,a.jsx)(ef.F,{title:"Alpha preview",withIcon:!0,variant:"warning","data-sentry-element":"Alert","data-sentry-component":"AlphaPreview","data-sentry-source-file":"AlphaPreview.tsx",children:"This is not suitable for production"});var ej=n(87645),ev=n(20313),ey=n(88602),eb=n(79015),eN=n(90437),ew=n(86747),e_=n(75019),eS=n(86505),eA=n(86815),eC=n(95708),eE=n(52786),eq=n(91746),eT=n(86926),ek=n.n(eT),eR=n(14506),eF=n.n(eR),eI=n(80903),eM=n(25643),eL=n(26587),eD=n(89080),eP=n(11192),ez=n(17089),e$=n(78721),eW=n(2119),eB=n(71139);let eO=e=>{let{schema:t,filterString:n,isLocked:r,editTrigger:i,deleteTrigger:l}=e,{data:o}=(0,c.YA)(),d=(0,eA.xd)(),{data:u}=(0,ew.oR)({projectRef:null==o?void 0:o.ref,connectionString:null==o?void 0:o.connectionString}),m=(null!=u?u:[]).filter(e=>ek()(e.name.toLowerCase(),n.toLowerCase())),h=eF()(m.filter(e=>e.schema==t),e=>e.name.toLocaleLowerCase()),g=(0,e_.SE)(s.aG.TENANT_SQL_ADMIN_WRITE,"triggers");return 0===h.length&&0===n.length?(0,a.jsx)(ej.A.tr,{children:(0,a.jsxs)(ej.A.td,{colSpan:7,children:[(0,a.jsx)("p",{className:"text-sm text-foreground",children:"No triggers created yet"}),(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:['There are no triggers found in the schema "',t,'"']})]})},t):0===h.length&&n.length>0?(0,a.jsx)(ej.A.tr,{children:(0,a.jsxs)(ej.A.td,{colSpan:7,children:[(0,a.jsx)("p",{className:"text-sm text-foreground",children:"No results found"}),(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:['Your search for "',n,'" did not return any results']})]})},t):(0,a.jsx)(a.Fragment,{children:h.map(e=>(0,a.jsxs)(ej.A.tr,{children:[(0,a.jsx)(ej.A.td,{className:"space-x-2",children:(0,a.jsxs)(e$.m_,{children:[(0,a.jsx)(e$.k$,{onClick:()=>i(e),className:"cursor-pointer text-foreground truncate max-w-48 inline-block",children:e.name}),(0,a.jsx)(e$.ZI,{side:"bottom",align:"center",children:e.name})]})}),(0,a.jsx)(ej.A.td,{className:"break-all",children:(0,a.jsx)("p",{title:e.table,className:"truncate",children:e.table})}),(0,a.jsx)(ej.A.td,{className:"space-x-2",children:(0,a.jsx)("p",{title:e.function_name,className:"truncate",children:e.function_name})}),(0,a.jsx)(ej.A.td,{children:(0,a.jsx)("div",{className:"flex gap-2 flex-wrap",children:e.events.map(t=>(0,a.jsx)(eW.E,{children:"".concat(e.activation," ").concat(t)},t))})}),(0,a.jsx)(ej.A.td,{className:"space-x-2",children:(0,a.jsx)("p",{title:e.orientation,className:"truncate",children:e.orientation})}),(0,a.jsx)(ej.A.td,{children:(0,a.jsx)("div",{className:"flex items-center justify-center",children:"DISABLED"!==e.enabled_mode?(0,a.jsx)(eI.A,{strokeWidth:2,className:"text-brand"}):(0,a.jsx)(eM.A,{strokeWidth:2})})}),(0,a.jsx)(ej.A.td,{className:"text-right",children:!r&&(0,a.jsx)("div",{className:"flex items-center justify-end",children:g?(0,a.jsxs)(eB.rI,{children:[(0,a.jsx)(eB.ty,{asChild:!0,children:(0,a.jsx)(I.$,{"aria-label":"More options",type:"default",className:"px-1",icon:(0,a.jsx)(eL.A,{})})}),(0,a.jsxs)(eB.SQ,{side:"bottom",align:"end",className:"w-52",children:[(0,a.jsxs)(eB._2,{className:"space-x-2",onClick:()=>{eu(e),i(e)},children:[(0,a.jsx)(eD.A,{size:14}),(0,a.jsx)("p",{children:"Edit trigger"})]}),(0,a.jsxs)(eB._2,{className:"space-x-2",onClick:()=>{let t=eu(e);d.newChat({name:"Update trigger ".concat(eM.A.name),open:!0,initialInput:"Update this trigger which exists on the ".concat(e.schema,".").concat(e.table," table to..."),suggestions:{title:"I can help you make a change to this trigger, here are a few example prompts to get you started:",prompts:[{label:"Rename Trigger",description:"Rename this trigger to ..."},{label:"Change Events",description:"Change the events this trigger responds to ..."},{label:"Modify Timing",description:"Modify this trigger to run after instead of before ..."}]},sqlSnippets:[t]})},children:[(0,a.jsx)(eP.A,{size:14}),(0,a.jsx)("p",{children:"Edit with Assistant"})]}),(0,a.jsxs)(eB._2,{className:"space-x-2",onClick:()=>l(e),children:[(0,a.jsx)(ez.A,{stroke:"red",size:14}),(0,a.jsx)("p",{children:"Delete trigger"})]})]})]}):(0,a.jsx)(ey.G,{disabled:!0,type:"default",className:"px-1",icon:(0,a.jsx)(eL.A,{}),tooltip:{content:{side:"bottom",text:"You need additional permissions to update triggers"}}})})})]},e.id))})},eY=e=>{let{createTrigger:t=eh(),editTrigger:n=eh(),deleteTrigger:i=eh()}=e,{data:l}=(0,c.YA)(),o=(0,eA.xd)(),{selectedSchema:d,setSelectedSchema:u}=(0,eS.k)(),[m,h]=(0,r.useState)(""),{data:g}=(0,A.Uu)(),{isSchemaLocked:x}=(0,A.BQ)({schema:d}),{data:f=[],isSuccess:p}=(0,S.LW)({projectRef:null==l?void 0:l.ref,connectionString:null==l?void 0:l.connectionString}),j=f.filter(e=>!g.find(t=>t.name===e.schema)).length>0,{data:v,error:y,isLoading:b,isError:N}=(0,ew.oR)({projectRef:null==l?void 0:l.ref,connectionString:null==l?void 0:l.connectionString}),w=(0,e_.SE)(s.aG.TENANT_SQL_ADMIN_WRITE,"triggers");return b?(0,a.jsx)(eN.y,{}):N?(0,a.jsx)(ev.A,{error:y,subject:"Failed to retrieve database triggers"}):(0,a.jsx)(a.Fragment,{children:0===(null!=v?v:[]).length?(0,a.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,a.jsxs)(G.A,{title:"Triggers",ctaButtonLabel:"Create a new trigger",onClickCta:()=>t(),children:[(0,a.jsx)(ep,{}),(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"A PostgreSQL trigger is a function invoked automatically whenever an event associated with a table occurs."}),(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"An event could be any of the following: INSERT, UPDATE, DELETE. A trigger is a special user-defined function associated with a table."})]})}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-2 flex-wrap",children:[(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center gap-2",children:[(0,a.jsx)(eb.A,{className:"w-full lg:w-[180px]",size:"tiny",showError:!1,selectedSchemaName:d,onSelectSchema:u}),(0,a.jsx)(eC.A,{placeholder:"Search for a trigger",size:"tiny",icon:(0,a.jsx)(eg.A,{size:"14"}),value:m,className:"w-full lg:w-52",onChange:e=>h(e.target.value)})]}),!x&&(0,a.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,a.jsx)(ey.G,{disabled:!j||!w,icon:(0,a.jsx)(ex.A,{}),onClick:()=>t(),className:"flex-grow",tooltip:{content:{side:"bottom",text:j?w?void 0:"You need additional permissions to create triggers":"Create a table first before creating triggers"}},children:"New trigger"}),j&&(0,a.jsx)(ey.G,{type:"default",disabled:!j||!w,className:"px-1 pointer-events-auto",icon:(0,a.jsx)(eE.M,{size:16}),onClick:()=>o.newChat({name:"Create new trigger",open:!0,initialInput:"Create a new trigger for the schema ".concat(d," that does ..."),suggestions:{title:"I can help you create a new trigger, here are a few example prompts to get you started:",prompts:[{label:"Log Changes",description:"Create a trigger that logs changes to the users table"},{label:"Update Timestamp",description:"Create a trigger that updates updated_at timestamp"},{label:"Validate Email",description:"Create a trigger that validates email format before insert"}]}}),tooltip:{content:{side:"bottom",text:w?"Create with Supabase Assistant":"You need additional permissions to create triggers"}}})]})]}),x&&(0,a.jsx)(eq.i,{schema:d,entity:"triggers"}),(0,a.jsx)("div",{className:"w-full overflow-hidden overflow-x-auto",children:(0,a.jsx)(ej.A,{head:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ej.A.th,{children:"Name"},"name"),(0,a.jsx)(ej.A.th,{children:"Table"},"table"),(0,a.jsx)(ej.A.th,{children:"Function"},"function"),(0,a.jsx)(ej.A.th,{children:"Events"},"events"),(0,a.jsx)(ej.A.th,{children:"Orientation"},"orientation"),(0,a.jsx)(ej.A.th,{className:"w-20",children:"Enabled"},"enabled"),(0,a.jsx)(ej.A.th,{className:"w-1/12"},"buttons")]}),body:(0,a.jsx)(eO,{schema:d,filterString:m,isLocked:x,editTrigger:n,deleteTrigger:i})})})]})})};var eV=n(46221),eG=n(65216),eU=n(92882),eH=n(34618),eQ=n(92512),eJ=n(98969);let eX=()=>{let e=(0,i.h4)(),[t,n]=(0,r.useState)(),[l,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)(!1),[m,h]=(0,r.useState)(!1),[g,x]=(0,r.useState)(),f=(0,e_.SE)(s.aG.TENANT_SQL_ADMIN_READ,"triggers");return(0,e_.Lh)()&&!f?(0,a.jsx)(eJ.A,{isFullPage:!0,resourceText:"view database triggers"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eU.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"triggers.tsx",children:(0,a.jsx)(eU.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"triggers.tsx",children:(0,a.jsxs)("div",{className:"col-span-12",children:[(0,a.jsx)(eQ.M,{title:"Database Triggers",description:"Execute a set of actions automatically on specified table events",docsUrl:"https://supabase.com/docs/guides/database/postgres/triggers","data-sentry-element":"FormHeader","data-sentry-source-file":"triggers.tsx"}),(0,a.jsx)(eY,{createTrigger:()=>{e?(x(void 0),h(!0)):(n(void 0),o(!0))},editTrigger:t=>{e?(x(t),h(!0)):(n(t),o(!0))},deleteTrigger:e=>{n(e),d(!0)},"data-sentry-element":"TriggersList","data-sentry-source-file":"triggers.tsx"})]})})}),(0,a.jsx)(ed,{selectedTrigger:t,open:l,setOpen:o,"data-sentry-element":"TriggerSheet","data-sentry-source-file":"triggers.tsx"}),(0,a.jsx)(u,{trigger:t,visible:c,setVisible:d,"data-sentry-element":"DeleteTrigger","data-sentry-source-file":"triggers.tsx"}),(0,a.jsx)(eH.E,{open:m,onRunSuccess:()=>{h(!1),x(void 0)},onClose:()=>{h(!1),x(void 0)},initialValue:g?eu(g):"create trigger trigger_name\nafter insert or update or delete on table_name\nfor each row\nexecute function function_name();",label:g?'Edit trigger "'.concat(g.name,'"'):"Create new database trigger",initialPrompt:g?'Update the database trigger "'.concat(g.name,'" to...'):"Create a new database trigger that...","data-sentry-element":"EditorPanel","data-sentry-source-file":"triggers.tsx"})]})};eX.getLayout=e=>(0,a.jsx)(eG.A,{children:(0,a.jsx)(eV.A,{title:"Database",children:e})});let eZ=eX},73047:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var a=n(80263),s=n(15601),r=n.n(s),i=n(43242),l=n(2119),o=n(40022);let c=e=>{let{name:t="",isActive:n,isExternal:s,icon:c,rightIcon:d,url:u="",target:m="_self",onClick:h,textClassName:g="",hoverText:x="",label:f}=e,p=(0,a.jsx)(i.Ay.Item,{icon:c,rounded:!0,active:n,onClick:h,children:(0,a.jsxs)("div",{className:"flex w-full items-center justify-between gap-1",children:[(0,a.jsxs)("div",{title:x||("string"==typeof t?t:""),className:"flex items-center gap-2 truncate w-full "+g,children:[(0,a.jsxs)("span",{className:"truncate",children:[t," "]}),void 0!==f&&(0,a.jsx)(l.E,{variant:"warning",className:"py-0 px-1.5 capitalize",children:f})]}),d&&(0,a.jsx)("div",{children:d})]})});return u?s?(0,a.jsx)(o.$,{asChild:!0,block:!0,className:"!justify-start",type:"text",size:"small",icon:c,children:(0,a.jsx)(r(),{href:u,target:"_blank",rel:"noreferrer",children:t})}):(0,a.jsx)(r(),{href:u,className:"block",target:m,children:p}):p}},79015:(e,t,n)=>{"use strict";n.d(t,{A:()=>j});var a=n(80263),s=n(60045),r=n(96572),i=n(80903),l=n(3689),o=n(53239),c=n(63604),d=n(75019),u=n(5483),m=n(40022),h=n(53555),g=n(1012),x=n(9681),f=n(61965),p=n(80016);let j=e=>{let{className:t,disabled:n=!1,size:j="tiny",showError:v=!0,selectedSchemaName:y,supportSelectAll:b=!1,excludedSchemas:N=[],onSelectSchema:w,onSelectCreateSchema:_,portal:S=!0}=e,[A,C]=(0,o.useState)(!1),E=(0,d.SE)(s.aG.TENANT_SQL_ADMIN_WRITE,"schemas"),{data:q}=(0,u.YA)(),{data:T,isLoading:k,isSuccess:R,isError:F,error:I,refetch:M}=(0,c.w$)({projectRef:null==q?void 0:q.ref,connectionString:null==q?void 0:q.connectionString}),L=(T||[]).filter(e=>!N.includes(e.name)).sort((e,t)=>e.name.localeCompare(t.name));return(0,a.jsxs)("div",{className:t,"data-sentry-component":"SchemaSelector","data-sentry-source-file":"SchemaSelector.tsx",children:[k&&(0,a.jsx)(m.$,{type:"default",className:"w-full [&>span]:w-full",size:j,disabled:!0,children:(0,a.jsx)(h.E,{className:"w-full h-3 bg-foreground-muted"})},"schema-selector-skeleton"),v&&F&&(0,a.jsxs)(g.Fc,{variant:"warning",className:"!px-3 !py-3",children:[(0,a.jsx)(g.XL,{className:"text-xs text-amber-900",children:"Failed to load schemas"}),(0,a.jsxs)(g.TN,{className:"text-xs mb-2 break-words",children:["Error: ",null==I?void 0:I.message]}),(0,a.jsx)(m.$,{type:"default",size:"tiny",onClick:()=>M(),children:"Reload schemas"})]}),R&&(0,a.jsxs)(x.AM,{open:A,onOpenChange:C,modal:!1,children:[(0,a.jsx)(x.Wv,{asChild:!0,children:(0,a.jsx)(m.$,{size:j,disabled:n,type:"default","data-testid":"schema-selector",className:"w-full [&>span]:w-full !pr-1 space-x-1",iconRight:(0,a.jsx)(r.A,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:y?(0,a.jsxs)("div",{className:"w-full flex gap-1",children:[(0,a.jsx)("p",{className:"text-foreground-lighter",children:"schema"}),(0,a.jsx)("p",{className:"text-foreground",children:"*"===y?"All schemas":y})]}):(0,a.jsx)("div",{className:"w-full flex gap-1",children:(0,a.jsx)("p",{className:"text-foreground-lighter",children:"Choose a schema"})})})}),(0,a.jsx)(x.hl,{className:"p-0 min-w-[200px] pointer-events-auto",side:"bottom",align:"start",portal:S,sameWidthAsTrigger:!0,children:(0,a.jsxs)(f.uB,{children:[(0,a.jsx)(f.G7,{placeholder:"Find schema..."}),(0,a.jsxs)(f.oI,{children:[(0,a.jsx)(f.xL,{children:"No schemas found"}),(0,a.jsx)(f.L$,{children:(0,a.jsxs)(p.FK,{className:(L||[]).length>7?"h-[210px]":"",children:[b&&(0,a.jsxs)(f.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w("*"),C(!1)},onClick:()=>{w("*"),C(!1)},children:[(0,a.jsx)("span",{children:"All schemas"}),"*"===y&&(0,a.jsx)(i.A,{className:"text-brand",strokeWidth:2,size:16})]},"select-all"),null==L?void 0:L.map(e=>(0,a.jsxs)(f.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w(e.name),C(!1)},onClick:()=>{w(e.name),C(!1)},children:[(0,a.jsx)("span",{children:e.name}),y===e.name&&(0,a.jsx)(i.A,{className:"text-brand",strokeWidth:2,size:16})]},e.id))]})}),void 0!==_&&E&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.fx,{}),(0,a.jsx)(f.L$,{children:(0,a.jsxs)(f.h_,{className:"cursor-pointer flex items-center gap-x-2 w-full",onSelect:()=>{_(),C(!1)},onClick:()=>{_(),C(!1)},children:[(0,a.jsx)(l.A,{size:12}),"Create a new schema"]})})]})]})]})})]})]})}},86505:(e,t,n)=>{"use strict";n.d(t,{k:()=>l});var a=n(32466),s=n(53239),r=n(80535);let i=e=>(0,a.ZA)("schema",a.tU.withDefault(e).withOptions({clearOnDefault:!1})),l=()=>{let{ref:e}=(0,r.g)(),t=e&&e.length>0&&window.localStorage.getItem(r.rS.LAST_SELECTED_SCHEMA(e))||"public",[n,a]=i((0,s.useMemo)(()=>t,[e]));return(0,s.useEffect)(()=>{e&&e.length>0&&window.localStorage.setItem(r.rS.LAST_SELECTED_SCHEMA(e),n)},[n,e]),{selectedSchema:n,setSelectedSchema:a}}},86747:(e,t,n)=>{"use strict";n.d(t,{fl:()=>o,oR:()=>c});var a=n(56947),s=n(65172),r=n(35021),i=n(89811);async function l(e,t){let{projectRef:n,connectionString:a}=e;if(!n)throw Error("projectRef is required");let r=new Headers;a&&r.set("x-connection-encrypted",a);let{data:l,error:o}=await (0,s.Jt)("/platform/pg-meta/{ref}/triggers",{params:{header:{"x-connection-encrypted":a,"x-pg-application-name":i.r},path:{ref:n},query:void 0},headers:r,signal:t});return o&&(0,s.H4)(o),l}let o=function(e){let{projectRef:t,connectionString:n}=e,{enabled:s=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(r.U.list(t),e=>{let{signal:a}=e;return l({projectRef:t,connectionString:n},a)},{select:e=>e.filter(e=>"supabase_functions"===e.function_schema&&("net"!==e.schema||0===e.function_args.length)),enabled:s&&void 0!==t,...i})},c=function(e){let{projectRef:t,connectionString:n}=e,{enabled:s=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(r.U.list(t),e=>{let{signal:a}=e;return l({projectRef:t,connectionString:n},a)},{enabled:s&&void 0!==t,...i})}},89293:(e,t,n)=>{"use strict";n.d(t,{R:()=>d});var a=n(32144),s=n(80251),r=n(73969),i=n(47319),l=n(35021),o=n(15629);async function c(e){let{trigger:t,projectRef:n,connectionString:a}=e,{sql:s}=i.A.triggers.remove(t),{result:r}=await (0,o.E)({projectRef:n,connectionString:a,sql:s,queryKey:["trigger","delete",t.id]});return r}let d=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,a.jE)();return(0,s.n)(e=>c(e),{async onSuccess(t,n,a){let{projectRef:s}=n;await i.invalidateQueries(l.U.list(s)),await (null==e?void 0:e(t,n,a))},async onError(e,n,a){void 0===t?r.oR.error("Failed to delete database trigger: ".concat(e.message)):t(e,n,a)},...n})}},90226:(e,t,n)=>{"use strict";n.d(t,{l:()=>l});var a=n(80263),s=n(43242),r=n(2119),i=n(73047);let l=e=>{let{page:t,menu:n}=e;return(0,a.jsx)("div",{className:"flex flex-col space-y-8","data-sentry-component":"ProductMenu","data-sentry-source-file":"ProductMenu.tsx",children:(0,a.jsx)(s.Ay,{type:"pills","data-sentry-element":"Menu","data-sentry-source-file":"ProductMenu.tsx",children:n.map((e,l)=>(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"my-6 space-y-8",children:(0,a.jsxs)("div",{className:"mx-3",children:[(0,a.jsx)(s.Ay.Group,{title:e.title?(0,a.jsxs)("div",{className:"flex flex-col space-y-2 uppercase font-mono",children:[(0,a.jsx)("span",{children:e.title}),e.isPreview&&(0,a.jsx)(r.E,{variant:"warning",children:"Not production ready"})]}):null}),(0,a.jsx)("div",{children:e.items.map(e=>{let n=e.pages?e.pages.includes(null!=t?t:""):t===e.key;return(0,a.jsx)(i.A,{url:e.url,name:e.name,icon:e.icon,rightIcon:e.rightIcon,isActive:n,isExternal:e.isExternal,target:e.isExternal?"_blank":"_self",label:e.label},e.key)})})]})}),l!==n.length-1&&(0,a.jsx)("div",{className:"h-px w-full bg-border-overlay"})]},e.key||e.title))})})}},91435:(e,t,n)=>{"use strict";n.d(t,{z:()=>d});var a=n(89811),s=n(56947),r=n(65172),i=n(5483),l=n(63492),o=n(28140);async function c(e,t,n){let{projectRef:s,connectionString:i}=e;if(!s)throw Error("projectRef is required");let l=new Headers(n);i&&l.set("x-connection-encrypted",i);let{data:o,error:c}=await (0,r.Jt)("/platform/pg-meta/{ref}/extensions",{params:{header:{"x-connection-encrypted":i,"x-pg-application-name":a.r},path:{ref:s}},headers:l,signal:t});return c&&(0,r.H4)(c),o}let d=function(e){let{projectRef:t,connectionString:n}=e,{enabled:a=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:d}=(0,i.YA)(),u=(null==d?void 0:d.status)===l.BU.ACTIVE_HEALTHY;return(0,s.I)(o.I.list(t),e=>{let{signal:a}=e;return c({projectRef:t,connectionString:n},a)},{enabled:a&&void 0!==t&&u,...r})}},91746:(e,t,n)=>{"use strict";n.d(t,{i:()=>u});var a=n(80263),s=n(53239),r=n(16838),i=n(40022),l=n(51500),o=n(56776),c=n(47142);let d=e=>{let{onClose:t}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:(0,a.jsx)(r.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:"Schemas managed by Supabase"})}),(0,a.jsx)(r.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"ProtectedSchemaWarning.tsx"}),(0,a.jsxs)(r.OO,{className:"space-y-2 prose","data-sentry-element":"DialogSection","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:[(0,a.jsx)("p",{className:"text-sm",children:"The following schemas are managed by Supabase and are currently protected from write access through the dashboard."}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:o.$O.map(e=>(0,a.jsx)("code",{className:"text-xs",children:e},e))}),(0,a.jsx)("p",{className:"text-sm !mt-4",children:"These schemas are critical to the functionality of your Supabase project and hence we highly recommend not altering them."}),(0,a.jsx)("p",{className:"text-sm",children:"You can, however, still interact with those schemas through the SQL Editor although we advise you only do so if you know what you are doing."})]}),(0,a.jsx)(r.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:(0,a.jsx)("div",{className:"flex items-center justify-end space-x-2",children:(0,a.jsx)(i.$,{type:"default",onClick:t,"data-sentry-element":"Button","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:"Understood"})})})]})},u=e=>{let{size:t="md",schema:n,entity:u}=e,[m,h]=(0,s.useState)(!1),{isSchemaLocked:g,reason:x}=(0,o.BQ)({schema:n});return g?(0,a.jsx)(c.Z,{showIcon:!1,type:"note",title:"sm"===t?"Viewing protected schema":"Viewing ".concat(u," from a protected schema"),className:(0,l.cn)("[&>div>p]:prose [&>div>p]:max-w-full [&>div>p]:!leading-normal","sm"===t?"[&>div>p]:text-xs":"[&>div>p]:text-sm"),"data-sentry-element":"Admonition","data-sentry-component":"ProtectedSchemaWarning","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:"fdw"===x?(0,a.jsxs)("p",{children:["The ",(0,a.jsx)("code",{className:"text-xs",children:n})," schema is used by Supabase to connect to analytics buckets and is read-only through the dashboard."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{className:"mb-2",children:["The ",(0,a.jsx)("code",{className:"text-xs",children:n})," schema is managed by Supabase and is read-only through the dashboard."]}),(0,a.jsxs)(r.lG,{open:m,onOpenChange:h,children:[(0,a.jsx)(r.zM,{asChild:!0,children:(0,a.jsx)(i.$,{type:"default",size:"tiny",onClick:()=>h(!0),children:"Learn more"})}),(0,a.jsx)(r.Cf,{children:(0,a.jsx)(d,{onClose:()=>h(!1)})})]})]})}):null}},92303:(e,t,n)=>{"use strict";n.d(t,{e:()=>c});var a=n(47319),s=n(56947),r=n(92403),i=n(15629);let l=a.A.functions.list();async function o(e,t,n){let{projectRef:a,connectionString:s}=e,r=new Headers(n),{result:o}=await (0,i.E)({projectRef:a,connectionString:s,sql:l.sql,queryKey:["database-functions"]},t,r);return o}let c=function(e){let{projectRef:t,connectionString:n}=e,{enabled:a=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.I)(r.c.databaseFunctions(t),e=>{let{signal:a}=e;return o({projectRef:t,connectionString:n},a)},{enabled:a&&void 0!==t,...i})}},92512:(e,t,n)=>{"use strict";n.d(t,{M:()=>i});var a=n(80263),s=n(51500),r=n(62136);let i=e=>{let{title:t,description:n,docsUrl:i,actions:l,className:o}=e;return(0,a.jsxs)("div",{className:(0,s.cn)("w-full mb-6 flex flex-col sm:flex-row md:items-center justify-between gap-4 ".concat(o)),"data-sentry-component":"FormHeader","data-sentry-source-file":"FormHeader.tsx",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h3",{className:"text-foreground text-xl prose",children:t}),n&&(0,a.jsx)("div",{className:"prose text-sm max-w-2xl",children:n})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row md:items-center gap-x-2",children:[void 0!==i&&(0,a.jsx)(r.A,{href:i}),l]})]})}},92882:(e,t,n)=>{"use strict";n.d(t,{BS:()=>l,Dm:()=>d,HJ:()=>v,Rf:()=>p,Uw:()=>c,Vw:()=>N,Xr:()=>b,aw:()=>x,bV:()=>i,cJ:()=>h,dX:()=>u,eh:()=>o,fh:()=>y,gu:()=>m,sZ:()=>g,tn:()=>j,xp:()=>f});var a=n(80263),s=n(53239),r=n(51500);let i="mx-auto w-full max-w-[1200px]",l="px-4 @lg:px-6 @xl:px-12 @2xl:px-20 @3xl:px-24",o=(0,s.forwardRef)((e,t)=>{let{className:n,bottomPadding:s,size:i="default",...o}=e;return(0,a.jsx)("div",{ref:t,...o,className:(0,r.cn)("mx-auto w-full",{small:"max-w-[768px]",default:"max-w-[1200px]",large:"max-w-[1600px]",full:"max-w-none"}[i],l,s&&"pb-16",n)})}),c=(0,s.forwardRef)((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("header",{...s,ref:t,className:(0,r.cn)("w-full","flex-col gap-3 py-6",n)})}),d=(0,s.forwardRef)((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("h1",{ref:t,...s,className:(0,r.cn)(n)})}),u=(0,s.forwardRef)((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("p",{ref:t,...s,className:(0,r.cn)("text-sm text-foreground-light",n)})}),m=(0,s.forwardRef)((e,t)=>{let{className:n,isFullWidth:s,topPadding:i,...l}=e;return(0,a.jsx)("div",{ref:t,...l,className:(0,r.cn)("flex flex-col first:pt-12 py-6",s?"w-full":"gap-3 lg:grid md:grid-cols-12",n)})}),h=(0,s.forwardRef)((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("div",{ref:t,...s,className:(0,r.cn)("w-full h-px bg-border",n)})}),g=(0,s.forwardRef)((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("h3",{ref:t,...s,className:(0,r.cn)("text-foreground text-xl",n)})}),x=(0,s.forwardRef)((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("p",{ref:t,...s,className:(0,r.cn)("text-sm text-foreground-light",n)})}),f=(0,s.forwardRef)((e,t)=>{let{className:n,children:s,title:i,...l}=e;return(0,a.jsxs)("div",{ref:t,...l,className:(0,r.cn)("col-span-4 xl:col-span-5 prose text-sm",n),children:[i&&(0,a.jsx)("h2",{children:i}),s]})}),p=(0,s.forwardRef)((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("div",{ref:t,...s,className:(0,r.cn)("col-span-8 xl:col-span-7","flex flex-col gap-6",n)})}),j=(0,s.forwardRef)((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("div",{ref:t,...s,className:(0,r.cn)("flex flex-col gap-3 items-center",n)})}),v=(0,s.forwardRef)((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("div",{ref:t,...s,className:(0,r.cn)("flex w-full items-center",n)})}),y=(0,s.forwardRef)((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("div",{ref:t,...s,className:(0,r.cn)("flex flex-row gap-3",n)})}),b=(0,s.forwardRef)((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("div",{ref:t,...s,className:(0,r.cn)("flex flex-col gap-3","min-w-[420px]",n)})}),N=(0,s.forwardRef)((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("div",{ref:t,...s,className:(0,r.cn)(i,l,"my-8 flex flex-col gap-8",n)})});c.displayName="ScaffoldHeader",d.displayName="ScaffoldTitle",u.displayName="ScaffoldDescription",o.displayName="ScaffoldContainer",h.displayName="ScaffoldDivider",m.displayName="ScaffoldSection",b.displayName="ScaffoldColumn",f.displayName="ScaffoldSectionDetail",p.displayName="ScaffoldSectionContent",j.displayName="ScaffoldFilterAndContent",v.displayName="ScaffoldActionsContainer",y.displayName="ScaffoldActionsGroup",N.displayName="ScaffoldContainerLegacy",g.displayName="ScaffoldSectionTitle",x.displayName="ScaffoldSectionDescription"},93074:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var a=n(80263),s=n(23445),r=n(88602),i=n(15601),l=n.n(i),o=n(40022);let c=e=>{let{title:t="",size:n="medium",children:i,ctaButtonLabel:c="",infoButtonLabel:d="",infoButtonUrl:u="",onClickCta:m=()=>{},loading:h=!1,disabled:g=!1,disabledMessage:x="",ctaUrl:f}=e,p=c&&m||u&&d;return(0,a.jsx)("div",{className:"flex h-full w-full items-center justify-center","data-sentry-component":"ProductEmptyState","data-sentry-source-file":"ProductEmptyState.tsx",children:(0,a.jsx)("div",{className:"flex space-x-4 rounded border bg-surface-100 p-6 shadow-md",children:(0,a.jsx)("div",{className:"flex flex-col",children:(0,a.jsxs)("div",{className:"".concat("medium"===n?"w-80":"w-[400px]"," space-y-4"),children:[(0,a.jsx)("h5",{className:"text-foreground",children:t}),(0,a.jsx)("div",{className:"flex flex-col space-y-2 text-foreground-light",children:i}),p&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[c&&f?(0,a.jsx)(o.$,{asChild:!0,type:"primary",children:(0,a.jsx)(l(),{href:f,children:c})}):c&&m?(0,a.jsx)(r.G,{type:"primary",onClick:m,loading:h,disabled:h||g,tooltip:{content:{side:"bottom",text:g&&x.length>0?x:void 0}},children:c}):null,u&&d?(0,a.jsx)(o.$,{type:"default",icon:(0,a.jsx)(s.A,{strokeWidth:1.5}),children:(0,a.jsx)("a",{target:"_blank",rel:"noreferrer",href:u,children:d})}):null]})]})})})})}},95119:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/database/triggers",function(){return n(63219)}])},98969:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(80263),s=n(87610);let r=e=>{let{resourceText:t,isFullPage:n=!1}=e,r=()=>(0,a.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200","data-sentry-component":"NoPermissionMessage","data-sentry-source-file":"NoPermission.tsx",children:(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)(s.A,{size:20,"data-sentry-element":"AlertCircle","data-sentry-source-file":"NoPermission.tsx"})}),(0,a.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",t]}),(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return n?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsx)("div",{className:"w-[550px]",children:(0,a.jsx)(r,{})})}):(0,a.jsx)(r,{})}}},e=>{var t=t=>e(e.s=t);e.O(0,[89,2313,726,4280,3730,7494,9014,6110,386,4915,4024,5599,7795,7326,1680,4156,9107,319,4400,2535,4017,5038,4444,6751,279,7399,1715,1072,1099,5216,5756,1190,7737,8742,636,6593,8792],()=>t(95119)),_N_E=e.O()}]);