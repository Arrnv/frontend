!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="7318c93b-d150-4e14-8e13-d2a84b886682",e._sentryDebugIdIdentifier="sentry-dbid-7318c93b-d150-4e14-8e13-d2a84b886682")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[679],{4601:(e,t,s)=>{s.d(t,{OJ:()=>b,Pl:()=>E,Pq:()=>g,Q5:()=>A,RK:()=>k,a0:()=>N,ag:()=>w,hm:()=>y,i9:()=>S,qP:()=>j,ue:()=>v});var a=s(80263),n=s(95043),l=s(28881),r=s(75189),i=s(20680),o=s(15601),c=s.n(o),d=s(53239),u=s(55966),m=s(51500),x=s(12644),p=s(93210),h=s(71139),f=s(78721);let y=(0,d.forwardRef)((e,t)=>{let{...s}=e;return(0,a.jsx)(u.Nt,{ref:t,...s,className:(0,m.cn)("w-full px-2 group",s.className)})}),g=(0,d.forwardRef)((e,t)=>{let{...s}=e;return(0,a.jsxs)(u.R6,{ref:t,...s,className:(0,m.cn)("w-full flex gap-1 items-center group px-3 text-sm font-normal font-mono uppercase text-lighter tracking-wide",s.className),children:[(0,a.jsx)(n.A,{className:"transition-all text-foreground-muted group-data-[state=open]:rotate-90",size:16,strokeWidth:1.5}),(0,a.jsx)("span",{className:"group-hover:not-disabled:text-foreground",children:s.title})]})}),j=(0,d.forwardRef)((e,t)=>{let{...s}=e;return(0,a.jsx)(u.Ke,{ref:t,...s,className:(0,m.cn)("w-full flex flex-col gap-0",s.className)})}),b=(0,d.forwardRef)((e,t)=>(0,a.jsx)("div",{ref:t,...e,className:(0,m.cn)("h-px bg-border-muted",e.className)})),v=(0,d.forwardRef)((e,t)=>{let{className:s,isActive:n,forceHoverState:l,...r}=e;return(0,a.jsx)(c(),{ref:t,...r,"aria-current":n,className:(0,m.cn)("text-sm","h-7 pl-3 pr-2","flex items-center justify-between rounded-md group relative",n?"bg-selection":"hover:bg-surface-200",l&&"bg-surface-200",n?"text-foreground":"text-foreground-light hover:text-foreground",s)})}),w=(0,d.forwardRef)((e,t)=>{let{isActive:s=!0,forceHoverState:n,isPreview:l,isOpened:r=!0,...i}=e;return(0,a.jsxs)(c(),{ref:t,...i,"aria-current":s,className:(0,m.cn)((0,x.u2)({isSelected:s&&!l,isOpened:r&&!l,isPreview:l}),"px-4",i.className),children:[!l&&s&&(0,a.jsx)("div",{className:"absolute left-0 h-full w-0.5 bg-foreground"}),i.children]})}),N=(0,d.forwardRef)((e,t)=>(0,a.jsx)("div",{ref:t,...e,className:(0,m.cn)("flex px-2 gap-2 items-center",e.className)})),k=(0,d.forwardRef)((e,t)=>{let{children:s,isLoading:n=!1,...i}=e;return(0,a.jsxs)("label",{htmlFor:i.name,className:"relative w-full",children:[(0,a.jsx)("span",{className:"sr-only",children:i["aria-labelledby"]}),(0,a.jsx)(p.p,{ref:t,type:"text",className:(0,m.cn)("h-[32px] md:h-[28px] w-full","text-base md:text-xs","pl-7","pr-7","w-full","rounded",i.className),...i}),s,n?(0,a.jsx)(l.A,{className:"animate-spin absolute left-2 text-foreground-muted",style:{top:7},size:14,strokeWidth:1.5}):(0,a.jsx)(r.A,{className:"absolute left-2 top-2 text-foreground-muted",size:14,strokeWidth:1.5})]})}),S=(0,d.forwardRef)((e,t)=>{let{value:s,onValueChange:n,contentClassName:l,triggerClassName:r,...o}=e;return(0,a.jsxs)(h.rI,{modal:!1,children:[(0,a.jsxs)(f.m_,{delayDuration:0,children:[(0,a.jsx)(h.ty,{asChild:!0,className:(0,m.cn)("absolute right-1 top-[.4rem] md:top-[.3rem]","text-foreground transition-colors hover:text-foreground data-[state=open]:text-foreground",r),children:(0,a.jsx)(f.k$,{children:(0,a.jsx)(i.A,{size:18,strokeWidth:1})})}),(0,a.jsx)(f.ZI,{side:"bottom",children:"Sort By"})]}),(0,a.jsx)(h.SQ,{side:"bottom",align:"end",className:(0,m.cn)("w-48",l),children:(0,a.jsx)(h.Hr,{value:s,onValueChange:n,children:o.children})})]})}),E=(0,d.forwardRef)((e,t)=>(0,a.jsx)(h.Ht,{ref:t,...e})),A=(0,d.forwardRef)((e,t)=>{let{illustration:s,title:n,description:l,actions:r,...i}=e;return(0,a.jsx)("div",{ref:t,...i,className:(0,m.cn)("border border-muted bg-surface-100 dark:bg-surface-75 flex flex-col gap-y-3 items-center justify-center rounded-md px-5 py-4",i.className),children:(0,a.jsxs)("div",{className:"w-full flex flex-col gap-y-1 items-center",children:[s,n&&(0,a.jsx)("p",{className:"text-xs text-foreground-light",children:n}),l&&(0,a.jsx)("p",{className:"text-xs text-foreground-lighter text-center",children:l}),r&&(0,a.jsx)("div",{className:"mt-2",children:r}),i.children]})})})},5588:(e,t,s)=>{s.d(t,{P:()=>r});var a=s(77569),n=s(91435),l=s(5483);let r=()=>{var e,t;let{data:s}=(0,l.YA)(),{data:r,isLoading:i}=(0,n.z)({projectRef:null==s?void 0:s.ref,connectionString:null==s?void 0:s.connectionString}),o=a.o.find(e=>"iceberg_wrapper"===e.id);if(!o||"wrapper"!==o.type)return"not-found";let c=o.meta,d=null==r?void 0:r.find(e=>"wrappers"===e.name),u=!!(null==d?void 0:d.installed_version),m=(null!=(e=null==d?void 0:d.installed_version)?e:"")>=(null!=(t=null==c?void 0:c.minimumExtensionVersion)?t:"");return i?"loading":u?m?"installed":"needs-upgrade":"not-installed"}},9387:(e,t,s)=>{s.d(t,{Z:()=>n}),s(80263);var a=s(53239);function n(e){let t=(0,a.useRef)();return(0,a.useEffect)(()=>{t.current=e}),t.current}s(54955),s(34531)},10455:(e,t,s)=>{s.d(t,{a:()=>l,h:()=>r});var a=s(80263),n=s(25643);let l=e=>{let{name:t}=e;return(0,a.jsx)("div",{className:"text-typography-body-light [[data-theme*=dark]_&]:text-typography-body-dark flex cursor-not-allowed items-center space-x-2 rounded bg-gray-600 py-0.5 px-2 text-sm","data-sentry-component":"BadgeDisabled","data-sentry-source-file":"Badges.tsx",children:(0,a.jsx)("span",{className:"opacity-50",children:t})})},r=e=>{let{name:t,handleRemove:s}=e;return(0,a.jsxs)("div",{className:"text-typography-body-light [[data-theme*=dark]_&]:text-typography-body-dark flex items-center space-x-2 rounded bg-surface-300 py-0.5 px-2 text-sm",onClick:e=>e.preventDefault(),"data-sentry-component":"BadgeSelected","data-sentry-source-file":"Badges.tsx",children:[(0,a.jsx)("span",{children:t}),(0,a.jsx)(n.A,{size:12,className:"cursor-pointer opacity-50 transition hover:opacity-100",onClick:e=>{e.preventDefault(),e.stopPropagation(),s()},"data-sentry-element":"X","data-sentry-source-file":"Badges.tsx"})]})}},17498:(e,t,s)=>{s.d(t,{f:()=>d});var a=s(47319),n=s(32144),l=s(80251),r=s(73969),i=s(15629),o=s(30784);async function c(e){let{projectRef:t,connectionString:s,originalPolicy:n}=e,l=new Headers;s&&l.set("x-connection-encrypted",s);let{sql:r}=a.A.policies.remove(n),{result:o}=await (0,i.E)({projectRef:t,connectionString:s,sql:r,queryKey:["policy","delete",n.id]});return o}let d=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,n.jE)();return(0,l.n)(e=>c(e),{async onSuccess(t,s,n){let{projectRef:l}=s;await a.invalidateQueries(o.S.list(l)),await (null==e?void 0:e(t,s,n))},async onError(e,s,a){void 0===t?r.oR.error("Failed to delete database policy: ".concat(e.message)):t(e,s,a)},...s})}},24771:(e,t,s)=>{s.d(t,{A:()=>n});var a=s(80263);s(53239);let n=function(e){let{children:t,target:s="_blank",href:n,className:l,onClick:r,style:i}=e;return(0,a.jsx)("a",{onClick:r,href:n,target:s,rel:"noopener noreferrer",style:i,"data-sentry-component":"Link","data-sentry-source-file":"Link.tsx",children:t})}},26860:(e,t,s)=>{s.d(t,{A:()=>y});var a=s(80263),n=s(10726),l=s(11203),r=s.n(l),i=s(53239),o=s(1848),c=s(59676),d=s(92777),u=s(70800),m=s(51500),x=s(60115);let p=(0,i.createContext)({onChange:e=>{},selected:void 0});var h=s(80903);function f(e){let{children:t,className:s,buttonClassName:l,descriptionText:h,error:f,icon:y,id:g="",name:j="",label:b,labelOptional:v,layout:w,value:N,onChange:k,onFocus:S,onBlur:E,style:A,size:C="medium",defaultValue:_,validation:T,disabled:P,optionsWidth:I}=e,[R,L]=(0,i.useState)(void 0),[M,D]=(0,i.useState)({}),z=(0,u.A)("listbox"),F=(0,i.useRef)(null),{formContextOnChange:O,values:B,errors:W,handleBlur:U,touched:G,fieldLevelValidation:q}=(0,x.x)();B&&!N&&(N=B[g||j],_=B[g||j]),f||(W&&!f&&(f=W[g||j]),f=G&&G[g||j]?f:void 0),(0,i.useEffect)(()=>{void 0!==N&&L(N)},[N]),(0,i.useEffect)(()=>{function e(){var e;document.documentElement.style.setProperty("--width-listbox","".concat(I||(null==(e=F.current)?void 0:e.offsetWidth),"px"))}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),(0,i.useEffect)(()=>{var e;let s=r()(t);function a(e){return s.find(t=>t.props.value===e)}if(N){L(N);let e=a(N);D((null==e?void 0:e.props)?e.props:void 0);return}if(R){let e=a(R);D((null==e?void 0:e.props)?e.props:void 0);return}if(_){L(_);let e=a(R);D((null==e?void 0:e.props)?e.props:void 0);return}D(null==(e=s[0])?void 0:e.props)},[R]);let V=[z.container,z.base,l],H=[z.addOnBefore];return f&&V.push(z.variants.error),f||V.push(z.variants.standard),y&&H.push(z.with_icon),C&&V.push(z.size[C]),P&&V.push(z.disabled),(0,a.jsx)(o.H,{label:b,labelOptional:v,layout:w,id:g,error:f,descriptionText:h,className:s,style:A,size:C,"data-sentry-element":"FormLayout","data-sentry-component":"Listbox","data-sentry-source-file":"Listbox2.tsx",children:(0,a.jsxs)(n.bL,{"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:[(0,a.jsx)(n.l9,{asChild:!0,disabled:P,"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:(0,a.jsxs)("button",{"data-size":C,ref:F,className:(0,m.cn)(V),onBlur:function(e){U&&U(e),E&&E(e)},onFocus:S,name:j,id:g,children:[(0,a.jsxs)("span",{className:(0,m.cn)(H),children:[y&&(0,a.jsx)(d.A,{size:C,icon:y}),(null==M?void 0:M.addOnBefore)&&(0,a.jsx)(M.addOnBefore,{}),(0,a.jsx)("span",{className:z.label,children:null==M?void 0:M.label})]}),(0,a.jsx)("span",{className:z.chevron_container,children:(0,a.jsx)("svg",{className:z.chevron,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-sentry-element":"svg","data-sentry-source-file":"Listbox2.tsx",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd","data-sentry-element":"path","data-sentry-source-file":"Listbox2.tsx"})})}),f&&(0,a.jsx)("div",{className:z.actions_container,children:f&&(0,a.jsx)(c.A,{size:C})})]})}),(0,a.jsx)(n.UC,{sideOffset:6,loop:!0,side:"bottom",align:"center",className:z.options_container,"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:(0,a.jsx)("div",{children:(0,a.jsx)(p.Provider,{value:{onChange:function(e){k&&k(e),L(e);let t={};t.target={type:"select",name:j,id:g,value:e,checked:void 0},O&&O(t),T&&q(g,T(e))},selected:R},"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:t})})})]})})}f.Option=function(e){let{id:t,value:s,label:l,disabled:r=!1,children:i,className:o="",addOnBefore:c}=e,d=(0,u.A)("listbox");return(0,a.jsx)(p.Consumer,{"data-sentry-element":"unknown","data-sentry-component":"SelectOption","data-sentry-source-file":"Listbox2.tsx",children:e=>{let{onChange:l,selected:u}=e,x=u===s;return(0,a.jsxs)(n.q7,{className:(0,m.cn)(d.option,x?d.option_active:" ",r?d.option_disabled:" ",o),onSelect:()=>r?{}:l(s),children:[(0,a.jsxs)("div",{className:d.option_inner,children:[c&&c({active:x,selected:u}),(0,a.jsx)("span",{children:"function"==typeof i?i({active:x,selected:u}):i})]}),x?(0,a.jsx)("span",{className:(0,m.cn)(d.option_check,x?d.option_check_active:""),children:(0,a.jsx)(h.A,{className:d.option_check_icon,"aria-hidden":"true"})}):null]},t)}})};let y=f},28758:(e,t,s)=>{s.d(t,{$Q:()=>l,S3:()=>a,z_:()=>n});let a=(e,t)=>[{id:"policy-1",preview:!1,templateName:"Enable read access to everyone",description:"This policy gives read access to your table for all users via the SELECT operation.",statement:'\ncreate policy "Enable read access for all users"\non "'.concat(e,'"."').concat(t,'"\nfor select using (true);').trim(),name:"Enable read access for all users",definition:"true",check:"",command:"SELECT",roles:[]},{id:"policy-2",preview:!1,templateName:"Enable insert access for authenticated users only",description:"This policy gives insert access to your table for all authenticated users only.",statement:'\ncreate policy "Enable insert for authenticated users only"\non "'.concat(e,'"."').concat(t,'"\nfor insert to authenticated\nwith check (true);').trim(),name:"Enable insert for authenticated users only",definition:"",check:"true",command:"INSERT",roles:["authenticated"]},{id:"policy-3",preview:!1,templateName:"Enable delete access for users based on their user ID *",description:'This policy assumes that your table has a column "user_id", and allows users to delete rows which the "user_id" column matches their ID',statement:'\ncreate policy "Enable delete for users based on user_id"\non "'.concat(e,'"."').concat(t,'"\nfor delete using (\n  (select auth.uid()) = user_id\n);').trim(),name:"Enable delete for users based on user_id",definition:"(select auth.uid()) = user_id",check:"",command:"DELETE",roles:[]},{id:"policy-4",preview:!1,templateName:"Enable insert access for users based on their user ID *",description:'This policy assumes that your table has a column "user_id", and allows users to insert rows which the "user_id" column matches their ID',statement:'\ncreate policy "Enable insert for users based on user_id"\non "'.concat(e,'"."').concat(t,'"\nfor insert with check (\n  (select auth.uid()) = user_id\n);').trim(),name:"Enable insert for users based on user_id",definition:"",check:"(select auth.uid()) = user_id",command:"INSERT",roles:[]},{id:"policy-5",preview:!0,name:"Policy with table joins",templateName:"Policy with table joins",description:"\nQuery across tables to build more advanced RLS rules\n\nAssuming 2 tables called `teams` and `members`, you can query both tables in the policy to control access to the members table.",statement:'\ncreate policy "Members can update team details if they belong to the team"\non teams for update using (\n  (select auth.uid()) in (\n    select user_id from members where team_id = id\n  )\n);\n'.trim(),definition:"(select auth.uid()) in (select user_id from members where team_id = id)",check:"",command:"UPDATE",roles:[]},{id:"policy-6",preview:!0,templateName:"Policy with security definer functions",description:"\nUseful in a many-to-many relationship where you want to restrict access to the linking table.\n\nAssuming 2 tables called `teams` and `members`, you can use a security definer function in combination with a policy to control access to the members table.".trim(),statement:'\ncreate or replace function get_teams_for_user(user_id uuid)\nreturns setof bigint as $$\n  select team_id from members where user_id = $1\n$$ stable language sql security definer;\n\ncreate policy "Team members can update team members if they belong to the team"\non members\nfor all using (\n  team_id in (select get_teams_for_user(auth.uid()))\n);\n'.trim(),name:"Policy with security definer functions",definition:"team_id in (select get_teams_for_user(auth.uid()))",check:"",command:"ALL",roles:[]},{id:"policy-7",preview:!0,name:"Policy to implement Time To Live (TTL)",templateName:"Policy to implement Time To Live (TTL)",description:"\nImplement a TTL-like feature that you see in Instagram stories or Snapchat where messages expire after a day.\n\nRows under the table are available only if they have been created within the last 24 hours.",statement:'\ncreate policy "Stories are live for a day"\non "'.concat(e,'"."').concat(t,"\"\nfor select using (\n  created_at > (current_timestamp - interval '1 day')\n);\n").trim(),definition:"created_at > (current_timestamp - interval '1 day')",check:"",command:"SELECT",roles:[]},{id:"policy-8",preview:!1,templateName:"Allow users to only view their own data",description:"Restrict users to reading only their own data.",statement:'\ncreate policy "Enable users to view their own data only"\non "'.concat(e,'"."').concat(t,'"\nfor select\nto authenticated\nusing (\n  (select auth.uid()) = user_id\n);').trim(),name:"Enable users to view their own data only",definition:"(select auth.uid()) = user_id",check:"",command:"SELECT",roles:["authenticated"]}],n=()=>[{id:"policy-broadcast-1",preview:!1,templateName:"Allow listening for broadcasts for authenticated users only",description:"This policy allows listening for broadcasts for authenticated users only.",statement:"\ncreate policy  \"Allow listening for broadcasts for authenticated users only\"\non realtime.messages for select\nto authenticated\nusing ( realtime.messages.extension = 'broadcast' );".trim(),name:"Allow listening for broadcasts for authenticated users only",definition:"realtime.messages.extension = 'broadcast'",check:"",command:"SELECT",roles:["authenticated"]},{id:"policy-broadcast-2",preview:!1,templateName:"Allow pushing broadcasts for authenticated users only",description:"This policy allows pushing broadcasts for authenticated users only.",statement:"\ncreate policy \"Allow pushing broadcasts for authenticated users only\"\nON realtime.messages for insert\nTO authenticated\nwith check ( realtime.messages.extension = 'broadcast' );".trim(),name:"Allow pushing broadcasts for authenticated users only",definition:"realtime.messages.extension = 'broadcast'",check:"realtime.messages.extension = 'broadcast'",command:"INSERT",roles:["authenticated"]},{id:"policy-broadcast-3",preview:!1,templateName:"Allow listening for broadcasts from a specific channel",description:"This policy allows listening for broadcasts from a specific channel.",statement:"\ncreate policy \"Allow listening for broadcasts from a specific channel\"\non realtime.messages for select\nusing ( realtime.messages.extension = 'broadcast' AND realtime.topic() = 'channel_name' );".trim(),name:"Allow listening for broadcasts from a specific channel",definition:"realtime.messages.extension = 'broadcast' AND realtime.topic() = 'channel_name'",check:"",command:"SELECT",roles:[]},{id:"policy-broadcast-4",preview:!1,templateName:"Allow pushing broadcasts to specific channel",description:"This policy allow pushing broadcasts to specific channel.",statement:"\ncreate policy \"Allow pushing broadcasts to specific channel\"\nON realtime.messages for insert\nwith check ( realtime.messages.extension = 'broadcast' AND realtime.topic() = 'channel_name' );".trim(),name:"Allow pushing broadcasts to specific channel",definition:"realtime.messages.extension = 'broadcast' AND realtime.topic() = 'channel_name'",check:"realtime.messages.extension = 'broadcast' AND realtime.topic() = 'channel_name'",command:"INSERT",roles:[]},{id:"policy-presences-1",preview:!1,templateName:"Allow listening for presences on all channels for authenticated users only",description:"This policy enables listening for presences on all channels for all authenticated users only.",statement:"\ncreate policy \"Allow listening for presences on all channels for authenticated users only\"\non realtime.messages for select\nto authenticated\nusing ( realtime.messages.extension = 'presence' );".trim(),name:"Allow listening for presences on all channels for authenticated users only",definition:"realtime.messages.extension = 'presence'",check:"",command:"SELECT",roles:["authenticated"]},{id:"policy-presences-2",preview:!1,templateName:"Allow broadcasting presences on all channels for authenticated users only",description:"This policy enables broadcasting presences on all channels for all authenticated users only.",statement:"\ncreate policy \"Allow broadcasting presences on all channels for authenticated users only\"\nON realtime.messages for insert\nTO authenticated\nwith check ( realtime.messages.extension = 'presence' );\n  ;".trim(),name:"Allow broadcasting presences on all channels for authenticated users only",definition:"realtime.messages.extension = 'presence'",check:"realtime.messages.extension = 'presence'",command:"INSERT",roles:["authenticated"]},{id:"policy-presences-3",preview:!1,templateName:"Allow listening for presences from a specific channel",description:"This policy enables listening for presences from a specific channel.",statement:"\ncreate policy \"Allow listening for presences from a specific channel\"\non realtime.messages for select\nusing ( realtime.messages.extension = 'presence' AND realtime.topic() = 'channel_name' );".trim(),name:"Allow listening for presences from a specific channel",definition:"realtime.messages.extension = 'presence' AND realtime.topic() = 'channel_name'",check:"",command:"SELECT",roles:[]},{id:"policy-presences-4",preview:!1,templateName:"Publish presence to a specific channel",description:"This policy allows publishing presence to a specific channel.",statement:"\ncreate policy \"Publish presence to a specific channel\"\nON realtime.messages for insert\nwith check ( realtime.messages.extension = 'presence' AND realtime.topic() = 'channel_name' );\n  ;".trim(),name:"Publish presence to a specific channel",definition:"realtime.messages.extension = 'presence' AND realtime.topic() = 'channel_name'",check:"realtime.messages.extension = 'presence' AND realtime.topic() = 'channel_name'",command:"INSERT",roles:[]}],l=()=>[{id:"policy-queues-1",preview:!1,templateName:"Allow access to queue",statement:"".trim(),name:"Allow anon and authenticated to access messages from queue",description:"Base policy to ensure that anon and authenticated can only access appropriate rows. USING and CHECK statements will need to be adjusted accordingly",definition:"true",check:"true",command:"ALL",roles:["anon","authenticated"]}]},32035:(e,t,s)=>{s.d(t,{A:()=>d});var a=s(80263),n=s(91194),l=s(95043),r=s(15601),i=s.n(r),o=s(53239),c=s(51500);let d=e=>{let t,{title:s,description:r,children:d,footer:u,url:m="",linkHref:x="",imgUrl:p,imgAlt:h,icon:f,className:y,loading:g=!1,fixedHeight:j=!0,hideChevron:b=!1,titleClass:v="",containerElement:w,...N}=e,k=m||x||N.onClick,S={},E=w&&o.isValidElement(w)?e=>(0,o.cloneElement)(w,{...e}):void 0;N.onClick?(t=null!=E?E:"button",S=N):x?(t=null!=E?E:i(),S={href:x,...N}):m?(t=null!=E?E:"a",S={href:m,...N}):(t=null!=E?E:"div",S=N);let A=["group relative text-left","bg-surface-100","border border-surface","rounded-md p-5 flex flex-row","transition ease-in-out duration-150"];k&&(A=[...A,"cursor-pointer","hover:bg-surface-200","hover:border-control"]),j&&(A=[...A,"min-h-32 md:min-h-44"]);let C=e=>{let{children:t}=e;return(0,a.jsx)("div",{className:"mr-4 flex flex-col","data-sentry-component":"ImageContainer","data-sentry-source-file":"CardButton.tsx",children:t})},_=(0,a.jsxs)(a.Fragment,{children:[p&&(0,a.jsx)(C,{children:(0,a.jsx)("img",{className:" transition-all group-hover:scale-110 ",src:"".concat(p),alt:"".concat(h),width:"26"})}),f&&(0,a.jsx)(C,{children:f}),(0,a.jsxs)("div",{className:"flex h-full w-full flex-col space-y-2",children:["string"==typeof s?(0,a.jsx)("h5",{className:"text-foreground pr-5 ".concat(v),children:s}):s,(d||r)&&(0,a.jsxs)("div",{className:"flex w-full flex-1 flex-col",children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:r}),(0,a.jsx)("div",{className:"w-full",children:d&&d})]}),u&&(0,a.jsx)("div",{className:"w-full !mt-auto",children:u})]}),k&&(0,a.jsx)("div",{className:" absolute right-4 top-4 text-foreground-lighter transition-all duration-200 group-hover:right-3 group-hover:text-foreground ",children:g?(0,a.jsx)(n.A,{className:"animate-spin"}):b?(0,a.jsx)(a.Fragment,{}):(0,a.jsx)(l.A,{})})]});return(0,a.jsx)(t,{...S,className:(0,c.cn)(A,y),"data-sentry-element":"Container","data-sentry-component":"CardButton","data-sentry-source-file":"CardButton.tsx",children:_})}},33647:(e,t,s)=>{s.d(t,{j:()=>d});var a=s(56947),n=s(89811),l=s(65172),r=s(5483),i=s(63492),o=s(30784);async function c(e,t,s){let{projectRef:a,connectionString:r,schema:i}=e;if(!a)throw Error("projectRef is required");let o=new Headers(s);r&&o.set("x-connection-encrypted",r);let{data:c,error:d}=await (0,l.Jt)("/platform/pg-meta/{ref}/policies",{params:{header:{"x-connection-encrypted":r,"x-pg-application-name":n.r},path:{ref:a},query:{included_schemas:i||"",excluded_schemas:""}},headers:o,signal:t});return d&&(0,l.H4)(d),c}let d=function(e){let{projectRef:t,connectionString:s,schema:n}=e,{enabled:l=!0,...d}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:u}=(0,r.YA)(),m=(null==u?void 0:u.status)===i.BU.ACTIVE_HEALTHY;return(0,a.I)(o.S.list(t,n),e=>{let{signal:a}=e;return c({projectRef:t,connectionString:s,schema:n},a)},{enabled:l&&void 0!==t&&m,...d})}},35768:(e,t,s)=>{s.d(t,{A:()=>d});var a=s(80263),n=s(53239),l=s(1848),r=s(70800),i=s(60115);let o=(0,n.createContext)({parentCallback:e=>{},parentSize:""});function c(e){let{className:t,id:s="",name:n="",label:l,afterLabel:c,beforeLabel:d,description:u,checked:m,value:x,onChange:p,onBlur:h,size:f="medium",disabled:y=!1,...g}=e,{formContextOnChange:j,values:b,handleBlur:v}=(0,i.x)(),w=(0,r.A)("checkbox");return(0,a.jsx)(o.Consumer,{"data-sentry-element":"unknown","data-sentry-component":"Checkbox","data-sentry-source-file":"Checkbox.tsx",children:e=>{let{parentCallback:r,parentSize:i}=e,o=s||n||(l?l.toLowerCase().replace(/^[^A-Z0-9]+/gi,"").replace(/ /g,"-"):void 0);f=i||f;let N=n||o,k=null!=m?m:void 0,S=[w.container];return t&&S.push(t),b&&void 0===m&&(k=b[s||n]),(0,a.jsxs)("div",{className:S.join(" "),children:[(0,a.jsx)("input",{id:o,name:N,type:"checkbox",className:[w.base,w.size[f]].join(" "),onChange:function(e){r&&r(e),p&&p(e),j&&j(e)},onBlur:function(e){v&&setTimeout(()=>{v(e)},100),h&&h(e)},checked:k,value:x||o,disabled:y,...g}),(0,a.jsxs)("label",{className:[w.label.base,w.label[f]].join(" "),htmlFor:o,children:[(0,a.jsxs)("span",{children:[d&&(0,a.jsx)("span",{className:[w.label_before.base,w.label_before[f]].join(" "),children:d}),l,c&&(0,a.jsx)("span",{className:[w.label_after.base,w.label_after[f]].join(" "),children:c})]}),u&&(0,a.jsx)("p",{className:[w.description.base,w.description[f]].join(" "),children:u})]})]})}})}c.Group=function(e){let{id:t,layout:s="vertical",error:n,descriptionText:i,label:d,afterLabel:u,beforeLabel:m,labelOptional:x,children:p,className:h,options:f,onChange:y,size:g="medium"}=e,j=(0,r.A)("checkbox");return(0,a.jsx)(l.H,{label:d,afterLabel:u,beforeLabel:m,labelOptional:x,layout:s,id:t,error:n,descriptionText:i,className:h,size:g,"data-sentry-element":"FormLayout","data-sentry-component":"Group","data-sentry-source-file":"Checkbox.tsx",children:(0,a.jsx)(o.Provider,{value:{parentCallback:e=>{y&&y(e)},parentSize:g},"data-sentry-element":"unknown","data-sentry-source-file":"Checkbox.tsx",children:(0,a.jsx)("div",{className:j.group,children:f?f.map(e=>(0,a.jsx)(c,{id:e.id,value:e.value,label:e.label,beforeLabel:e.beforeLabel,afterLabel:e.afterLabel,checked:e.checked,name:e.name,description:e.description,defaultChecked:e.defaultChecked},e.id)):p})})})};let d=c},37352:(e,t,s)=>{s.d(t,{vd:()=>sK,J:()=>e7,u4:()=>s_,dr:()=>sV});var a=s(80263),n=s(93896),l=s.n(n),r=s(26089),i=s.n(r),o=s(97344),c=s.n(o),d=s(86727),u=s.n(d),m=s(53239),x=s(80535),p=s(85278),h=s(63492),f=s(34424),y=s(52308),g=s(83927),j=s.n(g),b=s(50204);let v=e=>{let{visible:t=!1,selectedItemsToDelete:s=[],onSelectCancel:n=j(),onSelectDelete:l=j()}=e,[r,i]=(0,m.useState)(!1);(0,m.useEffect)(()=>{i(!1)},[t]);let o=s.length>1,c=o?"Confirm deletion of ".concat(s.length," items"):1===s.length?"Confirm deletion of ".concat(s[0].name):"",d=o?"Are you sure you want to delete the selected ".concat(s.length," items?"):1===s.length?"Are you sure you want to delete the selected ".concat(s[0].type.toLowerCase(),"?"):"";return(0,a.jsx)(b.A,{visible:t,title:(0,a.jsx)("span",{className:"break-words",children:c}),size:"medium",onCancel:n,onConfirm:()=>{i(!0),l()},variant:"destructive",alert:{base:{variant:"destructive"},title:"This action cannot be undone",description:d},"data-sentry-element":"ConfirmationModal","data-sentry-component":"ConfirmDeleteModal","data-sentry-source-file":"ConfirmDeleteModal.tsx"})};var w=s(53434),N=s.n(w),k=s(67120),S=s(27642),E=s(95708),A=s(26860),C=s(40022),_=s(73969),T=s(67575),P=s(82587),I=s(52647),R=s(56947),L=s(65172);let M=async(e,t)=>{let{projectRef:s,bucketId:a,path:n,options:l}=e;if(!a)throw Error("bucketId is required");let{data:r,error:i}=await (0,L.bE)("/platform/storage/{ref}/buckets/{id}/objects/public-url",{params:{path:{ref:s,id:a}},body:{path:n,options:l},signal:t});return i&&(0,L.H4)(i),r},D=async(e,t)=>{let{projectRef:s,bucketId:a,path:n,expiresIn:l,options:r}=e;if(!a)throw Error("bucketId is required");let{data:i,error:o}=await (0,L.bE)("/platform/storage/{ref}/buckets/{id}/objects/sign",{params:{path:{ref:s,id:a}},body:{path:n,expiresIn:l,options:r},signal:t});return o&&(0,L.H4)(o),i},z=async(e,t,s,a,n)=>a?(await M({projectRef:t,bucketId:s,path:e})).publicUrl:(await D({projectRef:t,bucketId:s,path:e,expiresIn:null!=n?n:604800})).signedUrl,F=function(e){let{file:t,projectRef:s,bucket:a}=e,{...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{getPathAlongOpenedFolders:l}=(0,f.$)(),r=[l(!1),null==t?void 0:t.name].join("/");return(0,R.I)({queryKey:[s,"buckets",a.public,a.id,"file",r],queryFn:()=>z(r,s,a.id,a.public,604800),staleTime:6048e5,...n})},O=()=>{var e,t,s,a,n;let{projectRef:l,selectedBucket:r,getPathAlongOpenedFolders:i}=(0,f.$)(),{data:o}=(0,P.A)({projectRef:l}),{data:c}=(0,T.G)({projectRef:l}),d=null!=(n=null==c||null==(e=c.app_config)?void 0:e.protocol)?n:"https",u=null==c||null==(t=c.app_config)?void 0:t.endpoint,x="".concat(d,"://").concat(null!=u?u:"-"),p=(0,m.useCallback)((e,t)=>z([i(!1),e].join("/"),l,r.id,r.public,t),[l,r.id,r.public,i]);return{onCopyUrl:(0,m.useCallback)((e,t)=>{let s=p(e,t).then(e=>{var t;return(null==o||null==(t=o.customDomain)?void 0:t.status)==="active"?e.replace(x,"https://".concat(o.customDomain.hostname)):e});return(0,I.l)(s,()=>{_.oR.success("Copied URL for ".concat(e," to clipboard."))})},[x,null==o||null==(s=o.customDomain)?void 0:s.hostname,null==o||null==(a=o.customDomain)?void 0:a.status,p])}},B={days:86400,weeks:604800,months:2592e3,years:31536e3},W=()=>{let{onCopyUrl:e}=O(),{selectedFileCustomExpiry:t,setSelectedFileCustomExpiry:s}=(0,f.$)(),n=void 0!==t,l=()=>s(void 0);return(0,a.jsx)(k.A,{hideFooter:!0,size:"small",header:"Custom expiry for signed URL",visible:n,alignFooter:"right",confirmText:"Get URL",onCancel:()=>l(),"data-sentry-element":"Modal","data-sentry-component":"CustomExpiryModal","data-sentry-source-file":"CustomExpiryModal.tsx",children:(0,a.jsx)(S.A,{validateOnBlur:!0,initialValues:{expiresIn:"",units:"days"},onSubmit:async(s,a)=>{let{setSubmitting:n}=a;n(!0),await e(t.name,s.expiresIn*B[s.units]),n(!1),l()},validate:e=>{let t={};return""!==e.expiresIn&&e.expiresIn<=0&&(t.expiresIn="Expiry duration cannot be less than 0"),t},"data-sentry-element":"Form","data-sentry-source-file":"CustomExpiryModal.tsx",children:e=>{let{values:t,isSubmitting:s}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(k.A.Content,{children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light mb-2",children:"Enter the duration for which the URL will be valid for:"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(E.A,{disabled:s,type:"number",id:"expiresIn",className:"w-full"}),(0,a.jsxs)(A.A,{id:"units",className:"w-[150px]",children:[(0,a.jsx)(A.A.Option,{id:"days",label:"days",value:"days",children:"days"}),(0,a.jsx)(A.A.Option,{id:"weeks",label:"weeks",value:"weeks",children:"weeks"}),(0,a.jsx)(A.A.Option,{id:"months",label:"months",value:"months",children:"months"}),(0,a.jsx)(A.A.Option,{id:"years",label:"years",value:"years",children:"years"})]})]}),""!==t.expiresIn&&(0,a.jsxs)("p",{className:"text-sm text-foreground-light mt-2",children:["URL will expire on"," ",N()().add(t.expiresIn,t.units).format(h.QM)]})]}),(0,a.jsx)(k.A.Separator,{}),(0,a.jsxs)(k.A.Content,{className:"flex items-center justify-end space-x-2",children:[(0,a.jsx)(C.$,{type:"default",onClick:()=>l(),children:"Cancel"}),(0,a.jsx)(C.$,{disabled:""===t.expiresIn||s,loading:s,htmlType:"submit",type:"primary",children:"Get signed URL"})]})]})}})})};var U=s(51500),G=s(9711);s(25667);var q=s(60045),V=s(75019),H=s(284),$=s(29277),Y=s(81774),J=s(95043),Q=s(20680),K=s(66973);let Z=e=>{let{id:t=""}=e,s=(0,V.SE)(q.aG.STORAGE_WRITE,"*"),{columns:n,selectedItems:r,setSelectedItems:i,setSortBy:o,setSortByOrder:c,addNewFolderPlaceholder:d}=(0,f.$)(),m=(0,f.$)(),x=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;d(e)},p=e=>{let t=n[e].items.filter(e=>e.type===y.Vl.FILE).map(t=>({...t,columnIndex:e})),s=l()(t.map(e=>e.id));r.filter(e=>e.id&&s.includes(e.id)).length===t.length?i(r.filter(e=>e.id&&!s.includes(e.id))):i(u()(r.concat(t),"id"))};return(0,a.jsxs)(G.W1,{id:t,animation:"fade","data-sentry-element":"Menu","data-sentry-component":"ColumnContextMenu","data-sentry-source-file":"ColumnContextMenu.tsx",children:[s&&[(0,a.jsxs)(G.q7,{onClick:e=>{let{props:t}=e;return x(t.index)},children:[(0,a.jsx)(H.A,{size:"14",strokeWidth:1}),(0,a.jsx)("span",{className:"ml-2 text-xs",children:"New folder"})]},"create-folder"),(0,a.jsx)(G.wv,{},"create-folder-separator")],(0,a.jsxs)(G.q7,{onClick:e=>{let{props:t}=e;return p(t.index)},"data-sentry-element":"Item","data-sentry-source-file":"ColumnContextMenu.tsx",children:[(0,a.jsx)($.A,{size:"14",strokeWidth:1,"data-sentry-element":"Clipboard","data-sentry-source-file":"ColumnContextMenu.tsx"}),(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Select all items"})]}),(0,a.jsxs)(G.Qw,{label:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Y.A,{size:"14",strokeWidth:1}),(0,a.jsx)("span",{className:"text-xs",children:"View"})]}),arrow:(0,a.jsx)(J.A,{size:"14",strokeWidth:1}),"data-sentry-element":"Submenu","data-sentry-source-file":"ColumnContextMenu.tsx",children:[(0,a.jsx)(G.q7,{onClick:()=>m.setView(y.JB.COLUMNS),"data-sentry-element":"Item","data-sentry-source-file":"ColumnContextMenu.tsx",children:(0,a.jsx)("span",{className:"ml-2 text-xs",children:"As columns"})}),(0,a.jsx)(G.q7,{onClick:()=>m.setView(y.JB.LIST),"data-sentry-element":"Item","data-sentry-source-file":"ColumnContextMenu.tsx",children:(0,a.jsx)("span",{className:"ml-2 text-xs",children:"As list"})})]}),(0,a.jsxs)(G.Qw,{label:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Q.A,{size:"14",strokeWidth:1}),(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Sort by"})]}),arrow:(0,a.jsx)(J.A,{size:"14",strokeWidth:1}),"data-sentry-element":"Submenu","data-sentry-source-file":"ColumnContextMenu.tsx",children:[(0,a.jsx)(G.q7,{onClick:()=>o(y.NA.NAME),"data-sentry-element":"Item","data-sentry-source-file":"ColumnContextMenu.tsx",children:(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Name"})}),(0,a.jsx)(G.q7,{onClick:()=>o(y.NA.CREATED_AT),"data-sentry-element":"Item","data-sentry-source-file":"ColumnContextMenu.tsx",children:(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Last created"})}),(0,a.jsx)(G.q7,{onClick:()=>o(y.NA.UPDATED_AT),"data-sentry-element":"Item","data-sentry-source-file":"ColumnContextMenu.tsx",children:(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Last modified"})}),(0,a.jsx)(G.q7,{onClick:()=>o(y.NA.LAST_ACCESSED_AT),"data-sentry-element":"Item","data-sentry-source-file":"ColumnContextMenu.tsx",children:(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Last accessed"})})]}),(0,a.jsxs)(G.Qw,{label:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(K.A,{size:"14",strokeWidth:1}),(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Sort by order"})]}),arrow:(0,a.jsx)(J.A,{size:"14",strokeWidth:1}),"data-sentry-element":"Submenu","data-sentry-source-file":"ColumnContextMenu.tsx",children:[(0,a.jsx)(G.q7,{onClick:()=>c(y.ou.ASC),"data-sentry-element":"Item","data-sentry-source-file":"ColumnContextMenu.tsx",children:(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Ascending"})}),(0,a.jsx)(G.q7,{onClick:()=>c(y.ou.DESC),"data-sentry-element":"Item","data-sentry-source-file":"ColumnContextMenu.tsx",children:(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Descending"})})]})]})};var X=s(15903),ee=s(48250),et=s.n(ee),es=s(93864),ea=s(3829),en=s(90437),el=s(34531),er=s(35768),ei=s(48388),eo=s.n(ei),ec=s(84305),ed=s.n(ec),eu=s(91194),em=s(25250),ex=s(30056),ep=s(64223),eh=s(72167),ef=s(11192),ey=s(67201),eg=s(88542),ej=s(45580),eb=s(87610),ev=s(26587),ew=s(16110),eN=s(78721),ek=s(71139),eS=s(14685),eE=s.n(eS);let eA=e=>{var t;let{item:s,view:n,columnIndex:l}=e,{renameFile:r,renameFolder:i,addNewFolder:o}=(0,f.$)(),c=(0,m.useRef)(null),[d,u]=(0,m.useState)(s.name),x=async(e,t)=>{t&&(t.preventDefault(),t.stopPropagation()),s.type===y.Vl.FILE?await r(s,e,l):eE()(s,"id")?i({...s,columnIndex:l},e,l):o({folderName:e,columnIndex:l,onError:()=>{"blur"===t.type?o({folderName:"",columnIndex:l}):c.current.select()}})};return(0,m.useEffect)(()=>{if(c.current){let e=s.name.lastIndexOf("."),t=-1!==e?e:s.name.length;c.current.setSelectionRange(0,t),c.current.focus()}let e=e=>{"Escape"===e.key&&((null==s?void 0:s.id)!==void 0?x(s.name):o({folderName:"",columnIndex:l}))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),(0,a.jsx)("div",{className:"storage-row flex items-center justify-between rounded bg-gray-500","data-sentry-component":"FileExplorerRowEditing","data-sentry-source-file":"FileExplorerRowEditing.tsx",children:(0,a.jsxs)("div",{className:"flex h-full flex-grow items-center px-2.5",children:[(0,a.jsx)("div",{children:(0,a.jsx)(e_,{view:n,status:s.status,fileType:s.type,mimeType:null==(t=s.metadata)?void 0:t.mimetype,"data-sentry-element":"RowIcon","data-sentry-source-file":"FileExplorerRowEditing.tsx"})}),(0,a.jsxs)("form",{className:"h-9",onSubmit:e=>x(d,e),children:[(0,a.jsx)("input",{autoFocus:!0,ref:c,className:"storage-row-input ml-3 h-full bg-inherit p-0 px-1 text-sm",type:"text",value:d,onChange:e=>u(e.target.value),onBlur:e=>x(d,e)}),(0,a.jsx)("button",{className:"hidden",type:"submit",onClick:e=>x(d,e)})]})]})})};var eC=s(24447);let e_=e=>{let{view:t,status:s,fileType:n,mimeType:l}=e;if(t===y.JB.LIST&&s===y.U1.LOADING)return(0,a.jsx)(eu.A,{size:16,strokeWidth:2,className:"animate-spin"});if(n===y.Vl.BUCKET||n===y.Vl.FOLDER){let e=n===y.Vl.BUCKET?"".concat(h.o2,"/img/bucket-filled.svg"):n===y.Vl.FOLDER?"".concat(h.o2,"/img/folder-filled.svg"):"".concat(h.o2,"/img/file-filled.svg");return(0,a.jsx)(ew.A,{src:e,preProcessor:e=>e.replace(/svg/,'svg class="w-4 h-4 text-color-inherit opacity-75"')})}return(null==l?void 0:l.includes("image"))?(0,a.jsx)(em.A,{size:16,strokeWidth:2}):(null==l?void 0:l.includes("audio"))?(0,a.jsx)(ex.A,{size:16,strokeWidth:2}):(null==l?void 0:l.includes("video"))?(0,a.jsx)(ep.A,{size:16,strokeWidth:2}):(0,a.jsx)(eh.A,{size:16,strokeWidth:2,"data-sentry-element":"File","data-sentry-component":"RowIcon","data-sentry-source-file":"FileExplorerRow.tsx"})},eT=e=>{var t;let{index:s,item:n,view:l=y.JB.COLUMNS,columnIndex:r=0,selectedItems:i=[]}=e,{ref:o,bucketId:d}=(0,x.g)(),{selectedBucket:u,selectedFilePreview:m,openedFolders:p,popColumnAtIndex:h,popOpenedFoldersAtIndex:g,clearSelectedItems:j,setSelectedFilePreview:b,setSelectedFileCustomExpiry:v,setSelectedItems:w,setSelectedItemsToDelete:N,setSelectedItemToRename:k,setSelectedItemsToMove:S,openFolder:E,downloadFolder:A,selectRangeItems:C}=(0,f.$)(),{show:_}=(0,G.EF)(),{onCopyUrl:T}=O(),P=u.public,I={...n,columnIndex:r},R=!!i.find(e=>e.id===n.id),L=p.length>r&&p[r].name===n.name,M=!c()(m)&&ed()(null==m?void 0:m.id,n.id),D=(0,V.SE)(q.aG.STORAGE_WRITE,"*"),z=async(e,t)=>{h(e),g(e-1),b(I),j()},F=e=>{if(e&&0!==i.length)return void C(r,s);void 0!==eo()(i,e=>I.id===e.id)?w(i.filter(e=>I.id!==e.id)):w([...i,I]),b(void 0)},B=n.type===y.Vl.FOLDER?[...D?[{name:"Rename",icon:(0,a.jsx)(ef.A,{size:14,strokeWidth:1}),onClick:()=>k(I)}]:[],{name:"Download",icon:(0,a.jsx)(ey.A,{size:14,strokeWidth:1}),onClick:()=>A(I)},{name:"Copy path to folder",icon:(0,a.jsx)($.A,{size:14,strokeWidth:1}),onClick:()=>(0,eC.Ym)(p,I)},...D?[{name:"Separator",icon:void 0,onClick:void 0},{name:"Delete",icon:(0,a.jsx)(eg.A,{size:14,strokeWidth:1}),onClick:()=>N([I])}]:[]]:[...n.isCorrupted?[]:[...P?[{name:"Get URL",icon:(0,a.jsx)($.A,{size:14,strokeWidth:1}),onClick:()=>T(I.name)}]:[{name:"Get URL",icon:(0,a.jsx)($.A,{size:14,strokeWidth:1}),children:[{name:"Expire in 1 week",onClick:()=>T(I.name,y.Vm.WEEK)},{name:"Expire in 1 month",onClick:()=>T(I.name,y.Vm.MONTH)},{name:"Expire in 1 year",onClick:()=>T(I.name,y.Vm.YEAR)},{name:"Custom expiry",onClick:()=>v(I)}]}],...D?[{name:"Rename",icon:(0,a.jsx)(ef.A,{size:14,strokeWidth:1}),onClick:()=>k(I)},{name:"Move",icon:(0,a.jsx)(ej.A,{size:14,strokeWidth:1}),onClick:()=>S([I])},{name:"Download",icon:(0,a.jsx)(ey.A,{size:14,strokeWidth:1}),onClick:async()=>{await (0,eC.PE)({projectRef:o,bucketId:d,file:I})}},{name:"Separator",icon:void 0,onClick:void 0}]:[]],...D?[{name:"Delete",icon:(0,a.jsx)(eg.A,{size:14,strokeWidth:1}),onClick:()=>N([I])}]:[]],W=n.metadata?(0,el.z3)(n.metadata.size):"-",H=n.metadata?n.metadata.mimetype:"-",Y=n.created_at?new Date(n.created_at).toLocaleString():"-",J=n.updated_at?new Date(n.updated_at).toLocaleString():"-",Q=(e,t)=>{_(e,{id:t===y.Vl.FILE?y.Jn.STORAGE_ITEM:y.Jn.STORAGE_FOLDER,props:{item:I}})},K=l===y.JB.LIST&&n.isCorrupted?"calc(100% - 60px)":l!==y.JB.LIST||n.isCorrupted?"100%":"calc(100% - 50px)";return n.status===y.U1.EDITING?(0,a.jsx)(eA,{view:l,item:n,columnIndex:r}):(0,a.jsx)("div",{className:"h-full border-b border-default",onContextMenu:e=>{e.stopPropagation(),n.type===y.Vl.FILE?Q(e,y.Vl.FILE):Q(e,y.Vl.FOLDER)},"data-sentry-component":"FileExplorerRow","data-sentry-source-file":"FileExplorerRow.tsx",children:(0,a.jsxs)("div",{className:(0,U.cn)("storage-row group flex h-full items-center px-2.5","hover:bg-panel-footer-light [[data-theme*=dark]_&]:hover:bg-panel-footer-dark","".concat(L?"bg-surface-200":""),"".concat(M?"bg-green-500 hover:bg-green-500":""),"".concat(n.status!==y.U1.LOADING?"cursor-pointer":"")),onClick:e=>{e.stopPropagation(),e.preventDefault(),n.status===y.U1.LOADING||L||M||(n.type===y.Vl.FOLDER||n.type===y.Vl.BUCKET?E(r,n):z(r,n))},children:[(0,a.jsxs)("div",{className:(0,U.cn)("flex items-center",l===y.JB.LIST?"w-[40%] min-w-[250px]":"w-[90%]"),children:[(0,a.jsxs)("div",{className:"relative w-[30px]",onClick:e=>e.stopPropagation(),children:[!R&&(0,a.jsx)("div",{className:"absolute ".concat(n.type===y.Vl.FILE?"group-hover:hidden":""),style:{top:"2px"},children:(0,a.jsx)(e_,{view:l,status:n.status,fileType:n.type,mimeType:null==(t=n.metadata)?void 0:t.mimetype})}),(0,a.jsx)(er.A,{label:"",className:"w-full ".concat(n.type!==y.Vl.FILE?"invisible":""," ").concat(R?"opacity-100":"opacity-0 group-hover:opacity-100"),checked:R,onChange:e=>{e.stopPropagation(),F(e.nativeEvent.shiftKey)},"data-sentry-element":"Checkbox","data-sentry-source-file":"FileExplorerRow.tsx"})]}),(0,a.jsx)("p",{title:n.name,className:"truncate text-sm",style:{width:K},children:n.name}),n.isCorrupted&&(0,a.jsxs)(eN.m_,{children:[(0,a.jsx)(eN.k$,{children:(0,a.jsx)(eb.A,{size:18,strokeWidth:2,className:"text-foreground-light"})}),(0,a.jsx)(eN.ZI,{side:"bottom",children:"File is corrupted, please delete and reupload again."})]})]}),l===y.JB.LIST&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"w-[11%] min-w-[100px] truncate text-sm",children:W}),(0,a.jsx)("p",{className:"w-[14%] min-w-[100px] truncate text-sm",children:H}),(0,a.jsx)("p",{className:"w-[15%] min-w-[160px] truncate text-sm",children:Y}),(0,a.jsx)("p",{className:"w-[15%] min-w-[160px] truncate text-sm",children:J})]}),(0,a.jsx)("div",{className:"flex items-center justify-end ".concat(l===y.JB.LIST?"flex-grow":"w-[10%]"),onClick:e=>e.stopPropagation(),children:n.status===y.U1.LOADING?(0,a.jsx)(eu.A,{className:"animate-spin ".concat(l===y.JB.LIST?"invisible":""),size:16,strokeWidth:2}):(0,a.jsxs)(ek.rI,{children:[(0,a.jsx)(ek.ty,{children:(0,a.jsx)("div",{className:"storage-row-menu opacity-0",children:(0,a.jsx)(ev.A,{size:16,strokeWidth:2})})}),(0,a.jsx)(ek.SQ,{side:"bottom",align:"end",children:B.map(e=>{var t,s,n;return(null!=(t=null==e?void 0:e.children)?t:[]).length>0?(0,a.jsxs)(ek.lv,{children:[(0,a.jsxs)(ek.nV,{className:"space-x-2",children:[e.icon||(0,a.jsx)(a.Fragment,{}),(0,a.jsx)("p",{children:e.name})]}),(0,a.jsx)(ek.dc,{children:(0,a.jsx)(ek.M5,{children:null==(s=null!=(n=null==e?void 0:e.children)?n:[])?void 0:s.map(e=>(0,a.jsx)(ek._2,{onClick:e.onClick,children:(0,a.jsx)("p",{children:e.name})},e.name))})})]},e.name):"Separator"===e.name?(0,a.jsx)(ek.mB,{},e.name):(0,a.jsxs)(ek._2,{className:"space-x-2",onClick:e.onClick,children:[e.icon||(0,a.jsx)(a.Fragment,{}),(0,a.jsx)("p",{children:e.name})]},e.name)})})]})})]})})},eP=e=>{let{isOpen:t,onDragLeave:s,onDrop:n,folderIsEmpty:l}=e;return(0,a.jsx)(X.e,{show:t,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0",enterTo:"transform opacity-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100",leaveTo:"transform opacity-0",className:"h-full w-full absolute top-0","data-sentry-element":"Transition","data-sentry-component":"DragOverOverlay","data-sentry-source-file":"FileExplorerColumn.tsx",children:(0,a.jsx)("div",{onDragLeave:s,onDrop:n,className:"absolute top-0 flex h-full w-full items-center justify-center",style:{backgroundColor:l?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.2)"},children:!l&&(0,a.jsxs)("div",{className:"w-3/4 h-32 border-2 border-dashed border-muted rounded-md flex flex-col items-center justify-center p-6 pointer-events-none",style:{backgroundColor:"rgba(0,0,0,0.4)"},children:[(0,a.jsx)(es.A,{className:"text-white pointer-events-none",size:20,strokeWidth:2}),(0,a.jsx)("p",{className:"text-center text-sm  text-white mt-2 pointer-events-none",children:"Drop your files to upload to this folder"})]})})})},eI=e=>{let{index:t=0,column:s,fullWidth:n=!1,selectedItems:l=[],itemSearchString:r,onFilesUpload:o=j(),onSelectAllItemsInColumn:c=j(),onSelectColumnEmptySpace:d=j(),onColumnLoadMore:u=j()}=e,[x,p]=(0,m.useState)(!1),g=(0,m.useRef)(null),b=(0,f.$)(),v=(0,V.SE)(q.aG.STORAGE_WRITE,"*");(0,m.useEffect)(()=>{if(g){let{scrollHeight:e,clientHeight:t}=g.current;e>t&&(g.current.scrollTop+=e-t)}},[s]);let w=l.length>0,N=s.items.map(e=>e.id),k=s.items.filter(e=>e.type===y.Vl.FILE),S=l.filter(e=>N.includes(e.id)).filter(e=>e.type===y.Vl.FILE),E=s.items.map((e,t)=>({...e,columnIndex:t})),A=et()(E.map(e=>i()(e,["metadata","size"],0))),C=0===s.items.filter(e=>e.status!==y.U1.LOADING).length,{show:T}=(0,G.EF)(),P=e=>{e&&(e.stopPropagation(),e.preventDefault(),"dragover"!==e.type||x||p(!0))},I=()=>(0,a.jsx)(er.A,{label:"",className:"-mt-0.5",checked:0!==k.length&&S.length===k.length,disabled:0===k.length,onChange:()=>c(t),"data-sentry-element":"Checkbox","data-sentry-component":"SelectAllCheckbox","data-sentry-source-file":"FileExplorerColumn.tsx"});return(0,a.jsxs)("div",{ref:g,className:(0,U.cn)(n?"w-full":"w-64 border-r border-overlay",b.view===y.JB.LIST&&"h-full","hide-scrollbar relative flex flex-shrink-0 flex-col overflow-auto"),onContextMenu:e=>{T(e,{id:y.Jn.STORAGE_COLUMN,props:{index:t}})},onDragOver:P,onDrop:e=>{P(e),v?o(e,t):(0,_.oR)("You need additional permissions to upload files to this project")},onClick:e=>{let s=i()(e.target,["className"],"");"string"==typeof s&&s.includes("react-contexify")||d(t)},"data-sentry-component":"FileExplorerColumn","data-sentry-source-file":"FileExplorerColumn.tsx",children:[b.view===y.JB.COLUMNS&&(0,a.jsx)("div",{className:(0,U.cn)("sticky top-0 z-10 mb-0 flex items-center bg-table-header-light px-2.5 [[data-theme*=dark]_&]:bg-table-header-dark",w?"h-10 py-3 opacity-100":"h-0 py-0 opacity-0","transition-all duration-200"),onClick:e=>e.stopPropagation(),children:k.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I,{}),(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["Select all ",k.length," files"]})]}):(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"No files available for selection"})}),b.view===y.JB.LIST&&(0,a.jsxs)("div",{className:"sticky top-0 py-2 z-10 flex min-w-min items-center border-b border-overlay bg-surface-100 px-2.5",children:[(0,a.jsxs)("div",{className:"flex w-[40%] min-w-[250px] items-center",children:[(0,a.jsx)(I,{}),(0,a.jsx)("p",{className:"text-sm",children:"Name"})]}),(0,a.jsx)("p",{className:"w-[11%] min-w-[100px] text-sm",children:"Size"}),(0,a.jsx)("p",{className:"w-[14%] min-w-[100px] text-sm",children:"Type"}),(0,a.jsx)("p",{className:"w-[15%] min-w-[160px] text-sm",children:"Created at"}),(0,a.jsx)("p",{className:"w-[15%] min-w-[160px] text-sm",children:"Last modified at"})]}),s.status===y.U1.LOADING&&(0,a.jsxs)("div",{className:"\n            ".concat(n?"w-full":"w-64 border-r border-default","\n            px-2 py-1 my-1 flex flex-shrink-0 flex-col space-y-2 overflow-auto\n          "),children:[(0,a.jsx)(en.A,{}),(0,a.jsx)(en.A,{}),(0,a.jsx)(en.A,{})]}),(0,a.jsx)(ea.A,{items:E,itemProps:{view:b.view,columnIndex:t,selectedItems:l},ItemComponent:eT,getItemSize:e=>0!==e&&e===E.length?85:37,hasNextPage:s.status!==y.U1.LOADING&&s.hasMoreItems,isLoadingNextPage:s.isLoadingMoreItems,onLoadNextPage:()=>u(t,s),"data-sentry-element":"InfiniteList","data-sentry-source-file":"FileExplorerColumn.tsx"}),!(b.isSearching&&r.length>0)&&0===s.items.length&&s.status!==y.U1.LOADING&&(0,a.jsxs)("div",{className:"h-full w-full flex flex-col items-center justify-center",children:[(0,a.jsx)("img",{alt:"storage-placeholder",src:"".concat(h.o2,"/img/storage-placeholder.svg"),className:"opacity-75 pointer-events-none"}),(0,a.jsx)("p",{className:"text-sm my-3 opacity-75",children:"Drop your files here"}),(0,a.jsx)("p",{className:"w-40 text-center text-xs text-foreground-light",children:'Or upload them via the "Upload file" button above'})]}),b.isSearching&&r.length>0&&C&&s.status!==y.U1.LOADING&&(0,a.jsxs)("div",{className:"h-full w-full flex flex-col items-center justify-center",children:[(0,a.jsx)("p",{className:"text-sm my-3 text-foreground",children:"No results found in this folder"}),(0,a.jsxs)("p",{className:"w-40 text-center text-sm text-foreground-light",children:['Your search for "',r,'" did not return any results']})]}),(0,a.jsx)(eP,{isOpen:x,folderIsEmpty:C,onDragLeave:()=>p(!1),onDrop:()=>p(!1),"data-sentry-element":"DragOverOverlay","data-sentry-source-file":"FileExplorerColumn.tsx"}),b.view===y.JB.LIST&&(0,a.jsx)("div",{className:"shrink-0 rounded-b-md z-10 flex min-w-min items-center bg-panel-footer-light px-2.5 py-2 [[data-theme*=dark]_&]:bg-panel-footer-dark w-full",children:(0,a.jsxs)("p",{className:"text-sm",children:[(0,el.z3)(A)," for ",E.length," items"]})})]})},eR=e=>{let{id:t=""}=e,{openedFolders:s,downloadFolder:n,setSelectedItemToRename:l,setSelectedItemsToDelete:r}=(0,f.$)(),i=(0,V.SE)(q.aG.STORAGE_WRITE,"*");return(0,a.jsxs)(G.W1,{id:t,animation:"fade","data-sentry-element":"Menu","data-sentry-component":"FolderContextMenu","data-sentry-source-file":"FolderContextMenu.tsx",children:[i&&(0,a.jsxs)(G.q7,{onClick:e=>{let{props:t}=e;return l(t.item)},children:[(0,a.jsx)(ef.A,{size:"14",strokeWidth:1}),(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Rename"})]}),(0,a.jsxs)(G.q7,{onClick:e=>{let{props:t}=e;return n(t.item)},"data-sentry-element":"Item","data-sentry-source-file":"FolderContextMenu.tsx",children:[(0,a.jsx)(ey.A,{size:"14",strokeWidth:1,"data-sentry-element":"Download","data-sentry-source-file":"FolderContextMenu.tsx"}),(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Download"})]}),(0,a.jsxs)(G.q7,{onClick:e=>{let{props:t}=e;return(0,eC.Ym)(s,t.item)},"data-sentry-element":"Item","data-sentry-source-file":"FolderContextMenu.tsx",children:[(0,a.jsx)($.A,{size:"14",strokeWidth:1,"data-sentry-element":"Clipboard","data-sentry-source-file":"FolderContextMenu.tsx"}),(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Copy path to folder"})]}),i&&[(0,a.jsx)(G.wv,{},"separator"),(0,a.jsxs)(G.q7,{onClick:e=>{let{props:t}=e;return r([t.item])},children:[(0,a.jsx)(eg.A,{size:"14",strokeWidth:1,stroke:"red"}),(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Delete"})]},"delete")]]})},eL=e=>{let{id:t=""}=e,{ref:s,bucketId:n}=(0,x.g)(),{setSelectedFileCustomExpiry:l}=(0,f.$)(),{selectedBucket:r,setSelectedItemsToDelete:i,setSelectedItemToRename:o,setSelectedItemsToMove:c}=(0,f.$)(),{onCopyUrl:d}=O(),u=r.public,m=(0,V.SE)(q.aG.STORAGE_WRITE,"*"),p=async(e,t,a)=>{if(!t.isCorrupted)switch(e){case"copy":if(void 0!==a&&a<0)return l(t);return d(t.name,a);case"rename":return o(t);case"move":return c([t]);case"download":return await (0,eC.PE)({projectRef:s,bucketId:n,file:t})}};return(0,a.jsxs)(G.W1,{id:t,animation:"fade","data-sentry-element":"Menu","data-sentry-component":"ItemContextMenu","data-sentry-source-file":"ItemContextMenu.tsx",children:[u?(0,a.jsxs)(G.q7,{onClick:e=>{let{props:t}=e;return p("copy",t.item)},children:[(0,a.jsx)($.A,{size:"14",strokeWidth:1}),(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Get URL"})]}):(0,a.jsxs)(G.Qw,{label:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)($.A,{size:"14"}),(0,a.jsx)("span",{className:"text-xs",children:"Get URL"})]}),arrow:(0,a.jsx)(J.A,{size:"14",strokeWidth:1}),children:[(0,a.jsx)(G.q7,{onClick:e=>{let{props:t}=e;return p("copy",t.item,y.Vm.WEEK)},children:(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Expire in 1 week"})}),(0,a.jsx)(G.q7,{onClick:e=>{let{props:t}=e;return p("copy",t.item,y.Vm.MONTH)},children:(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Expire in 1 month"})}),(0,a.jsx)(G.q7,{onClick:e=>{let{props:t}=e;return p("copy",t.item,y.Vm.YEAR)},children:(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Expire in 1 year"})}),(0,a.jsx)(G.q7,{onClick:e=>{let{props:t}=e;return p("copy",t.item,-1)},children:(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Custom expiry"})})]}),m&&[(0,a.jsxs)(G.q7,{onClick:e=>{let{props:t}=e;return p("rename",t.item)},children:[(0,a.jsx)(ef.A,{size:"14",strokeWidth:1}),(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Rename"})]},"rename-file"),(0,a.jsxs)(G.q7,{onClick:e=>{let{props:t}=e;return p("move",t.item)},children:[(0,a.jsx)(ej.A,{size:"14",strokeWidth:1}),(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Move"})]},"move-file"),(0,a.jsxs)(G.q7,{onClick:e=>{let{props:t}=e;return p("download",t.item)},children:[(0,a.jsx)(ey.A,{size:"14",strokeWidth:1}),(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Download"})]},"download-file"),(0,a.jsx)(G.wv,{},"file-separator"),(0,a.jsxs)(G.q7,{onClick:e=>{let{props:t}=e;return i([t.item])},children:[(0,a.jsx)(eg.A,{size:"14",strokeWidth:1,stroke:"red"}),(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Delete"})]},"delete-file")]]})},eM=e=>{let{columns:t=[],selectedItems:s=[],itemSearchString:n,onFilesUpload:l=j(),onSelectAllItemsInColumn:r=j(),onSelectColumnEmptySpace:i=j(),onColumnLoadMore:o=j()}=e,c=(0,m.useRef)(null),d=(0,f.$)();return(0,m.useEffect)(()=>{if(c){let{scrollWidth:e,clientWidth:t}=c.current;e>t&&(c.current.scrollLeft+=e-t)}},[t]),(0,a.jsxs)("div",{ref:c,className:(0,U.cn)("file-explorer flex flex-grow overflow-x-auto justify-between h-full w-full relative",d.view===y.JB.LIST&&"flex-col"),"data-sentry-component":"FileExplorer","data-sentry-source-file":"FileExplorer.tsx",children:[(0,a.jsx)(Z,{id:y.Jn.STORAGE_COLUMN,"data-sentry-element":"ColumnContextMenu","data-sentry-source-file":"FileExplorer.tsx"}),(0,a.jsx)(eL,{id:y.Jn.STORAGE_ITEM,"data-sentry-element":"ItemContextMenu","data-sentry-source-file":"FileExplorer.tsx"}),(0,a.jsx)(eR,{id:y.Jn.STORAGE_FOLDER,"data-sentry-element":"FolderContextMenu","data-sentry-source-file":"FileExplorer.tsx"}),d.view===y.JB.COLUMNS?(0,a.jsx)("div",{className:"flex",children:t.map((e,t)=>(0,a.jsx)(eI,{index:t,column:e,selectedItems:s,itemSearchString:n,onFilesUpload:l,onSelectAllItemsInColumn:r,onSelectColumnEmptySpace:i,onColumnLoadMore:o},"column-".concat(t)))}):d.view===y.JB.LIST?(0,a.jsx)(a.Fragment,{children:t.length>0&&(0,a.jsx)(eI,{fullWidth:!0,index:t.length-1,column:t[t.length-1],selectedItems:s,itemSearchString:n,onFilesUpload:l,onSelectAllItemsInColumn:r,onSelectColumnEmptySpace:i,onColumnLoadMore:o})}):(0,a.jsxs)("div",{children:["Unknown view: ",d.view]})]})};var eD=s(77796),ez=s.n(eD),eF=s(72035),eO=s(48114),eB=s(88602),eW=s(89080),eU=s(99846),eG=s(43181),eq=s(96637),eV=s(92779),eH=s(80903),e$=s(75189),eY=s(25643);let eJ=[{key:y.JB.COLUMNS,name:"As columns"},{key:y.JB.LIST,name:"As list"}],eQ=[{key:y.NA.NAME,name:"Name"},{key:y.NA.CREATED_AT,name:"Time created"},{key:y.NA.UPDATED_AT,name:"Time modified"},{key:y.NA.LAST_ACCESSED_AT,name:"Time last accessed"}],eK=[{key:y.ou.ASC,name:"Ascending"},{key:y.ou.DESC,name:"Descending"}],eZ=e=>{let{loading:t,isSearching:s,breadcrumbs:n,togglePathEdit:l}=e;return(0,a.jsx)("div",{className:"group ".concat(t?"":"cursor-pointer"),onClick:()=>t.isLoading?{}:l(),"data-sentry-component":"HeaderPathEdit","data-sentry-source-file":"FileExplorerHeader.tsx",children:t.isLoading?(0,a.jsxs)("div",{className:"ml-2 flex items-center",children:[(0,a.jsx)(eu.A,{size:16,strokeWidth:2,className:"animate-spin"}),(0,a.jsx)("p",{className:"ml-3 text-sm",children:t.message})]}):(0,a.jsxs)("div",{className:"flex cursor-pointer items-center",children:[(0,a.jsx)("p",{className:"ml-3 text-sm truncate",children:n[n.length-1]||""}),!s&&(0,a.jsx)("div",{className:"ml-3 flex items-center space-x-2 opacity-0 transition group-hover:opacity-100",children:(0,a.jsx)(C.$,{type:"text",icon:(0,a.jsx)(eW.A,{}),children:"Navigate"})})]})})},eX=e=>{let{loading:t,isSearching:s,breadcrumbs:n,selectBreadcrumb:l}=e,r=n.map((e,t)=>({name:e,index:t})),i=r.length<=5?r:r.slice(0,2).concat([{name:"...",index:-1}]).concat(r.slice(r.length-2,r.length));return t.isLoading?(0,a.jsxs)("div",{className:"ml-2 flex items-center","data-sentry-component":"HeaderBreadcrumbs","data-sentry-source-file":"FileExplorerHeader.tsx",children:[(0,a.jsx)(eu.A,{size:16,strokeWidth:2,className:"animate-spin","data-sentry-element":"Loader","data-sentry-source-file":"FileExplorerHeader.tsx"}),(0,a.jsx)("p",{className:"ml-3 text-sm",children:t.message})]}):(0,a.jsx)("div",{className:"ml-3 flex items-center ".concat(s&&"max-w-[140px] overflow-x-auto"),"data-sentry-component":"HeaderBreadcrumbs","data-sentry-source-file":"FileExplorerHeader.tsx",children:i.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center",children:[0!==t&&(0,a.jsx)(J.A,{size:10,strokeWidth:2,className:"mx-3"}),(0,a.jsx)("p",{className:"truncate text-sm ".concat("..."!==e.name?"cursor-pointer":""),style:{maxWidth:"6rem"},onClick:()=>"..."!==e.name?l(e.index):{},children:e.name},e.name)]},e.name))})},e0=e=>{let{itemSearchString:t="",setItemSearchString:s=j(),onFilesUpload:n=j()}=e,r=(0,f.$)(),i=(0,eF.hx)(),[o,c]=(0,m.useState)(""),[d,u]=(0,m.useState)(""),[x,p]=(0,m.useState)({isLoading:!1,message:""}),[h,g]=(0,m.useState)(!1),[b,v]=(0,m.useState)(!1),w=(0,m.useRef)(null),N=(0,m.useRef)(null),{columns:k,sortBy:S,setSortBy:A,sortByOrder:_,setSortByOrder:T,popColumn:P,popColumnAtIndex:I,popOpenedFolders:R,popOpenedFoldersAtIndex:L,fetchFoldersByPath:M,refetchAllOpenedFolders:D,addNewFolderPlaceholder:z,clearOpenedFolders:F,setSelectedFilePreview:O,selectedBucket:B}=(0,f.$)(),W=k.map(e=>e.name),U=k.length<=1,G=(0,V.SE)(q.aG.STORAGE_WRITE,"*");(0,m.useEffect)(()=>{t&&u(t)},[]),(0,m.useEffect)(()=>{ed()(N.current,W)||(g(!1),N.current=W)},[W]);let $=(0,m.useCallback)(ez()(s,300),[]),Y=()=>{P(),R(),O(void 0)},J=async e=>{if(0===e.length)I(0),F(),O(void 0);else{let t=e.join("/");p({isLoading:!0,message:"Navigating to ".concat(t,"...")}),await M({paths:e}),p({isLoading:!1,message:""})}},Q=()=>{u(""),r.setIsSearching(!1),s("")},K=async()=>{v(!0),await D(),v(!1)};return(0,a.jsxs)("div",{className:" flex h-[40px] pl-2 items-center justify-between rounded-t-md border-b border-overlay bg-surface-100","data-sentry-component":"FileExplorerHeader","data-sentry-source-file":"FileExplorerHeader.tsx",children:[(0,a.jsxs)("div",{className:"flex items-center ".concat(h?"w-1/2":""),children:[W.length>0&&(0,a.jsx)(C.$,{icon:(0,a.jsx)(eU.A,{size:16,strokeWidth:2}),size:"tiny",type:"text",className:"".concat(W.length>1?"opacity-100":"opacity-25"," px-1"),disabled:U,onClick:()=>{g(!1),Y()}}),h?(0,a.jsx)("form",{className:"ml-2 flex-grow",children:(0,a.jsx)(E.A,{autoFocus:!0,type:"text",size:"small",value:o,onChange:e=>{c(e.target.value)},placeholder:"e.g Parent Folder/Child Folder",actions:[(0,a.jsx)(C.$,{type:"default",htmlType:"button",onClick:()=>{g(!1)},children:"Cancel"},"cancelPath"),(0,a.jsx)(C.$,{type:"primary",htmlType:"submit",onClick:e=>{e&&(e.preventDefault(),e.stopPropagation()),g(!1),J(l()(o.split("/")))},children:"Go to folder"},"setPath")]},"pathSet")}):r.view===y.JB.COLUMNS?(0,a.jsx)(eZ,{loading:x,isSearching:r.isSearching,breadcrumbs:W,togglePathEdit:()=>{g(!0),c(W.slice(1).join("/")),r.isSearching&&Q()}}):(0,a.jsx)(eX,{loading:x,isSearching:r.isSearching,breadcrumbs:W,selectBreadcrumb:e=>{I(e),L(e-1)}})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1 px-2",children:[(0,a.jsx)(C.$,{size:"tiny",icon:(0,a.jsx)(eG.A,{}),type:"text",loading:b,onClick:K,"data-sentry-element":"Button","data-sentry-source-file":"FileExplorerHeader.tsx",children:"Reload"}),(0,a.jsxs)(ek.rI,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"FileExplorerHeader.tsx",children:[(0,a.jsx)(ek.ty,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"FileExplorerHeader.tsx",children:(0,a.jsx)(C.$,{type:"text",icon:"LIST"===r.view?(0,a.jsx)(eq.A,{size:16,strokeWidth:2}):(0,a.jsx)(eV.A,{size:16,strokeWidth:2}),"data-sentry-element":"Button","data-sentry-source-file":"FileExplorerHeader.tsx",children:"View"})}),(0,a.jsxs)(ek.SQ,{align:"end",className:"w-40 min-w-0","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"FileExplorerHeader.tsx",children:[eJ.map(e=>(0,a.jsx)(ek._2,{onClick:()=>r.setView(e.key),children:(0,a.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,a.jsx)("p",{children:e.name}),r.view===e.key&&(0,a.jsx)(eH.A,{size:16,className:"text-brand",strokeWidth:2})]})},e.key)),(0,a.jsx)(ek.mB,{"data-sentry-element":"DropdownMenuSeparator","data-sentry-source-file":"FileExplorerHeader.tsx"}),(0,a.jsxs)(ek.lv,{"data-sentry-element":"DropdownMenuSub","data-sentry-source-file":"FileExplorerHeader.tsx",children:[(0,a.jsx)(ek.nV,{"data-sentry-element":"DropdownMenuSubTrigger","data-sentry-source-file":"FileExplorerHeader.tsx",children:"Sort by"}),(0,a.jsx)(ek.M5,{className:"w-44","data-sentry-element":"DropdownMenuSubContent","data-sentry-source-file":"FileExplorerHeader.tsx",children:eQ.map(e=>(0,a.jsx)(ek._2,{onClick:()=>A(e.key),children:(0,a.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,a.jsx)("p",{children:e.name}),S===e.key&&(0,a.jsx)(eH.A,{size:16,className:"text-brand",strokeWidth:2})]})},e.key))})]}),(0,a.jsxs)(ek.lv,{"data-sentry-element":"DropdownMenuSub","data-sentry-source-file":"FileExplorerHeader.tsx",children:[(0,a.jsx)(ek.nV,{"data-sentry-element":"DropdownMenuSubTrigger","data-sentry-source-file":"FileExplorerHeader.tsx",children:"Sort order"}),(0,a.jsx)(ek.M5,{"data-sentry-element":"DropdownMenuSubContent","data-sentry-source-file":"FileExplorerHeader.tsx",children:eK.map(e=>(0,a.jsx)(ek._2,{onClick:()=>T(e.key),children:(0,a.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,a.jsx)("p",{children:e.name}),_===e.key&&(0,a.jsx)(eH.A,{size:16,className:"text-brand",strokeWidth:2})]})},e.key))})]})]})]})]}),(0,a.jsx)("div",{className:"h-6 border-r border-control"}),(0,a.jsxs)("div",{className:"flex items-center space-x-1 px-2",children:[(0,a.jsx)("div",{className:"hidden",children:(0,a.jsx)("input",{ref:w,type:"file",multiple:!0,onChange:n})}),(0,a.jsx)(eB.G,{icon:(0,a.jsx)(es.A,{size:16,strokeWidth:2}),type:"text",disabled:!G||0===W.length,onClick:()=>{w.current&&w.current.click()},tooltip:{content:{side:"bottom",text:G?void 0:"You need additional permissions to upload files"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"FileExplorerHeader.tsx",children:"Upload files"}),(0,a.jsx)(eB.G,{icon:(0,a.jsx)(H.A,{size:16,strokeWidth:2}),type:"text",disabled:!G||0===W.length,onClick:()=>z(-1),tooltip:{content:{side:"bottom",text:G?void 0:"You need additional permissions to create folders"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"FileExplorerHeader.tsx",children:"Create folder"})]}),(0,a.jsx)("div",{className:"h-6 border-r border-control"}),(0,a.jsx)("div",{className:"flex items-center px-2",children:r.isSearching?(0,a.jsx)(E.A,{size:"tiny",autoFocus:!0,className:"w-52",icon:(0,a.jsx)(e$.A,{size:14,strokeWidth:2}),actions:[(0,a.jsx)(eY.A,{className:"mx-2 cursor-pointer text-foreground",size:14,strokeWidth:2,onClick:Q},"close")],placeholder:"Search for a file or folder",type:"text",value:d,onChange:e=>{u(e.target.value),$(e.target.value)}}):(0,a.jsx)(C.$,{icon:(0,a.jsx)(e$.A,{size:16,strokeWidth:2}),size:"tiny",type:"text",className:"px-1",onClick:()=>{g(!1),r.setIsSearching(!0)}})}),i&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"h-6 border-r border-control"}),(0,a.jsx)("div",{className:"mx-2",children:(0,a.jsx)(eO.A,{section:["storage",B.name]})})]})]})]})},e1=()=>{let{ref:e,bucketId:t}=(0,x.g)(),s=(0,V.SE)(q.aG.STORAGE_WRITE,"*"),{selectedItems:n,downloadSelectedFiles:l,clearSelectedItems:r,setSelectedItemsToDelete:i,setSelectedItemsToMove:o}=(0,f.$)();return(0,a.jsxs)("div",{className:"z-10 flex h-[40px] items-center rounded-t-md bg-brand-400 px-2 py-1 shadow [[data-theme*=dark]_&]:bg-brand-500","data-sentry-component":"FileExplorerHeaderSelection","data-sentry-source-file":"FileExplorerHeaderSelection.tsx",children:[(0,a.jsx)(C.$,{icon:(0,a.jsx)(eY.A,{size:16,strokeWidth:2}),type:"text",onClick:()=>r(),"data-sentry-element":"Button","data-sentry-source-file":"FileExplorerHeaderSelection.tsx"}),(0,a.jsxs)("div",{className:"ml-1 flex items-center space-x-3",children:[(0,a.jsxs)("p",{className:"mb-0 text-sm text-foreground",children:[(0,a.jsx)("span",{style:{fontVariantNumeric:"tabular-nums"},children:n.length})," items selected"]}),(0,a.jsx)(C.$,{icon:(0,a.jsx)(ey.A,{size:16,strokeWidth:2}),type:"primary",onClick:async()=>{1===n.length?await (0,eC.PE)({projectRef:e,bucketId:t,file:n[0]}):await l(n)},"data-sentry-element":"Button","data-sentry-source-file":"FileExplorerHeaderSelection.tsx",children:"Download"}),(0,a.jsx)("div",{className:"border-r border-green-900 py-3 opacity-50"}),(0,a.jsx)(eB.G,{icon:(0,a.jsx)(eg.A,{size:16,strokeWidth:2}),type:"primary",disabled:!s,onClick:()=>i(n),tooltip:{content:{side:"bottom",text:s?void 0:"You need additional permissions to delete files"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"FileExplorerHeaderSelection.tsx",children:"Delete"}),(0,a.jsx)(eB.G,{icon:(0,a.jsx)(ej.A,{size:16,strokeWidth:2}),type:"primary",disabled:!s,onClick:()=>o(n),tooltip:{content:{side:"bottom",text:s?void 0:"You need additional permissions to move files"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"FileExplorerHeaderSelection.tsx",children:"Move"})]})]})},e2=e=>{var t;let{bucketName:s="",visible:n=!1,selectedItemsToMove:l=[],onSelectCancel:r=j(),onSelectMove:i=j()}=e,[o,c]=(0,m.useState)(!1),[d,u]=(0,m.useState)("");(0,m.useEffect)(()=>{c(!1),u("")},[n]);let x=l.length>1,p=x?"Moving ".concat(l.length," items within ").concat(s):1===l.length?"Moving ".concat(null==(t=l[0])?void 0:t.name," within ").concat(s):"",h=e=>{e&&e.preventDefault(),c(!0),i("/"===d[0]?d.slice(1):d)};return(0,a.jsx)(k.A,{visible:n,header:p,description:"Enter the path to where you'd like to move the file".concat(x?"s":""," to."),size:"medium",onCancel:r,customFooter:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(C.$,{type:"default",onClick:r,children:"Cancel"}),(0,a.jsx)(C.$,{type:"primary",loading:o,onClick:h,children:o?"Moving files":"Move files"})]}),"data-sentry-element":"Modal","data-sentry-component":"MoveItemsModal","data-sentry-source-file":"MoveItemsModal.tsx",children:(0,a.jsx)(k.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"MoveItemsModal.tsx",children:(0,a.jsxs)("form",{children:[(0,a.jsx)("div",{className:"relative flex items-center",children:(0,a.jsx)(E.A,{autoFocus:!0,label:"Path to new directory in ".concat(s),type:"text",className:"w-full",placeholder:"e.g folder1/subfolder2",value:d,descriptionText:"Leave blank to move items to the root of the bucket",onChange:e=>u(e.target.value),"data-sentry-element":"Input","data-sentry-source-file":"MoveItemsModal.tsx"})}),(0,a.jsx)("button",{className:"hidden",type:"submit",onClick:h})]})})})};var e4=s(72259);let e3=e=>{var t,s,n;let{item:l}=e,{projectRef:r,selectedBucket:i}=(0,f.$)(),{data:o,isLoading:c}=F({file:l,projectRef:r,bucket:i}),d=+(null!=(n=null==(t=l.metadata)?void 0:t.size)?n:0xa00001),u=null==(s=l.metadata)?void 0:s.mimetype,m=!!u&&!!d&&d>0xa00000;return c?(0,a.jsx)("div",{className:"flex h-full w-full items-center justify-center text-foreground-lighter",children:(0,a.jsx)(eu.A,{size:14,strokeWidth:2,className:"animate-spin"})}):m?(0,a.jsxs)("div",{className:"flex h-full w-full flex-col items-center justify-center",children:[(0,a.jsx)(ew.A,{src:"".concat(h.o2,"/img/file-filled.svg"),preProcessor:e=>e.replace(/svg/,'svg class="mx-auto w-32 h-32 text-color-inherit opacity-75"')}),(0,a.jsx)("p",{className:"mt-2 w-2/5 text-center text-sm",children:"File size is too large to preview in the explorer"})]}):u&&o?u.includes("image")?(0,a.jsx)("div",{className:"flex h-full w-full items-center justify-center bg-contain bg-center bg-no-repeat",style:{backgroundImage:"url('".concat(o,"')")}}):u.includes("audio")?(0,a.jsx)("div",{className:"flex h-full w-full items-center justify-center px-10",children:(0,a.jsxs)("audio",{controls:!0,style:{width:"inherit"},children:[(0,a.jsx)("source",{src:o,type:"audio/mpeg"}),(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Your browser does not support the audio element."})]},o)}):u.includes("video")?(0,a.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,a.jsxs)("video",{controls:!0,style:{maxHeight:"100%"},children:[(0,a.jsx)("source",{src:o,type:"video/mp4"}),(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Your browser does not support the video tag."})]},o)}):(0,a.jsx)(ew.A,{src:"".concat(h.o2,"/img/file-filled.svg"),preProcessor:e=>e.replace(/svg/,'svg class="mx-auto w-32 h-32 text-color-inherit opacity-75"'),"data-sentry-element":"SVG","data-sentry-component":"PreviewFile","data-sentry-source-file":"PreviewPane.tsx"}):(0,a.jsx)(ew.A,{src:"".concat(h.o2,"/img/file-filled.svg"),preProcessor:e=>e.replace(/svg/,'svg class="mx-auto w-32 h-32 text-color-inherit opacity-75"')})},e6=()=>{let{ref:e,bucketId:t}=(0,x.g)(),{selectedBucket:s,selectedFilePreview:n,setSelectedItemsToDelete:l,setSelectedFilePreview:r,setSelectedFileCustomExpiry:i}=(0,f.$)(),{onCopyUrl:o}=O(),d=(0,V.SE)(q.aG.STORAGE_WRITE,"*");if(!n)return null;let u=!c()(n),m=n.metadata?(0,el.z3)(n.metadata.size):null,p=n.metadata?n.metadata.mimetype:void 0,h=n.created_at?new Date(n.created_at).toLocaleString():"Unknown",g=n.updated_at?new Date(n.updated_at).toLocaleString():"Unknown";return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(X.e,{show:u,enter:"transition ease-out duration-150",enterFrom:"transform opacity-0",enterTo:"transform opacity-100",leave:"transition ease-in duration-100",leaveFrom:"transform opacity-100",leaveTo:"transform opacity-0","data-sentry-element":"Transition","data-sentry-source-file":"PreviewPane.tsx",children:(0,a.jsxs)("div",{className:"h-full border-l border-overlay bg-surface-100 p-4",style:{width:450},children:[(0,a.jsx)("div",{className:"flex w-full justify-end text-foreground-lighter transition-colors hover:text-foreground",children:(0,a.jsx)(eY.A,{className:"cursor-pointer",size:14,strokeWidth:2,onClick:()=>r(void 0),"data-sentry-element":"X","data-sentry-source-file":"PreviewPane.tsx"})}),(0,a.jsx)("div",{className:"my-4 border border-overlay",children:(0,a.jsx)("div",{className:"flex h-56 w-full items-center 2xl:h-72",children:(0,a.jsx)(e3,{item:n,"data-sentry-element":"PreviewFile","data-sentry-source-file":"PreviewPane.tsx"})})}),(0,a.jsxs)("div",{className:"w-full space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h5",{className:"break-words text-base text-foreground",children:n.name}),n.isCorrupted&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(eb.A,{size:14,strokeWidth:2,className:"text-foreground-light"}),(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"File is corrupted, please delete and reupload this file again"})]}),p&&(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:[p,m&&(0,a.jsxs)("span",{children:[" - ",m]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1 text-xs text-foreground-lighter",children:"Added on"}),(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:h})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1 text-xs text-foreground-lighter",children:"Last modified"}),(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:g})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2 border-b border-overlay pb-4",children:[(0,a.jsx)(C.$,{type:"default",icon:(0,a.jsx)(ey.A,{size:16,strokeWidth:2}),disabled:n.isCorrupted,onClick:async()=>await (0,eC.PE)({projectRef:e,bucketId:t,file:n}),"data-sentry-element":"Button","data-sentry-source-file":"PreviewPane.tsx",children:"Download"}),s.public?(0,a.jsx)(C.$,{type:"outline",icon:(0,a.jsx)($.A,{size:16,strokeWidth:2}),onClick:()=>o(n.name),disabled:n.isCorrupted,children:"Get URL"}):(0,a.jsxs)(ek.rI,{children:[(0,a.jsx)(ek.ty,{asChild:!0,children:(0,a.jsx)(C.$,{type:"outline",icon:(0,a.jsx)($.A,{size:16,strokeWidth:2}),iconRight:(0,a.jsx)(e4.A,{}),disabled:n.isCorrupted,children:"Get URL"})}),(0,a.jsxs)(ek.SQ,{side:"bottom",align:"center",children:[(0,a.jsx)(ek._2,{onClick:()=>o(n.name,y.Vm.WEEK),children:"Expire in 1 week"},"expires-one-week"),(0,a.jsx)(ek._2,{onClick:()=>o(n.name,y.Vm.MONTH),children:"Expire in 1 month"},"expires-one-month"),(0,a.jsx)(ek._2,{onClick:()=>o(n.name,y.Vm.YEAR),children:"Expire in 1 year"},"expires-one-year"),(0,a.jsx)(ek._2,{onClick:()=>i(n),children:"Custom expiry"},"custom-expiry")]})]})]}),(0,a.jsx)(eB.G,{type:"outline",disabled:!d,size:"tiny",icon:(0,a.jsx)(eg.A,{strokeWidth:2}),onClick:()=>l([n]),tooltip:{content:{side:"bottom",text:d?void 0:"You need additional permissions to delete this file"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"PreviewPane.tsx",children:"Delete file"})]})]})})})},e5=e=>{let{bucket:t}=e,{ref:s}=(0,x.g)(),n=(0,m.useRef)(null),{view:r,columns:o,selectedItems:d,selectedItemsToDelete:g,openedFolders:j,selectedItemsToMove:b,selectedBucket:w,openBucket:N,fetchFolderContents:k,fetchMoreFolderContents:S,fetchFoldersByPath:E,deleteFolder:A,uploadFiles:C,deleteFiles:_,moveFiles:T,popColumnAtIndex:P,popOpenedFoldersAtIndex:I,setSelectedItems:R,clearSelectedItems:L,setSelectedFilePreview:M,setSelectedItemsToMove:D,setSelectedItemsToDelete:z}=(0,f.$)();(0,p.I)({projectRef:s},{enabled:h.pe});let[F,O]=(0,m.useState)(""),B=window.innerHeight-122;(0,m.useEffect)(()=>{(async()=>{if(r===y.JB.LIST){let e=j.length-1,s=j[e],a=s?s.id:t.id,n=s?s.name:t.name,l=s?e:-1;await k({bucketId:t.id,folderId:a,folderName:n,index:l,searchString:F})}else r===y.JB.COLUMNS&&(j.length>0?E({paths:j.map(e=>e.name),searchString:F,showLoading:!0}):await k({bucketId:t.id,folderId:t.id,folderName:t.name,index:-1,searchString:F}))})()},[F]),(0,m.useEffect)(()=>{N(t)},[t]);let U=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;e.persist();let s=e.target.files||e.dataTransfer.items,a=!c()(i()(e,["dataTransfer","items"],[]));await C({files:s,columnIndex:t,isDrop:a}),e.target.value=""},G=async e=>{await T(e)},q=async()=>{if(1===g.length){let[e]=g;if(e)switch(e.type){case y.Vl.FOLDER:await A(e);break;case y.Vl.FILE:await _({files:[e]})}}else await _({files:g})};return(0,a.jsxs)("div",{ref:n,className:"bg-studio border rounded-md border-overlay flex h-full w-full flex-col m-4","data-sentry-component":"StorageExplorer","data-sentry-source-file":"StorageExplorer.tsx",children:[0===d.length?(0,a.jsx)(e0,{itemSearchString:F,setItemSearchString:O,onFilesUpload:U}):(0,a.jsx)(e1,{}),(0,a.jsxs)("div",{className:"flex h-full",style:{height:B},children:[(0,a.jsx)(eM,{columns:o,selectedItems:d,itemSearchString:F,onFilesUpload:U,onSelectAllItemsInColumn:e=>{let t=o[e].items.filter(e=>e.type===y.Vl.FILE).map(t=>({...t,columnIndex:e})),s=l()(t.map(e=>e.id));d.filter(e=>e.id&&s.includes(e.id)).length===t.length?R(d.filter(e=>e.id&&!s.includes(e.id))):R(u()(d.concat(t),"id"))},onSelectColumnEmptySpace:e=>{P(e),I(e-1),M(void 0),L()},onColumnLoadMore:(e,t)=>S({index:e,column:t,searchString:F}),"data-sentry-element":"FileExplorer","data-sentry-source-file":"StorageExplorer.tsx"}),(0,a.jsx)(e6,{"data-sentry-element":"PreviewPane","data-sentry-source-file":"StorageExplorer.tsx"})]}),(0,a.jsx)(v,{visible:g.length>0,selectedItemsToDelete:g,onSelectCancel:()=>z([]),onSelectDelete:q,"data-sentry-element":"ConfirmDeleteModal","data-sentry-source-file":"StorageExplorer.tsx"}),(0,a.jsx)(e2,{bucketName:w.name,visible:b.length>0,selectedItemsToMove:b,onSelectCancel:()=>D([]),onSelectMove:G,"data-sentry-element":"MoveItemsModal","data-sentry-source-file":"StorageExplorer.tsx"}),(0,a.jsx)(W,{"data-sentry-element":"CustomExpiryModal","data-sentry-source-file":"StorageExplorer.tsx"})]})};e5.displayName="StorageExplorer";let e7=e5;var e8=s(81097),e9=s.n(e8);let te={SELECTION:"SELECTION",TEMPLATES:"TEMPLATES",EDITOR:"EDITOR",REVIEW:"REVIEW"},tt=(e,t)=>{let{definition:s,check:a}=e,n={...e,definition:s?s.replace(/\s+/g," ").trim():void 0===s?null:s,check:a?a.replace(/\s+/g," ").trim():void 0===a?null:a};if(c()(t))return ts(n);if(ed()(e,t))return{};let l={};return(ed()(n.name,t.name)||(l.name=n.name),ed()(n.definition,t.definition)||(l.definition=n.definition),ed()(n.check,t.check)||(l.check=n.check),ed()(n.roles,t.roles)||(l.roles=n.roles),c()(l))?{}:ta(n,l)},ts=e=>{let{name:t,definition:s,check:a,command:n,schema:l,table:r}=e,i=0===e.roles.length?["public"]:e.roles;return{description:"Add policy for the ".concat(n,' operation under the policy "').concat(t,'"'),statement:['CREATE POLICY "'.concat(t,'" ON "').concat(l,'"."').concat(r,'"'),"AS PERMISSIVE FOR ".concat(n),"TO ".concat(i.join(", ")),"".concat(s?"USING (".concat(s,")"):""),"".concat(a?"WITH CHECK (".concat(a,")"):"")].join("\n")}},ta=(e,t)=>{var s;let{name:a,schema:n,table:l}=e,r=eE()(t,["definition"]),i=eE()(t,["check"]),o=eE()(t,["name"]),c=eE()(t,["roles"]),d=Object.keys(t),u="Update policy's ".concat(1===d.length?d[0]:"".concat(d.slice(0,d.length-1).join(", ")," and ").concat(d[d.length-1])," "),m=0===(null!=(s=null==t?void 0:t.roles)?s:[]).length?["public"]:t.roles,x='ALTER POLICY "'.concat(a,'" ON "').concat(n,'"."').concat(l,'"');return{description:u,statement:["BEGIN;",...r?["  ".concat(x," USING (").concat(t.definition,");")]:[],...i?["  ".concat(x," WITH CHECK (").concat(t.check,");")]:[],...c?["  ".concat(x," TO ").concat(m.join(", "),";")]:[],...o?["  ".concat(x,' RENAME TO "').concat(t.name,'";')]:[],"COMMIT;"].join("\n")}},tn=e=>{let{command:t,definition:s,check:a,roles:n}=e;return{...e,action:"PERMISSIVE",command:t||void 0,definition:s||void 0,check:a||void 0,roles:n.length>0?n:void 0}},tl=(e,t)=>{let{definition:s,check:a}=e,n={...e,definition:s?s.replace(/\s+/g," ").trim():s,check:a?a.replace(/\s+/g," ").trim():a},l={id:t.id};return ed()(n.name,t.name)||(l.name=n.name),ed()(n.definition,t.definition)||(l.definition=n.definition||void 0),ed()(n.check,t.check)||(l.check=n.check||void 0),ed()(n.roles,t.roles)||(0===n.roles.length?l.roles=["public"]:l.roles=n.roles||void 0),l};var tr=s(79467);let ti=e=>{let{operation:t="",onSelectOperation:s=j()}=e;return(0,a.jsxs)("div",{className:"flex justify-between space-x-12","data-sentry-component":"PolicyAllowedOperation","data-sentry-source-file":"PolicyAllowedOperation.tsx",children:[(0,a.jsxs)("div",{className:"flex w-1/3 flex-col space-y-2",children:[(0,a.jsx)("label",{className:"text-base text-foreground-light",htmlFor:"allowed-operation",children:"Allowed operation"}),(0,a.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Select an operation for this policy"})]}),(0,a.jsx)("div",{className:"w-2/3",children:(0,a.jsx)("div",{className:"flex items-center space-x-8",children:(0,a.jsx)(tr.A.Group,{type:"small-cards",size:"tiny",id:"allowed-operation","data-sentry-element":"unknown","data-sentry-source-file":"PolicyAllowedOperation.tsx",children:["SELECT","INSERT","UPDATE","DELETE","ALL"].map(e=>(0,a.jsx)(tr.A,{name:"allowed-operation",label:e,value:e,checked:t===e,onChange:e=>s(e.target.value)},e))})})})]})};var to=s(59024),tc=s(9387),td=s(63159);let tu=e=>{let{operation:t="",definition:s="",check:n="",onUpdatePolicyUsing:l=j(),onUpdatePolicyCheck:r=j()}=e,i=e=>["SELECT","UPDATE","DELETE","ALL"].includes(e)||!e,o=e=>["INSERT","UPDATE","ALL"].includes(e),c=(0,tc.Z)(t)||"";return(0,m.useEffect)(()=>{i(c)&&!i(t)&&l(void 0),o(c)&&!o(t)&&r(void 0)},[t]),(0,a.jsxs)("div",{className:"space-y-4","data-sentry-component":"PolicyDefinition","data-sentry-source-file":"PolicyDefinition.tsx",children:[i(t)&&(0,a.jsxs)("div",{className:"flex space-x-12",children:[(0,a.jsxs)("div",{className:"flex w-1/3 flex-col space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("label",{className:"text-base text-foreground-light",htmlFor:"policy-name",children:"USING expression"}),(0,a.jsxs)(eN.m_,{children:[(0,a.jsx)(eN.k$,{children:(0,a.jsx)(td.A,{className:"text-foreground-light",size:16,strokeWidth:1.5})}),(0,a.jsx)(eN.ZI,{side:"bottom",children:(0,a.jsxs)("div",{className:"w-[300px] space-y-2",children:[(0,a.jsx)("p",{className:"text-xs text-foreground",children:"This expression will be added to queries that refer to the table if row-level security is enabled."}),(0,a.jsx)("p",{className:"text-xs text-foreground",children:"Rows for which the expression returns true will be visible. Any rows for which the expression returns false or null will not be visible to the user (in a SELECT), and will not be available for modification (in an UPDATE or DELETE)."}),(0,a.jsx)("p",{className:"text-xs text-foreground",children:"Such rows are silently suppressed - no error is reported."})]})})]})]}),(0,a.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Provide a SQL conditional expression that returns a boolean."})]}),(0,a.jsx)("div",{className:"w-2/3 ".concat(o(t)?"h-32":"h-56"),children:(0,a.jsx)(to.A,{defaultValue:s,onInputChange:l})})]}),o(t)&&(0,a.jsxs)("div",{className:"flex space-x-12",children:[(0,a.jsxs)("div",{className:"flex w-1/3 flex-col space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("label",{className:"text-base text-foreground-light",htmlFor:"policy-name",children:"WITH CHECK expression"}),(0,a.jsxs)(eN.m_,{children:[(0,a.jsx)(eN.k$,{children:(0,a.jsx)(td.A,{className:"text-foreground-light",size:16,strokeWidth:1.5})}),(0,a.jsx)(eN.ZI,{side:"bottom",children:(0,a.jsxs)("div",{className:"w-[300px] space-y-2",children:[(0,a.jsx)("p",{className:"text-xs text-foreground",children:"This expression will be used in INSERT and UPDATE queries against the table if row-level security is enabled."}),(0,a.jsx)("p",{className:"text-xs text-foreground",children:"Only rows for which the expression evaluates to true will be allowed. An error will be thrown if the expression evaluates to false or null for any of the records inserted or any of the records that result from the update."}),(0,a.jsx)("p",{className:"text-xs text-foreground",children:"Note that this expression is evaluated against the proposed new contents of the row, not the original contents."})]})})]})]}),(0,a.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Provide a SQL conditional expression that returns a boolean."})]}),(0,a.jsx)("div",{className:"w-2/3 ".concat(i(t)?"h-32":"h-56"),children:(0,a.jsx)(to.A,{defaultValue:n,onInputChange:r})})]})]})},tm=e=>{let{showTemplates:t,onViewTemplates:s=j(),onReviewPolicy:n=j()}=e;return(0,a.jsx)("div",{className:"flex justify-between items-center border-t px-6 py-4 border-default","data-sentry-component":"PolicyEditorFooter","data-sentry-source-file":"PolicyEditorFooter.tsx",children:(0,a.jsxs)("div",{className:"flex w-full items-center justify-end gap-2",children:[t&&(0,a.jsx)(C.$,{type:"default",onClick:s,children:"View templates"}),(0,a.jsx)(C.$,{type:"primary",onClick:n,"data-sentry-element":"Button","data-sentry-source-file":"PolicyEditorFooter.tsx",children:"Review"})]})})},tx=e=>{let{name:t="",limit:s=100,onUpdatePolicyName:n}=e;return(0,a.jsxs)("div",{className:"flex flex-col md:flew-row gap-4 md:gap-12","data-sentry-component":"PolicyName","data-sentry-source-file":"PolicyName.tsx",children:[(0,a.jsxs)("div",{className:"flex md:w-1/3 flex-col space-y-2",children:[(0,a.jsx)("label",{className:"text-base text-foreground-light",htmlFor:"policy-name",children:"Policy name"}),(0,a.jsx)("p",{className:"text-sm text-foreground-lighter",children:"A descriptive name for your policy"})]}),(0,a.jsx)("div",{className:"relative md:w-2/3",children:(0,a.jsx)(E.A,{id:"policy-name",value:t,onChange:e=>n(e.target.value),actions:(0,a.jsxs)("span",{className:"mr-3 text-sm text-foreground-lighter",children:[t.length,"/",s]}),"data-sentry-element":"Input","data-sentry-source-file":"PolicyName.tsx"})})]})};var tp=s(58174),th=s(20313),tf=s(72192),ty=s(5483),tg=s(14506),tj=s.n(tg),tb=s(96342),tv=s(30788),tw=s.n(tv),tN=s(37253),tk=s.n(tN),tS=s(3689),tE=s(9681),tA=s(80016),tC=s(10455);function t_(e){let{options:t,value:s,label:n,error:l,descriptionText:r,placeholder:i,searchPlaceholder:o="Search for option",emptyMessage:c,disabled:d,allowDuplicateSelection:u=!1,onChange:x=()=>{}}=e,p=(0,m.useRef)(null),[h,f]=(0,m.useState)(!1),[y,g]=(0,m.useState)(s||[]),[j,b]=(0,m.useState)(""),[v,w]=(0,m.useState)(128),N=s||y;(0,m.useEffect)(()=>{w(p.current?p.current.offsetWidth:v)},[p.current]),(0,m.useEffect)(()=>{h||b("")},[h]);let k="".concat(v,"px"),S=tw()(t,["disabled"],["desc"]),A=j.length>0?e9()(S,e=>!e.disabled&&e.name.includes(j)):e9()(S,{disabled:!1}),C=e=>void 0!==(N||[]).find(t=>t===e.value),_=e=>{let t=y.filter((t,s)=>s!==e);g(t),x(t)},T=e=>{let s=C(e),a=u?[...N.concat([e.value])]:s?[...tk()(N,e.value)]:[...N.concat([e.value])],n=t.filter(e=>e.disabled).map(e=>e.name),l=u?a.concat(n):[...new Set(a.concat(n))];g(l),x(l)};return(0,a.jsxs)("div",{className:"form-group ".concat(d?"pointer-events-none opacity-50":""),"data-sentry-component":"MultiSelect","data-sentry-source-file":"index.tsx",children:[n&&(0,a.jsx)("label",{className:"!w-full",children:n}),(0,a.jsx)("div",{className:["form-control form-control--multi-select","border border-strong bg-control","multi-select relative block w-full space-x-1 overflow-auto rounded","".concat(void 0!==l?"border-red-800 bg-red-100":"")].join(" "),ref:p,children:(0,a.jsxs)(tE.AM,{open:h,onOpenChange:f,modal:!1,"data-sentry-element":"Popover_Shadcn_","data-sentry-source-file":"index.tsx",children:[(0,a.jsx)(tE.Wv,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"index.tsx",children:(0,a.jsxs)("div",{className:["flex w-full flex-wrap items-start gap-1.5 p-1.5 cursor-pointer","".concat(0===N.length?"h-9":"")].join(" "),onClick:()=>f(!0),children:[0===N.length&&i&&(0,a.jsx)("div",{className:"px-2 text-sm text-foreground-light h-full flex items-center",children:i}),N.map((e,t)=>{var s;let n="".concat(e,"-").concat(t),l=S.find(t=>t.value===e),r=null!=(s=null==l?void 0:l.disabled)&&s;return l?r?(0,a.jsx)(tC.a,{name:e},n):(0,a.jsx)(tC.h,{name:e,handleRemove:()=>u?_(t):T(l)},n):(0,a.jsx)(a.Fragment,{})}),(0,a.jsx)("div",{className:"absolute inset-y-0 right-0 pl-3 pr-2 flex space-x-1 items-center cursor-pointer ",children:(0,a.jsx)(e4.A,{size:16,strokeWidth:2,className:"text-foreground-lighter","data-sentry-element":"ChevronDown","data-sentry-source-file":"index.tsx"})})]})}),(0,a.jsxs)(tE.hl,{className:"p-0",side:"bottom",align:"start",style:{width:k,marginLeft:"-5px"},"data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"index.tsx",children:[(0,a.jsx)(E.A,{className:"[&>div>div>div>input]:!rounded-b-none [&>div>div>div>input]:!pl-9",icon:(0,a.jsx)(e$.A,{size:16}),placeholder:o,value:j,onChange:e=>b(e.target.value),"data-sentry-element":"Input","data-sentry-source-file":"index.tsx"}),(0,a.jsx)(tA.FK,{className:(0,tb.default)("p-1",A.length>5?"h-[225px]":""),"data-sentry-element":"ScrollArea","data-sentry-source-file":"index.tsx",children:A.length>=1?A.map(e=>{let t=!!(!u&&N&&N.find(t=>t===e.value));return(0,a.jsxs)("div",{onClick:()=>T(e),className:["text-typography-body-light [[data-theme*=dark]_&]:text-typography-body-dark","group flex cursor-pointer items-center justify-between transition","space-x-1 rounded bg-transparent p-2 px-4 text-sm hover:bg-overlay-hover","".concat(t?" [[data-theme*=dark]_&]:bg-green-600 [[data-theme*=dark]_&]:bg-opacity-25":"")].join(" "),children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("p",{children:e.name}),void 0!==e.description&&(0,a.jsx)("p",{className:"opacity-50",children:e.description})]}),t&&(0,a.jsx)(eH.A,{size:16,strokeWidth:3,className:"cursor-pointer transition ".concat(t?"text-brand":"")}),u&&(0,a.jsxs)("div",{className:"flex items-center opacity-0 group-hover:opacity-100 transition space-x-1",children:[(0,a.jsx)(tS.A,{size:14}),(0,a.jsx)("p",{className:"text-sm",children:"Add value"})]})]},"multiselect-option-".concat(e.id))}):0===t.length?(0,a.jsx)("div",{className:"flex h-full w-full flex-col border-default items-center justify-center border border-dashed p-3",children:c||(0,a.jsxs)("div",{className:"flex w-full items-center space-x-2",children:[(0,a.jsx)(eb.A,{strokeWidth:1.5,size:18,className:"text-foreground-light"}),(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"No options available"})]})}):(0,a.jsx)("div",{className:"flex h-full w-full flex-col border-default items-center justify-center border border-dashed p-3",children:c||(0,a.jsx)("div",{className:"flex w-full items-center space-x-2",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"No options found"})})})})]})]})}),r&&(0,a.jsx)("span",{className:"form-text text-muted mt-2 text-sm",children:r}),l&&(0,a.jsx)("span",{className:"text-red-900 text-sm mt-2",children:l})]})}let tT=e=>{let{selectedRoles:t,onUpdateSelectedRoles:s}=e,{data:n}=(0,ty.YA)(),{data:l,error:r,isLoading:i,isError:o,isSuccess:c}=(0,tf._X)({projectRef:null==n?void 0:n.ref,connectionString:null==n?void 0:n.connectionString}),d=tj()((null!=l?l:[]).filter(e=>!tp.QY.includes(e.name)),e=>e.name.toLocaleLowerCase()).map(e=>({id:e.id,name:e.name,value:e.name,disabled:!1}));return(0,a.jsxs)("div",{className:"flex flex-col md:flew-row gap-4 md:gap-12","data-sentry-component":"PolicyRoles","data-sentry-source-file":"PolicyRoles.tsx",children:[(0,a.jsxs)("div",{className:"flex md:w-1/3 flex-col space-y-2",children:[(0,a.jsx)("label",{className:"text-foreground-light text-base",htmlFor:"policy-name",children:"Target roles"}),(0,a.jsx)("p",{className:"text-foreground-lighter text-sm",children:"Apply policy to the selected roles"})]}),(0,a.jsxs)("div",{className:"relative md:w-2/3",children:[i&&(0,a.jsx)(en.A,{className:"py-4"}),o&&(0,a.jsx)(th.A,{error:r,subject:"Failed to retrieve database roles"}),c&&(0,a.jsx)(t_,{options:d,value:t,placeholder:"Defaults to all (public) roles if none selected",searchPlaceholder:"Search for a role",onChange:s})]})]})},tP=e=>{var t,s,n,l;let{isNewPolicy:r=!0,policyFormFields:i={},onUpdatePolicyFormFields:o=()=>{},onViewTemplates:c=()=>{},onReviewPolicy:d=()=>{}}=e,u=null!=(t=null==i?void 0:i.command)?t:"",m=null!=(s=null==i?void 0:i.definition)?s:"",x=null!=(n=null==i?void 0:i.check)?n:"",p=(null!=(l=null==i?void 0:i.roles)?l:[]).filter(e=>"public"!==e);return(0,a.jsxs)("div",{"data-sentry-component":"PolicyEditor","data-sentry-source-file":"index.tsx",children:[(0,a.jsx)(k.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"index.tsx",children:(0,a.jsx)(tx,{name:i.name,limit:63,onUpdatePolicyName:e=>o({name:e}),"data-sentry-element":"PolicyName","data-sentry-source-file":"index.tsx"})}),(0,a.jsx)(k.A.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"index.tsx"}),r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.A.Content,{children:(0,a.jsx)(ti,{operation:u,onSelectOperation:e=>o({command:e})})}),(0,a.jsx)(k.A.Separator,{})]}),(0,a.jsx)(k.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"index.tsx",children:(0,a.jsx)(tT,{selectedRoles:p,onUpdateSelectedRoles:e=>o({roles:e}),"data-sentry-element":"PolicyRoles","data-sentry-source-file":"index.tsx"})}),(0,a.jsx)(k.A.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"index.tsx"}),(0,a.jsx)(k.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"index.tsx",children:(0,a.jsx)(tu,{operation:u,definition:m,check:x,onUpdatePolicyUsing:e=>o({definition:e}),onUpdatePolicyCheck:e=>o({check:e}),"data-sentry-element":"PolicyDefinition","data-sentry-source-file":"index.tsx"})}),(0,a.jsx)(tm,{showTemplates:r,onViewTemplates:c,onReviewPolicy:d,"data-sentry-element":"PolicyEditorFooter","data-sentry-source-file":"index.tsx"})]})},tI=e=>{let{policy:t={},onSelectBack:s=j(),onSelectSave:n=j()}=e,[l,r]=(0,m.useState)(!1),i=t.statement||"";return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"PolicyReview.tsx",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between space-y-8",children:(0,a.jsx)("div",{className:"flex flex-col",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"This is the SQL statement that will be used to create your policy."})})}),(0,a.jsx)("div",{className:"space-y-4 overflow-y-auto",style:{maxHeight:"25rem"},children:c()(t)?(0,a.jsx)("div",{className:"my-10 flex items-center justify-center space-x-2 opacity-50",children:(0,a.jsx)("p",{className:"text-base text-foreground-light",children:"There are no changes made to this policy"})}):(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("span",{children:t.description}),(0,a.jsx)("div",{className:"h-40",children:(0,a.jsx)(to.A,{readOnly:!0,defaultValue:i})})]})})]})}),(0,a.jsxs)("div",{className:"flex w-full items-center justify-end gap-2 border-t px-6 py-4 border-default",children:[(0,a.jsx)(C.$,{type:"default",onClick:s,"data-sentry-element":"Button","data-sentry-source-file":"PolicyReview.tsx",children:"Back to edit"}),(0,a.jsx)(C.$,{type:"primary",disabled:c()(t),onClick:()=>{r(!0),n()},loading:l,"data-sentry-element":"Button","data-sentry-source-file":"PolicyReview.tsx",children:"Save policy"})]})]})};var tR=s(1012),tL=s(32035),tM=s(24276),tD=s(67776),tz=s(23445),tF=s(37411);let tO=e=>{let{description:t="",showAssistantPreview:s,onViewTemplates:n=j(),onViewEditor:l=j(),onToggleFeaturePreviewModal:r}=e;return(0,tF.qM)(),(0,a.jsxs)(k.A.Content,{className:"space-y-4 py-4","data-sentry-element":"unknown","data-sentry-component":"PolicySelection","data-sentry-source-file":"PolicySelection.tsx",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:t}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-2 lg:grid-cols-1",children:[(0,a.jsx)(tL.A,{title:"Get started quickly",description:"Create a policy from a template",icon:(0,a.jsx)("div",{className:"flex",children:(0,a.jsx)("div",{className:" flex h-8 w-8 items-center justify-center rounded bg-foreground text-background ",children:(0,a.jsx)(tM.A,{size:14,strokeWidth:2})})}),onClick:n,"data-sentry-element":"CardButton","data-sentry-source-file":"PolicySelection.tsx"}),(0,a.jsx)(tL.A,{title:"For full customization",description:"Create a policy from scratch",icon:(0,a.jsx)("div",{className:"flex",children:(0,a.jsx)("div",{className:" flex h-8 w-8 items-center justify-center rounded bg-foreground text-background ",children:(0,a.jsx)(ef.A,{size:14,strokeWidth:2})})}),onClick:l,"data-sentry-element":"CardButton","data-sentry-source-file":"PolicySelection.tsx"})]})]}),s&&void 0!==r&&(0,a.jsxs)(tR.Fc,{children:[(0,a.jsx)(tD.A,{}),(0,a.jsx)(tR.XL,{children:"Try the new Supabase Assistant for RLS policies"}),(0,a.jsx)(tR.TN,{children:"Create RLS policies for your tables with the help of AI"}),(0,a.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,a.jsx)(C.$,{type:"default",onClick:r,children:"Toggle feature preview"}),(0,a.jsx)(C.$,{asChild:!0,type:"default",icon:(0,a.jsx)(tz.A,{strokeWidth:1.5}),children:(0,a.jsx)("a",{href:"https://supabase.com/blog/studio-introducing-assistant#introducing-the-supabase-assistant",target:"_blank",rel:"noreferrer",children:"Learn more"})})]})]})]})},tB=e=>{let{selectedTemplate:t}=e,{id:s,templateName:n,description:l,statement:r}=t;return(0,a.jsx)("div",{className:"space-y-8 md:w-[70%]","data-sentry-component":"TemplatePreview","data-sentry-source-file":"TemplatePreview.tsx",children:!c()(t)&&(0,a.jsx)("div",{className:"flex h-full flex-col justify-between",children:(0,a.jsxs)("div",{className:"my-5 h-full space-y-6 px-6",children:[(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,a.jsx)("h3",{children:n}),(0,a.jsx)("p",{className:"text-foreground-light text-sm",children:l})]})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-foreground-light text-sm",children:"Policy SQL template:"}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(to.A,{readOnly:!0,queryId:s,defaultValue:r})})]})]})})})};var tW=s(43242);let tU=e=>{let{templates:t=[],templatesNote:s="",selectedTemplate:n,setSelectedTemplate:l=j()}=e;return(0,a.jsxs)("div",{className:"flex flex-col justify-between border-r border-default w-full","data-sentry-component":"TemplatesList","data-sentry-source-file":"TemplatesList.tsx",children:[(0,a.jsx)("div",{className:"hide-scrollbar divide-border-primary space-y-0 divide-y divide-solid overflow-y-auto",style:{maxHeight:"24rem"},children:(0,a.jsx)(tW.Ay,{type:"border","data-sentry-element":"Menu","data-sentry-source-file":"TemplatesList.tsx",children:t.map((e,t)=>{let s=(null==n?void 0:n.id)===(null==e?void 0:e.id);return(0,a.jsx)("div",{className:"border-b border-overlay hover:bg-surface-200 "+(s?"bg-surface-300":""),children:(0,a.jsx)(tW.Ay.Item,{active:s,onClick:()=>l(e),children:(0,a.jsx)("div",{className:"truncate py-2",children:e.templateName})},e.id)},t)})})}),s&&(0,a.jsx)("div",{className:"px-4 py-2",children:(0,a.jsx)("p",{className:"text-xs text-foreground-lighter",children:s})})]})},tG=e=>{let{templates:t=[],templatesNote:s="",onUseTemplate:n=j()}=e,[l,r]=(0,m.useState)(t[0]);return(0,a.jsxs)("div",{"data-sentry-component":"PolicyTemplates","data-sentry-source-file":"index.tsx",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between border-t border-default",children:[(0,a.jsx)(tU,{templatesNote:s,templates:t,selectedTemplate:l,setSelectedTemplate:r,"data-sentry-element":"TemplatesList","data-sentry-source-file":"index.tsx"}),(0,a.jsx)(tB,{selectedTemplate:l,"data-sentry-element":"TemplatePreview","data-sentry-source-file":"index.tsx"})]}),(0,a.jsxs)("div",{className:"flex w-full items-center justify-end gap-3 border-t px-6 py-4 border-default",children:[(0,a.jsx)("span",{className:"text-sm text-foreground-lighter",children:"This will override any existing code you've written"}),(0,a.jsx)(C.$,{type:"primary",disabled:c()(l),onClick:()=>n(l),"data-sentry-element":"Button","data-sentry-source-file":"index.tsx",children:"Use this template"})]})]})};var tq=s(28758),tV=s(62136);let tH=e=>{let{view:t,schema:s,table:n,isNewPolicy:l,showAssistantPreview:r,onSelectBackFromTemplates:i=j(),onToggleFeaturePreviewModal:o}=e,c=()=>t===te.EDITOR||t===te.SELECTION?"".concat(l?"Adding new policy to":"Editing policy from"," ").concat(s,".").concat(n):t===te.REVIEW?"Reviewing policy to be ".concat(l?"created":"updated"," on ").concat(s,".").concat(n):void 0;return t===te.TEMPLATES?(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("span",{onClick:i,className:"cursor-pointer text-foreground-lighter transition-colors hover:text-foreground",children:(0,a.jsx)(eU.A,{strokeWidth:2,size:14})}),(0,a.jsx)("h4",{children:"Select a template to use for your new policy"})]})}):(0,a.jsxs)("div",{className:"w-full flex items-center justify-between gap-x-4","data-sentry-component":"PolicyEditorModalTitle","data-sentry-source-file":"PolicyEditorModalTitle.tsx",children:[(0,a.jsx)("h4",{className:"truncate",title:c(),children:c()}),(0,a.jsxs)("div",{className:"flex items-center gap-x-2 pr-6",children:[r&&t===te.EDITOR&&(0,a.jsx)(C.$,{type:"default",icon:(0,a.jsx)(tD.A,{}),onClick:o,children:"Try Supabase Assistant"}),(0,a.jsx)(tV.A,{className:"mt-[-4px]",href:"https://supabase.com/docs/learn/auth-deep-dive/auth-policies","data-sentry-element":"DocsButton","data-sentry-source-file":"PolicyEditorModalTitle.tsx"})]})]})},t$=e=>{let{visible:t=!1,schema:s="",table:n="",selectedPolicyToEdit:l={},showAssistantPreview:r=!1,onSelectCancel:i=j(),onCreatePolicy:o,onUpdatePolicy:d,onSaveSuccess:u=j()}=e,{toggleFeaturePreviewModal:x}=(0,eF.j_)(),p=c()(l),h=p?{schema:s,table:n,name:"",definition:"",check:"",command:null,roles:[]}:l,[f,y]=(0,m.useState)(""),[g,v]=(0,m.useState)(te.EDITOR),[w,N]=(0,m.useState)(h),[S,E]=(0,m.useState)(""),[A,C]=(0,m.useState)(!1),[T,P]=(0,m.useState)(!1);(0,m.useEffect)(()=>{t&&(p?I():R(),N(h))},[t]);let I=()=>v(te.SELECTION),R=()=>v(te.EDITOR),L=()=>{y(g),v(te.TEMPLATES)},M=()=>v(te.REVIEW),D=()=>{x(),i()},z=async e=>{(p?await o(e):await d(e))?R():u()};return(0,a.jsx)(k.A,{hideFooter:!0,size:g===te.SELECTION?"medium":"xxlarge",visible:t,contentStyle:{padding:0},header:[(0,a.jsx)(tH,{view:g,isNewPolicy:p,schema:s,table:n,showAssistantPreview:r,onSelectBackFromTemplates:()=>v(f),onToggleFeaturePreviewModal:D},"0")],onCancel:()=>{A?P(!0):i()},"data-sentry-element":"Modal","data-sentry-component":"PolicyEditorModal","data-sentry-source-file":"index.tsx",children:(0,a.jsxs)("div",{children:[(0,a.jsx)(b.A,{visible:T,title:"Discard changes",confirmLabel:"Discard",onCancel:()=>P(!1),onConfirm:()=>{i(),P(!1),C(!1)},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"index.tsx",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"There are unsaved changes. Are you sure you want to close the editor? Your changes will be lost."})}),g===te.SELECTION?(0,a.jsx)(tO,{description:"Write rules with PostgreSQL's policies to fit your unique business needs.",onViewTemplates:L,onViewEditor:R,showAssistantPreview:r,onToggleFeaturePreviewModal:D}):g===te.EDITOR?(0,a.jsx)(tP,{isNewPolicy:p,policyFormFields:w,onUpdatePolicyFormFields:e=>{C(!0),e.name&&e.name.length>63||N({...w,...e})},onViewTemplates:L,onReviewPolicy:()=>{let{name:e,definition:t,check:s,command:a}=w;return 0===e.length?_.oR.error("Please provide a name for your policy"):a?["SELECT","DELETE"].includes(a)&&!t?_.oR.error("Please provide a USING expression for your policy"):"INSERT"!==a||s?"UPDATE"!==a||t||s?void(E(tt(w,l)),M()):_.oR.error("Please provide either a USING, or WITH CHECK expression, or both for your policy"):_.oR.error("Please provide a WITH CHECK expression for your policy"):_.oR.error("Please select an operation for your policy")}}):g===te.TEMPLATES?(0,a.jsx)(tG,{templates:(0,tq.S3)(s,n).filter(e=>!e.preview),templatesNote:"* References a specific column in the table",onUseTemplate:e=>{N({...w,name:e.name,definition:e.definition,check:e.check,command:e.command,roles:e.roles}),R()}}):g===te.REVIEW?(0,a.jsx)(tI,{policy:S,onSelectBack:R,onSelectSave:()=>{z(p?tn(w):tl(w,l)),C(!1)}}):null]})})};var tY=s(33647),tJ=s(47319),tQ=s(32144),tK=s(80251),tZ=s(15629),tX=s(30784);async function t0(e){let{projectRef:t,connectionString:s,payload:a}=e,n=new Headers;s&&n.set("x-connection-encrypted",s);let{sql:l}=tJ.A.policies.create(a),{result:r}=await (0,tZ.E)({projectRef:t,connectionString:s,sql:l,queryKey:["policy","create"]});return r}let t1=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,tQ.jE)();return(0,tK.n)(e=>t0(e),{async onSuccess(t,s,n){let{projectRef:l}=s;await a.invalidateQueries(tX.S.list(l)),await (null==e?void 0:e(t,s,n))},async onError(e,s,a){void 0===t?_.oR.error("Failed to create database policy: ".concat(e.message)):t(e,s,a)},...s})};var t2=s(17498),t4=s(48700),t3=s(86349),t6=s(44326),t5=s(107),t7=s.n(t5),t8=s(42092),t9=s.n(t8);let se=e=>{let t=0;for(let s=0;s<e.length;s++)t=(t<<5)-t+e.charCodeAt(s),t&=t;return new Uint32Array([t])[0].toString(36)},st=(e,t)=>0===t.length?t:sn(ss(e,t)),ss=(e,t)=>{let s=e.map(e=>e.name);return t.map(e=>{let{definition:t,check:a}=e,n=null!==t?sa(t):sa(a);return n&&s.includes(n)?{...e,bucket:n}:{...e,bucket:"Ungrouped"}})},sa=e=>{var t;let[s]=(null!=(t=null==e?void 0:e.split(" AND "))?t:[]).filter(e=>e.includes("bucket_id"));return s?s.split("'")[1]:null},sn=e=>{let t=t7()(e,"bucket");return Object.keys(t).map(e=>({name:e,policies:t[e]}))},sl=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,s=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{name:a,definition:n,allowedOperations:l,roles:r}=t,i=n?n.replace(/\s+/g," ").trim():"";return l.map((t,n)=>sr(n,e,a,i,t,r,s))},sr=(e,t,s,a,n,l,r)=>{let i=se(t);return{name:r?"".concat(s," ").concat(i,"_").concat(e):s,definition:"INSERT"===n?void 0:"(".concat(a,")"),action:"PERMISSIVE",check:"INSERT"===n?"(".concat(a,")"):void 0,command:n,schema:"storage",table:"objects",roles:l.length>0?l:void 0}},si=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object.keys(y.Uw).filter(t=>{let s=y.Uw[t];if(0===t9()(s,e).length)return t})},so=(e,t,s,a,n,l,r)=>{let i=se(t),o=r?"".concat(s," ").concat(i,"_").concat(e):s,c="Add policy for the ".concat(n,' operation under the policy "').concat(s,'"'),d=0===l.length?["public"]:l;return{description:c,statement:'\n    CREATE POLICY "'.concat(o,'"\n    ON storage.objects\n    FOR ').concat(n,"\n    TO ").concat(d.join(", "),"\n    ").concat("INSERT"===n?"WITH CHECK":"USING"," (").concat(a,");\n").replace(/\s+/g," ").trim()}},sc=function(e,t){let s=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{name:a,definition:n,allowedOperations:l,roles:r}=t;return l.map((t,l)=>so(l,e,a,n||"",t,r,s))},sd=(e,t)=>e.replace("{bucket_id}","'".concat(t,"'"));var su=s(43969),sm=s(17089),sx=s(98357),sp=s(2119);let sh=e=>{let{policy:t,table:s,bucketName:n,onSelectPolicyEdit:l=()=>{},onSelectPolicyDelete:r=()=>{}}=e,{name:i,command:o}=t;return(0,a.jsx)("div",{className:"group","data-sentry-component":"PolicyRow","data-sentry-source-file":"StoragePoliciesBucketRow.tsx",children:(0,a.jsxs)(su.A.Content,{className:"flex justify-between gap-2 border-b border-overlay py-4","data-sentry-element":"unknown","data-sentry-source-file":"StoragePoliciesBucketRow.tsx",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center",children:[(0,a.jsx)("div",{className:"font-mono text-xs text-foreground-lighter",children:o}),(0,a.jsx)("div",{className:"flex flex-col gap-2 lg:flex-row",children:(0,a.jsx)("span",{className:"truncate text-sm text-foreground",children:i})})]}),(0,a.jsxs)(ek.rI,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"StoragePoliciesBucketRow.tsx",children:[(0,a.jsx)(ek.ty,{"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"StoragePoliciesBucketRow.tsx",children:(0,a.jsx)(C.$,{type:"default",className:"px-1.5",icon:(0,a.jsx)(ev.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"StoragePoliciesBucketRow.tsx"})}),(0,a.jsxs)(ek.SQ,{side:"bottom",align:"end","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"StoragePoliciesBucketRow.tsx",children:[(0,a.jsxs)(ek._2,{className:"gap-x-2",onClick:()=>l(t,n,s),"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"StoragePoliciesBucketRow.tsx",children:[(0,a.jsx)(ef.A,{size:14,"data-sentry-element":"Edit","data-sentry-source-file":"StoragePoliciesBucketRow.tsx"}),(0,a.jsx)("p",{children:"Edit"})]}),(0,a.jsx)(ek.mB,{"data-sentry-element":"DropdownMenuSeparator","data-sentry-source-file":"StoragePoliciesBucketRow.tsx"}),(0,a.jsxs)(ek._2,{className:"gap-x-2",onClick:()=>r(t),"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"StoragePoliciesBucketRow.tsx",children:[(0,a.jsx)(sm.A,{size:14,"data-sentry-element":"Trash","data-sentry-source-file":"StoragePoliciesBucketRow.tsx"}),(0,a.jsx)("p",{children:"Delete"})]})]})]})]})})},sf=e=>{let{table:t="",label:s="",bucket:n={},policies:l=[],onSelectPolicyAdd:r=()=>{},onSelectPolicyEdit:i=()=>{},onSelectPolicyDelete:o=()=>{}}=e;return(0,a.jsx)(su.A,{title:[(0,a.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(sx.A,{className:"text-foreground-light",size:14}),(0,a.jsx)("h4",{className:"m-0 text-lg",children:(0,a.jsx)("span",{children:s})}),n.public&&(0,a.jsx)(sp.E,{variant:"warning",children:"Public"})]}),(0,a.jsx)(C.$,{type:"outline",onClick:()=>r(n.name,t),children:"New policy"})]},s)],"data-sentry-element":"Panel","data-sentry-component":"StoragePoliciesBucketRow","data-sentry-source-file":"StoragePoliciesBucketRow.tsx",children:0===l.length?(0,a.jsx)("div",{className:"p-4 px-6",children:(0,a.jsx)("p",{className:"text-sm text-foreground-lighter",children:"No policies created yet"})}):(0,a.jsxs)("div",{className:"grid grid-cols-1 divide-y [[data-theme*=dark]_&]:divide-dark",children:[l.map(e=>(0,a.jsx)(sh,{policy:e,table:t,bucketName:n.name,onSelectPolicyEdit:i,onSelectPolicyDelete:o},e.name)),0!==l.length?(0,a.jsx)("div",{className:"px-6 py-2",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:c()(n)?"objects"===t?"".concat(l.length," polic").concat(l.length>1?"ies":"y"," that are not tied to any buckets"):"".concat(l.length," polic").concat(l.length>1?"ies":"y"," that target your buckets"):"".concat(l.length," polic").concat(l.length>1?"ies":"y"," in ").concat(n.name)})}):null]})})};var sy=s(55240),sg=s.n(sy);let sj=[{id:"policy-1",templateName:"Allow access to JPG images in a public folder to anonymous users",description:"This policy uses native postgres functions, functions from auth and storage schema",name:"Give anon users access to JPG images in folder",statement:"\nCREATE POLICY \"policy_name\"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n  -- restrict bucket\n  bucket_id = {bucket_name}\n  -- allow access to only jpg file\n  AND storage.\"extension\"(name) = 'jpg'\n  -- in the public folder\n  AND LOWER((storage.foldername(name))[1]) = 'public'\n  -- to anonymous users\n  AND auth.role() = 'anon'\n);\n    ".trim(),definition:"bucket_id = {bucket_id} AND storage.\"extension\"(name) = 'jpg' AND LOWER((storage.foldername(name))[1]) = 'public' AND auth.role() = 'anon'",allowedOperations:[]},{id:"policy-2",templateName:"Give users access to only their own top level folder named as uid",description:"For example a user with id d7bed83c-44a0-4a4f-925f-efc384ea1e50 will be able to access anything under the folder d7bed83c-44a0-4a4f-925f-efc384ea1e50/",name:"Give users access to own folder",statement:'\nCREATE POLICY "policy_name"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n    -- restrict bucket\n    bucket_id = {bucket_name}\n    and (select auth.uid()::text) = (storage.foldername(name))[1]\n);\n    '.trim(),definition:"bucket_id = {bucket_id} AND (select auth.uid()::text) = (storage.foldername(name))[1]",allowedOperations:[]},{id:"policy-3",templateName:"Give users access to a folder only to authenticated users",description:"This policy gives users access to a folder (e.g private) only if they are authenticated",name:"Give users authenticated access to folder",statement:"\nCREATE POLICY \"policy_name\"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n    -- restrict bucket\n    bucket_id = {bucket_name}\n    AND (storage.foldername(name))[1] = 'private'\n    AND (select auth.role()) = 'authenticated'\n);\n    ".trim(),definition:"bucket_id = {bucket_id} AND (storage.foldername(name))[1] = 'private' AND auth.role() = 'authenticated'",allowedOperations:[]},{id:"policy-4",templateName:"Give access to a nested folder called admin/assets only to a specific user",description:'This policy gives read access to all authenticated users for your project to the folder "public"',name:"Give access to a folder",statement:"\nCREATE POLICY \"policy_name\"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n	  -- restrict bucket\n    bucket_id = {bucket_name}\n    AND (storage.foldername(name))[1] = 'admin' AND (storage.foldername(name))[2] = 'assets'\n    AND (select auth.uid()::text) = 'd7bed83c-44a0-4a4f-925f-efc384ea1e50'\n);\n    ".trim(),definition:"bucket_id = {bucket_id} AND (storage.foldername(name))[1] = 'admin' AND (storage.foldername(name))[2] = 'assets' AND (select auth.uid()::text) = 'd7bed83c-44a0-4a4f-925f-efc384ea1e50'",allowedOperations:[]},{id:"policy-5",templateName:"Give access to a file to a user",description:"This policy gives access to a specific file to a specific user",name:"Give access to a file to user",statement:"\nCREATE POLICY \"policy_name\"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n	  -- restrict bucket\n    bucket_id = {bucket_name}\n    AND name = 'admin/assets/Costa Rican Frog.jpg'\n    AND (select auth.uid()::text) = 'd7bed83c-44a0-4a4f-925f-efc384ea1e50'\n);\n    ".trim(),definition:"bucket_id = {bucket_id} AND name = 'admin/assets/Costa Rican Frog.jpg' AND (select auth.uid()::text) = 'd7bed83c-44a0-4a4f-925f-efc384ea1e50'",allowedOperations:[]}],sb=e=>{let{definition:t="",onUpdatePolicyDefinition:s=()=>{}}=e;return(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 md:gap-12","data-sentry-component":"PolicyDefinition","data-sentry-source-file":"StoragePoliciesEditor.tsx",children:[(0,a.jsxs)("div",{className:"flex md:w-1/3 flex-col space-y-2",children:[(0,a.jsx)("label",{className:"text-base text-foreground-light",htmlFor:"policy-name",children:"Policy definition"}),(0,a.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Provide a SQL conditional expression that returns a boolean."})]}),(0,a.jsx)("div",{className:"h-56 md:w-2/3",children:(0,a.jsx)(to.A,{defaultValue:t,onInputChange:s,"data-sentry-element":"SqlEditor","data-sentry-source-file":"StoragePoliciesEditor.tsx"})})]})},sv=e=>{let{allowedOperations:t=[],onToggleOperation:s=()=>{}}=e,n=si(t);return(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between gap-4 md:gap-12","data-sentry-component":"PolicyAllowedOperations","data-sentry-source-file":"StoragePoliciesEditor.tsx",children:[(0,a.jsxs)("div",{className:"flex md:w-1/3 flex-col space-y-2",children:[(0,a.jsx)("label",{className:"text-base text-foreground-light",htmlFor:"allowed-operation",children:"Allowed operation"}),(0,a.jsxs)("p",{className:"text-sm text-foreground-lighter",children:["Based on the operations you have selected, you can use the highlighted functions in the"," ",(0,a.jsx)("a",{href:"https://supabase.com/docs/reference/javascript/storage-from-list",target:"_blank",rel:"noreferrer",className:"underline",children:"client library"}),"."]})]}),(0,a.jsxs)("div",{className:"md:w-2/3",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-x-8 gap-y-4",children:[(0,a.jsx)(er.A,{label:"SELECT",onChange:()=>s("SELECT"),checked:t.includes("SELECT"),"data-sentry-element":"Checkbox","data-sentry-source-file":"StoragePoliciesEditor.tsx"}),(0,a.jsx)(er.A,{label:"INSERT",onChange:()=>s("INSERT"),checked:t.includes("INSERT"),"data-sentry-element":"Checkbox","data-sentry-source-file":"StoragePoliciesEditor.tsx"}),(0,a.jsx)(er.A,{label:"UPDATE",onChange:()=>s("UPDATE"),checked:t.includes("UPDATE"),"data-sentry-element":"Checkbox","data-sentry-source-file":"StoragePoliciesEditor.tsx"}),(0,a.jsx)(er.A,{label:"DELETE",onChange:()=>s("DELETE"),checked:t.includes("DELETE"),"data-sentry-element":"Checkbox","data-sentry-source-file":"StoragePoliciesEditor.tsx"})]}),(0,a.jsx)("div",{className:"flex w-5/6 flex-wrap",children:Object.keys(y.Uw).map(e=>(0,a.jsx)("div",{className:"mr-2 mt-2 font-mono",children:(0,a.jsx)(sp.E,{variant:n.includes(e)?"brand":"default",children:e})},e))})]})]})},sw=e=>{let{onViewTemplates:t=()=>{},onReviewPolicy:s=()=>{}}=e;return(0,a.jsxs)("div",{className:"flex w-full items-center justify-end gap-x-2 border-t px-6 py-3 border-default","data-sentry-component":"PolicyEditorFooter","data-sentry-source-file":"StoragePoliciesEditor.tsx",children:[(0,a.jsx)(C.$,{type:"default",onClick:t,"data-sentry-element":"Button","data-sentry-source-file":"StoragePoliciesEditor.tsx",children:"View templates"}),(0,a.jsx)(C.$,{type:"primary",onClick:s,"data-sentry-element":"Button","data-sentry-source-file":"StoragePoliciesEditor.tsx",children:"Review"})]})},sN=e=>{let{policyFormFields:t={},onViewTemplates:s=j(),onUpdatePolicyName:n=j(),onUpdatePolicyDefinition:l=j(),onToggleOperation:r=j(),onUpdatePolicyRoles:i=j(),onReviewPolicy:o=j()}=e,c=t.definition,d=t.roles;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsx)(k.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"StoragePoliciesEditor.tsx",children:(0,a.jsx)(tx,{name:t.name,limit:50,onUpdatePolicyName:n,"data-sentry-element":"PolicyName","data-sentry-source-file":"StoragePoliciesEditor.tsx"})}),(0,a.jsx)(k.A.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"StoragePoliciesEditor.tsx"}),(0,a.jsx)(k.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"StoragePoliciesEditor.tsx",children:(0,a.jsx)(sv,{allowedOperations:t.allowedOperations,onToggleOperation:r,"data-sentry-element":"PolicyAllowedOperations","data-sentry-source-file":"StoragePoliciesEditor.tsx"})}),(0,a.jsx)(k.A.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"StoragePoliciesEditor.tsx"}),(0,a.jsx)(k.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"StoragePoliciesEditor.tsx",children:(0,a.jsx)(tT,{selectedRoles:d,onUpdateSelectedRoles:i,"data-sentry-element":"PolicyRoles","data-sentry-source-file":"StoragePoliciesEditor.tsx"})}),(0,a.jsx)(k.A.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"StoragePoliciesEditor.tsx"}),(0,a.jsx)(k.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"StoragePoliciesEditor.tsx",children:(0,a.jsx)(sb,{definition:c,onUpdatePolicyDefinition:l,"data-sentry-element":"PolicyDefinition","data-sentry-source-file":"StoragePoliciesEditor.tsx"})})]}),(0,a.jsx)(sw,{onViewTemplates:s,onReviewPolicy:o,"data-sentry-element":"PolicyEditorFooter","data-sentry-source-file":"StoragePoliciesEditor.tsx"})]})},sk=()=>(0,a.jsx)("div",{className:"my-10 flex items-center justify-center space-x-2 opacity-50","data-sentry-component":"ReviewEmptyState","data-sentry-source-file":"StoragePoliciesReview.tsx",children:(0,a.jsx)("p",{children:"There are no changes made to this policy"})}),sS=e=>{let{policyStatements:t=[],onSelectBack:s=()=>{},onSelectSave:n=()=>{}}=e,[l,r]=(0,m.useState)(!1);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(k.A.Content,{className:"space-y-6","data-sentry-element":"unknown","data-sentry-source-file":"StoragePoliciesReview.tsx",children:[(0,a.jsx)("div",{className:"flex items-center justify-between space-y-8 space-x-4",children:(0,a.jsx)("div",{className:"flex flex-col",children:(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["These are the SQL statements that will be used to create your policies. The suffix appended to the end of your policy name (",(0,a.jsx)("code",{children:"[hashString]_[number]"}),") just functions as a unique identifier for each of your policies."]})})}),(0,a.jsxs)("div",{className:"space-y-4 overflow-y-auto",style:{maxHeight:"25rem"},children:[0===t.length&&(0,a.jsx)(sk,{}),t.map((e,t)=>{let s=e.statement||"";return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("span",{children:e.description}),(0,a.jsx)("div",{className:"h-40",children:(0,a.jsx)(to.A,{readOnly:!0,defaultValue:s})})]},"policy_".concat(t))})]})]}),(0,a.jsx)(k.A.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"StoragePoliciesReview.tsx"}),(0,a.jsxs)(k.A.Content,{className:"flex w-full items-center justify-end gap-2","data-sentry-element":"unknown","data-sentry-source-file":"StoragePoliciesReview.tsx",children:[(0,a.jsx)(C.$,{type:"default",onClick:s,"data-sentry-element":"Button","data-sentry-source-file":"StoragePoliciesReview.tsx",children:"Back to edit"}),t.length>0&&(0,a.jsx)(C.$,{type:"primary",onClick:()=>{r(!0),n()},loading:l,children:"Save policy"})]})]})},sE={name:"",roles:[],policyIds:[],definition:"",allowedOperations:[]},sA=e=>{let{visible:t=!1,bucketName:s="",onSelectCancel:n=()=>{},onCreatePolicies:l=()=>{},onSaveSuccess:r=()=>{}}=e,[i,o]=(0,m.useState)(""),[c,d]=(0,m.useState)(""),[u,x]=(0,m.useState)(sE),[p,h]=(0,m.useState)([]);(0,m.useEffect)(()=>{t&&(f(),x(sE))},[t]);let f=()=>d(te.SELECTION),y=e=>{"new"===e&&x({...u,definition:"bucket_id = '".concat(s,"'")}),d(te.EDITOR)},g=()=>{o(c),d(te.TEMPLATES)},b=()=>d(te.REVIEW),v=async e=>{-1!==(await l(e)).indexOf(!0)?y():r()};return(0,a.jsx)(k.A,{hideFooter:!0,className:"[&>div:first-child]:py-3",size:c===te.SELECTION?"medium":"xxlarge",visible:t,contentStyle:{padding:0},header:[(0,a.jsx)(e=>{let{view:t,bucketName:s,onSelectBackFromTemplates:n=j()}=e;return t===te.TEMPLATES?(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("span",{onClick:n,className:"cursor-pointer text-foreground-lighter transition-colors hover:text-foreground",children:(0,a.jsx)(eU.A,{strokeWidth:2,size:14})}),(0,a.jsx)("h4",{className:"textlg m-0",children:"Select a template to use for your new policy"})]})}):(0,a.jsxs)("div",{className:"w-full flex items-center justify-between gap-x-2 pr-6","data-sentry-component":"StoragePolicyEditorModalTitle","data-sentry-source-file":"StoragePoliciesEditPolicyModal.tsx",children:[(0,a.jsx)("h4",{className:"m-0 truncate",children:t===te.EDITOR||t===te.SELECTION?"Adding new policy to ".concat(s):t===te.REVIEW?"Reviewing policies to be created for ".concat(s):void 0}),(0,a.jsx)(tV.A,{href:"https://supabase.com/docs/learn/auth-deep-dive/auth-policies","data-sentry-element":"DocsButton","data-sentry-source-file":"StoragePoliciesEditPolicyModal.tsx"})]})},{view:c,bucketName:s,onSelectBackFromTemplates:()=>d(i)},"0")],onCancel:n,"data-sentry-element":"Modal","data-sentry-component":"StoragePoliciesEditPolicyModal","data-sentry-source-file":"StoragePoliciesEditPolicyModal.tsx",children:(0,a.jsx)("div",{className:"w-full",children:c===te.SELECTION?(0,a.jsx)(tO,{description:"PostgreSQL policies control access to your files and folders",onViewTemplates:g,onViewEditor:()=>y("new"),showAssistantPreview:!1}):c===te.EDITOR?(0,a.jsx)(sN,{policyFormFields:u,onViewTemplates:g,onUpdatePolicyName:e=>{e.length<=50&&x({...u,name:e})},onUpdatePolicyDefinition:e=>{x({...u,definition:e})},onToggleOperation:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t)return x({...u,allowedOperations:[e]});let s=u.allowedOperations.includes(e)?sg()(u.allowedOperations.slice(),e):u.allowedOperations.concat([e]);return x({...u,allowedOperations:s})},onUpdatePolicyRoles:e=>{x({...u,roles:e})},onReviewPolicy:()=>{let{name:e,definition:t,allowedOperations:a}=u;return 0===e.length?_.oR.error("Please provide a name for your policy"):0===t.length?_.oR.error("Please provide a definition for your policy"):0===a.length?_.oR.error("Please allow at least one operation in your policy"):void(h(sc(s,u)),b())}}):c===te.TEMPLATES?(0,a.jsx)(tG,{templates:sj,onUseTemplate:e=>{let{id:t,...a}=e,n=sd(a.definition,s);x({...u,...a,definition:n}),y()},templatesNote:""}):c===te.REVIEW?(0,a.jsx)(sS,{policyStatements:p,onSelectBack:y,onSelectSave:()=>{v(sl(s,u))}}):(0,a.jsx)("div",{})})})},sC=()=>(0,a.jsx)(su.A,{title:[(0,a.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(sx.A,{size:"18"}),(0,a.jsx)("h4",{children:"Bucket policies"})]})},"storagePlaceholder")],"data-sentry-element":"Panel","data-sentry-component":"StoragePoliciesPlaceholder","data-sentry-source-file":"StoragePoliciesPlaceholder.tsx",children:(0,a.jsx)("div",{className:"p-4 px-6",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Create a bucket first to start writing policies!"})})}),s_=()=>{let{data:e}=(0,ty.YA)(),{ref:t}=(0,x.g)(),{data:s,isLoading:n}=(0,t3.p)({projectRef:t}),l=null!=s?s:[],[r,o]=(0,m.useState)({}),[d,u]=(0,m.useState)({}),[p,h]=(0,m.useState)({}),{data:f,refetch:y,isLoading:g}=(0,tY.j)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString,schema:"storage"}),j=null!=f?f:[],{mutateAsync:b}=t1({onError:()=>{}}),{mutateAsync:v}=(0,t4.V)(),{mutate:w}=(0,t2.f)({onSuccess:async()=>{await y(),_.oR.success("Successfully deleted policy!"),u({})}}),N=c()(r)&&!c()(p)&&i()(p,["bucket"],"").length>0,k=!c()(p)&&!N,S=st(l,e9()(j,{table:"objects"})),E=i()(eo()(S,{name:"Ungrouped"}),["policies"],[]),A=e9()(j,{table:"buckets"}),C=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";o({}),h({bucket:e,table:t})},T=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";h({bucket:t,table:s}),o(e)},P=()=>{h({})},I=e=>u(e),R=async()=>{_.oR.success("Successfully saved policy!"),await y(),P()},L=async t=>e?await Promise.all(t.map(async t=>{try{return await b({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString,payload:t}),!1}catch(e){return _.oR.error("Error adding policy: ".concat(e.message)),!0}})):(console.error("Project is required"),!0),M=async t=>{if(!e)return console.error("Project is required"),!0;try{return await b({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString,payload:t}),!1}catch(e){return _.oR.error("Error adding policy: ".concat(e.message)),!0}},D=async t=>{if(!e)return console.error("Project is required"),!0;try{return await v({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString,originalPolicy:r,payload:t}),!1}catch(e){return _.oR.error("Error updating policy: ".concat(e.message)),!0}},z=async()=>{if(!e)return console.error("Project is required");w({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString,originalPolicy:d})};return(0,a.jsxs)("div",{className:"flex min-h-full w-full flex-col","data-sentry-component":"StoragePolicies","data-sentry-source-file":"StoragePolicies.tsx",children:[(0,a.jsx)("h3",{className:"text-xl",children:"Storage policies"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-foreground-light",children:"Safeguard your files with policies that define the operations allowed for your users at the bucket level."}),n||g?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsx)(eu.A,{className:"animate-spin",size:16})}):(0,a.jsxs)("div",{className:"mt-4 space-y-4",children:[0===l.length&&(0,a.jsx)(sC,{}),l.map(e=>{let t=i()(eo()(S,{name:e.name}),["policies"],[]).sort((e,t)=>e.name.localeCompare(t.name));return(0,a.jsx)(sf,{table:"objects",label:e.name,bucket:e,policies:t,onSelectPolicyAdd:C,onSelectPolicyEdit:T,onSelectPolicyDelete:I},e.name)}),(0,a.jsx)("div",{className:"!mb-4 w-full border-b border-muted"}),(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"You may also write policies for the tables under the storage schema directly for greater control"}),(0,a.jsx)(sf,{table:"objects",label:"Other policies under storage.objects",policies:E,onSelectPolicyAdd:C,onSelectPolicyEdit:T,onSelectPolicyDelete:I}),(0,a.jsx)(sf,{table:"buckets",label:"Policies under storage.buckets",policies:A,onSelectPolicyAdd:C,onSelectPolicyEdit:T,onSelectPolicyDelete:I})]}),(0,a.jsx)(sA,{visible:N,bucketName:p.bucket,onSelectCancel:P,onCreatePolicies:L,onSaveSuccess:R,"data-sentry-element":"StoragePoliciesEditPolicyModal","data-sentry-source-file":"StoragePolicies.tsx"}),(0,a.jsx)(t$,{schema:"storage",visible:k,table:p.table,selectedPolicyToEdit:r,onSelectCancel:P,onCreatePolicy:M,onUpdatePolicy:D,onSaveSuccess:R,"data-sentry-element":"PolicyEditorModal","data-sentry-source-file":"StoragePolicies.tsx"}),(0,a.jsx)(t6.A,{danger:!0,visible:!c()(d),title:"Confirm to delete policy",description:'This is permanent! Are you sure you want to delete the policy "'.concat(d.name,'"'),buttonLabel:"Delete",buttonLoadingLabel:"Deleting",onSelectCancel:()=>u({}),onSelectConfirm:z,"data-sentry-element":"ConfirmModal","data-sentry-source-file":"StoragePolicies.tsx"})]})};var sT=s(32981),sP=s(87494),sI=s(10663),sR=s(63324),sL=s(12578),sM=s(98969),sD=s(61957),sz=s(78154),sF=s(23385),sO=s(47452),sB=s(93210),sW=s(40990),sU=s(13874),sG=s(73934),sq=s(54498);let sV=()=>{let{ref:e}=(0,x.g)(),t=(0,V.SE)(q.aG.STORAGE_ADMIN_READ,"*"),s=(0,V.SE)(q.aG.STORAGE_ADMIN_WRITE,"*"),{data:n,error:l,isLoading:r,isSuccess:i,isError:o}=(0,p.I)({projectRef:e}),{data:c}=(0,sF.s)(),d=(null==c?void 0:c.plan.id)==="free",u=(null==c?void 0:c.plan.id)==="pro"&&(null==c?void 0:c.usage_billing_enabled)===!1,[h,f]=(0,m.useState)({fileSizeLimit:0,unit:sG.s2.BYTES,imageTransformationEnabled:!d});(0,m.useEffect)(()=>{if(i&&n){var e,t;let{fileSizeLimit:s,features:a}=n,{value:l,unit:r}=(0,sq.Jb)(null!=s?s:0),i=null!=(t=null==a||null==(e=a.imageTransformation)?void 0:e.enabled)?t:!d;f({fileSizeLimit:l,unit:r,imageTransformationEnabled:i}),j.reset({fileSizeLimit:l,unit:r,imageTransformationEnabled:i})}},[i,n]);let y=(0,m.useMemo)(()=>(null==c?void 0:c.plan.id)==="free"?sG.Js:(null==c?void 0:c.usage_billing_enabled)?sG.rB:sG.GF,[c]);new Intl.NumberFormat("en-US").format(y);let g=sI.Ik({fileSizeLimit:sI.au.number(),unit:sI.fc(sG.s2),imageTransformationEnabled:sI.zM()}).superRefine((e,t)=>{let{unit:s,fileSizeLimit:a}=e,{value:n}=(0,sq.Jb)(y,s);a>n&&t.addIssue({code:sR.eq.custom,message:"Maximum limit is up to ".concat(n.toLocaleString()," ").concat(s,"."),path:["fileSizeLimit"]})}),j=(0,sP.mN)({resolver:(0,sT.u)(g),defaultValues:h}),{fileSizeLimit:b,unit:v}=j.watch(),{mutate:w,isLoading:N}=(0,sz.b)({onSuccess:()=>{_.oR.success("Successfully updated storage settings")}}),k=async t=>e?n?void w({projectRef:e,fileSizeLimit:(0,sq.OG)(t.fileSizeLimit,t.unit),features:{imageTransformation:{enabled:t.imageTransformationEnabled},s3Protocol:{enabled:n.features.s3Protocol.enabled}}}):console.error("Storage config is required"):console.error("Project ref is required");return t?(0,a.jsxs)(sO.lV,{...j,"data-sentry-element":"Form_Shadcn_","data-sentry-component":"StorageSettings","data-sentry-source-file":"StorageSettings.tsx",children:[r&&(0,a.jsx)(en.y,{}),o&&(0,a.jsx)(th.A,{error:l,subject:"Failed to retrieve project's storage configuration"}),i&&(0,a.jsx)("form",{id:"storage-settings-form",className:"",onSubmit:j.handleSubmit(k),children:(0,a.jsxs)("div",{className:"bg-surface-100  overflow-hidden border-muted rounded-md border shadow",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-0 divide-y divide-border",children:[(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-6 px-8 py-8 lg:gap-12",children:[(0,a.jsx)("div",{className:"relative flex flex-col col-span-12 gap-6 lg:col-span-4",children:(0,a.jsx)("p",{className:"text-sm",children:"Upload file size limit"})}),(0,a.jsxs)("div",{className:"relative flex flex-col col-span-12 gap-x-6 gap-y-2 lg:col-span-8",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"flex-grow",children:(0,a.jsx)(sO.zB,{control:j.control,name:"fileSizeLimit",render:e=>{let{field:t}=e;return(0,a.jsxs)(sO.eI,{children:[(0,a.jsx)(sO.lR,{className:"text-foreground-light hidden",children:"size"}),(0,a.jsx)(sO.MJ,{className:"col-span-8",children:(0,a.jsx)(sB.p,{type:"number",...t,className:"w-full",disabled:d||!s})}),(0,a.jsx)(sO.C5,{className:"col-start-5 col-span-8"})]})}})}),(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(sO.zB,{control:j.control,name:"unit",render:e=>{let{field:t}=e;return(0,a.jsxs)(sO.eI,{children:[(0,a.jsx)(sO.lR,{className:"hidden",children:"Unit"}),(0,a.jsx)(sO.MJ,{className:"col-span-8",children:(0,a.jsxs)(sW.l6,{value:t.value,onValueChange:t.onChange,disabled:d||!s,children:[(0,a.jsx)(sW.bq,{className:"w-[180px]",children:(0,a.jsx)(sW.yv,{placeholder:"Choose a prefix",children:v})}),(0,a.jsx)(sW.gC,{children:Object.values(sG.s2).map(e=>(0,a.jsx)(sW.eb,{disabled:d,value:e,children:e},e))})]})}),(0,a.jsx)(sO.C5,{})]})}})})]}),(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:[v!==sG.s2.BYTES&&"Equivalent to ".concat((0,sq.OG)(b,v).toLocaleString()," bytes. "),"Maximum upload file size is ",(0,el.z3)(y),"."]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-6 px-8 py-8 lg:gap-12",children:[(0,a.jsx)("div",{className:"relative flex flex-col col-span-12 gap-6 lg:col-span-4",children:(0,a.jsx)("p",{className:"text-sm",children:"Enable Image Transformation"})}),(0,a.jsxs)("div",{className:"relative flex flex-col col-span-12 gap-x-6 gap-y-2 lg:col-span-8",children:[(0,a.jsx)("div",{className:"grid grid-cols-12 col-span-12 gap-2 items-center",children:(0,a.jsx)(sO.zB,{control:j.control,name:"imageTransformationEnabled",render:e=>{let{field:t}=e;return(0,a.jsx)(sU.d,{size:"large",disabled:d,checked:t.value,onCheckedChange:t.onChange})}})}),(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["Optimize and resize images on the fly."," ",(0,a.jsx)(sL.g,{href:"https://supabase.com/docs/guides/storage/serving/image-transformations",children:"Learn more"}),"."]})]})]})]}),d&&(0,a.jsx)("div",{className:"px-6 pb-6",children:(0,a.jsx)(sD.A,{primaryText:"Free Plan has a fixed upload file size limit of 50 MB.",secondaryText:"Upgrade to Pro Plan for a configurable upload file size limit of ".concat((0,el.z3)(sG.rB)," and unlock image transformations."),source:"storageSizeLimit"})}),u&&(0,a.jsx)("div",{className:"px-6 pb-6",children:(0,a.jsx)(sD.A,{buttonText:"Disable Spend Cap",primaryText:"Reduced max upload file size limit due to Spend Cap",secondaryText:"Disable your Spend Cap to allow file uploads of up to ".concat((0,el.z3)(sG.rB),"."),source:"storageSizeLimit"})}),(0,a.jsx)("div",{className:"border-t border-overlay"}),(0,a.jsx)("div",{className:"flex justify-between px-8 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between w-full gap-2",children:[s?(0,a.jsx)("div",{}):(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"You need additional permissions to update storage settings"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(C.$,{type:"default",htmlType:"reset",onClick:()=>j.reset(),disabled:!j.formState.isDirty||!s||N,children:"Cancel"}),(0,a.jsx)(C.$,{type:"primary",htmlType:"submit",loading:N,disabled:!j.formState.isDirty||!s||N,children:"Save"})]})]})})]})})]}):(0,a.jsx)(sM.A,{resourceText:"view storage upload limit settings"})};var sH=s(24400),s$=s(33793);async function sY(e){let{projectRef:t,id:s,type:a}=e;if(!t)throw Error("projectRef is required");if(!s)throw Error("Bucket name is requried");if("ANALYTICS"!==a){let{error:e}=await (0,L.bE)("/platform/storage/{ref}/buckets/{id}/empty",{params:{path:{ref:t,id:s}}});e&&(0,L.H4)(e)}let{data:n,error:l}=await (0,L.yH)("/platform/storage/{ref}/buckets/{id}",{params:{path:{ref:t,id:s},query:{type:a}}});return l&&(0,L.H4)(l),n}let sJ=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,tQ.jE)();return(0,tK.n)(e=>sY(e),{async onSuccess(t,s,n){let{projectRef:l}=s;await a.invalidateQueries(s$.w.buckets(l)),await (null==e?void 0:e(t,s,n))},async onError(e,s,a){void 0===t?_.oR.error("Failed to delete bucket: ".concat(e.message)):t(e,s,a)},...s})};var sQ=s(20168);let sK=e=>{var t;let{visible:s=!1,bucket:n,onClose:l}=e,r=(0,sH.useRouter)(),{ref:o}=(0,x.g)(),{data:c}=(0,ty.YA)(),{data:d}=(0,t3.p)({projectRef:o}),{data:u}=(0,tY.j)({projectRef:null==c?void 0:c.ref,connectionString:null==c?void 0:c.connectionString,schema:"storage"}),{mutateAsync:m}=(0,t2.f)(),{mutate:p,isLoading:h}=sJ({onSuccess:async()=>{if(!c)return console.error("Project is required");let e=st(f,(null!=u?u:[]).filter(e=>"objects"===e.table)),t=i()(eo()(e,{name:n.name}),["policies"],[]);try{await Promise.all(t.map(e=>m({projectRef:null==c?void 0:c.ref,connectionString:null==c?void 0:c.connectionString,originalPolicy:e}))),_.oR.success("Successfully deleted bucket ".concat(null==n?void 0:n.name)),r.push("/project/".concat(o,"/storage/buckets")),l()}catch(e){_.oR.success("Successfully deleted bucket ".concat(null==n?void 0:n.name,". However, there was a problem deleting the policies tied to the bucket. Please review them in the storage policies section"))}}}),f=null!=d?d:[],y=async()=>o?n?void p({projectRef:o,id:n.id,type:n.type}):console.error("No bucket is selected"):console.error("Project ref is required");return(0,a.jsx)(sQ.A,{variant:"destructive",visible:s,title:"Confirm deletion of ".concat(null==n?void 0:n.name),confirmPlaceholder:"Type in name of bucket",onConfirm:y,onCancel:l,confirmString:null!=(t=null==n?void 0:n.name)?t:"",loading:h,text:(0,a.jsxs)(a.Fragment,{children:["Your bucket ",(0,a.jsx)("span",{className:"font-bold text-foreground",children:null==n?void 0:n.name})," and all its contents will be permanently deleted."]}),alert:{title:"You cannot recover this bucket once deleted.",description:"All bucket data will be lost."},confirmLabel:"Delete bucket","data-sentry-element":"TextConfirmModal","data-sentry-component":"DeleteBucketModal","data-sentry-source-file":"DeleteBucketModal.tsx"})}},39719:(e,t,s)=>{s.d(t,{S:()=>c});var a=s(32144),n=s(80251),l=s(73969),r=s(65172),i=s(49009);let o=async e=>{let{description:t,projectRef:s}=e;if(!s)throw Error("projectRef is required");let{data:a,error:n}=await (0,r.bE)("/platform/storage/{ref}/credentials",{params:{path:{ref:s}},body:{description:t}});return n&&(0,r.H4)(n),a};function c(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,a.jE)();return(0,n.n)(e=>o(e),{async onSuccess(t,s,a){let{projectRef:n}=s;await r.invalidateQueries(i.A.credentials(n)),await (null==e?void 0:e(t,s,a))},async onError(e,s,a){void 0===t?l.oR.error("Failed to create S3 access key: ".concat(e.message)):t(e,s,a)},...s})}},43242:(e,t,s)=>{s.d(t,{Ay:()=>x});var a=s(80263),n=s(53239),l=s(70800),r=s(51500),i=s(24771);function o(e){let{children:t,className:s,tag:n="div",style:l}=e;return(0,a.jsx)("".concat(n),{style:l,"data-sentry-element":"CustomTag","data-sentry-component":"Typography","data-sentry-source-file":"Typography.tsx",children:t})}o.Title=function(e){let{className:t,level:s=1,children:n,style:l}=e;return(0,a.jsx)("h".concat(s),{style:l,"data-sentry-element":"CustomTag","data-sentry-component":"Title","data-sentry-source-file":"Title.tsx",children:n})},o.Text=function(e){let{className:t,children:s,style:n,type:l,disabled:r,mark:i,code:o,keyboard:c,underline:d,strikethrough:u,strong:m,small:x}=e;return o?(0,a.jsx)("code",{style:n,children:s}):i?(0,a.jsx)("mark",{style:n,children:s}):c?(0,a.jsx)("kbd",{style:n,children:s}):m?(0,a.jsx)("strong",{style:n,children:s}):(0,a.jsx)("span",{style:n,"data-sentry-component":"Text","data-sentry-source-file":"Text.tsx",children:s})},o.Link=i.A;let c=(0,n.createContext)({type:"text"}),d=e=>{let{type:t}=e;return(0,a.jsx)(c.Provider,{value:{type:t},"data-sentry-element":"unknown","data-sentry-component":"MenuContextProvider","data-sentry-source-file":"MenuContext.tsx",children:e.children})},u=()=>{let e=(0,n.useContext)(c);if(void 0===e)throw Error("MenuContext must be used within a MenuContextProvider.");return e};function m(e){let{children:t,className:s,ulClassName:n,style:l,type:r="text"}=e;return(0,a.jsx)("nav",{role:"menu","aria-label":"Sidebar","aria-orientation":"vertical","aria-labelledby":"options-menu",className:s,style:l,"data-sentry-component":"Menu","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)(d,{type:r,"data-sentry-element":"MenuContextProvider","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)("ul",{className:n,children:t})})})}m.Item=function(e){let{children:t,icon:s,active:n,rounded:i,onClick:o,doNotCloseOverlay:c=!1,showActiveBar:d=!1,style:m}=e,x=(0,l.A)("menu"),{type:p}=u(),h=[x.item.base];h.push(x.item.variants[p].base),n?h.push(x.item.variants[p].active):h.push(x.item.variants[p].normal);let f=[x.item.content.base];n?f.push(x.item.content.active):f.push(x.item.content.normal);let y=[x.item.icon.base];return n?y.push(x.item.icon.active):y.push(x.item.icon.normal),(0,a.jsxs)("li",{role:"menuitem",className:(0,r.cn)("outline-none",h),style:m,onClick:o,"aria-current":n?"page":void 0,"data-sentry-component":"Item","data-sentry-source-file":"Menu.tsx",children:[s&&(0,a.jsx)("div",{className:"".concat(y.join(" ")," min-w-fit"),children:s}),(0,a.jsx)("span",{className:f.join(" "),children:t})]})},m.Group=function(e){let{children:t,icon:s,title:n}=e,r=(0,l.A)("menu"),{type:i}=u();return(0,a.jsxs)("div",{className:[r.group.base,r.group.variants[i]].join(" "),"data-sentry-component":"Group","data-sentry-source-file":"Menu.tsx",children:[s&&(0,a.jsx)("span",{className:r.group.icon,children:s}),(0,a.jsx)("span",{className:r.group.content,children:n}),t]})},m.Misc=function(e){let{children:t}=e;return(0,a.jsx)("div",{"data-sentry-component":"Misc","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)(o.Text,{"data-sentry-element":"unknown","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)("span",{children:t})})})};let x=m},44326:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(80263),n=s(53239),l=s(67120),r=s(27642),i=s(40022);let o=e=>{let{visible:t=!1,danger:s=!1,title:o="",description:c="",size:d="small",buttonLabel:u="",buttonLoadingLabel:m="",onSelectCancel:x=()=>{},onSelectConfirm:p=()=>{}}=e;(0,n.useEffect)(()=>{t&&f(!1)},[t]);let[h,f]=(0,n.useState)(!1),y=()=>{f(!0),p()};return(0,a.jsx)(l.A,{header:o,visible:t,title:o,description:c,size:d,hideFooter:!0,onCancel:x,"data-sentry-element":"Modal","data-sentry-component":"ConfirmModal","data-sentry-source-file":"ConfirmDialog.tsx",children:(0,a.jsx)(r.A,{initialValues:{},validateOnBlur:!0,onSubmit:()=>y(),validate:()=>[],"data-sentry-element":"Form","data-sentry-source-file":"ConfirmDialog.tsx",children:()=>(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(l.A.Content,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.$,{block:!0,htmlType:"button",type:"default",onClick:x,disabled:h,children:"Cancel"}),(0,a.jsx)(i.$,{htmlType:"submit",block:!0,type:s?"danger":"primary",disabled:h,loading:h,children:m&&h?m:u||"Confirm"})]})})})})})}},47221:(e,t,s)=>{s.d(t,{Z:()=>p});var a=s(60045),n=s(52793),l=s.n(n),r=s(23229),i=s(54498),o=s(76291),c=s(67575),d=s(66427),u=s(75019),m=s(5483),x=s(39719);let p=()=>{var e,t,s,n,p,h;let{data:f}=(0,m.YA)(),{data:y}=(0,o.I)({projectRef:null==f?void 0:f.ref,reveal:!0}),{secretKey:g,serviceKey:j}=(0,o.x)(y),{data:b}=(0,c.G)({projectRef:null==f?void 0:f.ref}),v=null!=(n=null==b||null==(e=b.app_config)?void 0:e.protocol)?n:"https",w=(null==b||null==(t=b.app_config)?void 0:t.storage_endpoint)||(null==b||null==(s=b.app_config)?void 0:s.endpoint),N=null!=(h=null!=(p=null==g?void 0:g.api_key)?p:null==j?void 0:j.api_key)?h:"SUPABASE_CLIENT_API_KEY",k=r.V.find(e=>"iceberg_wrapper"===e.name),S=(0,u.SE)(a.aG.STORAGE_ADMIN_WRITE,"*"),{mutateAsync:E,isLoading:A}=(0,x.S)(),{mutateAsync:C,isLoading:_}=(0,d.m_)();return{mutateAsync:async e=>{var t,s;let{bucketName:a}=e,n=await E({projectRef:null==f?void 0:f.ref,description:"".concat(l()(a),"_keys")}),r="".concat(l()(a),"_fdw"),o={projectRef:null==f?void 0:f.ref,connectionString:null==f?void 0:f.connectionString,wrapperMeta:k,formState:{wrapper_name:r,server_name:"".concat(r,"_server"),vault_aws_access_key_id:null==n?void 0:n.access_key,vault_aws_secret_access_key:null==n?void 0:n.secret_key,vault_token:N,warehouse:a,"s3.endpoint":(0,i.yO)(null!=(t=null==f?void 0:f.ref)?t:"",v,w),catalog_uri:(0,i.Uj)(null!=(s=null==f?void 0:f.ref)?s:"",v,w)},mode:"skip",tables:[],sourceSchema:"",targetSchema:""};await C(o)},isLoading:_||A,hasPermission:S}}},48114:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(80263),n=s(72852),l=s(37411),r=s(40022);let i=e=>{let{section:t}=e,s=(0,l.qM)();return(0,a.jsx)(r.$,{size:"tiny",type:"default",onClick:()=>{t&&s.setActiveDocsSection(t),s.setShowProjectApiDocs(!0)},icon:(0,a.jsx)(n.A,{strokeWidth:1.5,className:"text-foreground-muted"}),"data-sentry-element":"Button","data-sentry-component":"APIDocsButton","data-sentry-source-file":"APIDocsButton.tsx",children:"API Docs"})}},48700:(e,t,s)=>{s.d(t,{V:()=>d});var a=s(47319),n=s(32144),l=s(80251),r=s(73969),i=s(15629),o=s(30784);async function c(e){let{projectRef:t,connectionString:s,originalPolicy:n,payload:l}=e,r=new Headers;s&&r.set("x-connection-encrypted",s);let{sql:o}=a.A.policies.update(n,l),{result:c}=await (0,i.E)({projectRef:t,connectionString:s,sql:o,queryKey:["policy","update",n.id]});return c}let d=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,n.jE)();return(0,l.n)(e=>c(e),{async onSuccess(t,s,n){let{projectRef:l}=s;await a.invalidateQueries(o.S.list(l)),await (null==e?void 0:e(t,s,n))},async onError(e,s,a){void 0===t?r.oR.error("Failed to update database policy: ".concat(e.message)):t(e,s,a)},...s})}},49009:(e,t,s)=>{s.d(t,{A:()=>a});let a={credentials:e=>["projects",e,"storage-credentials"]}},58174:(e,t,s)=>{s.d(t,{Fg:()=>a,QY:()=>n,mV:()=>l});let a=["anon","service_role","authenticated","authenticator","dashboard_user","supabase_admin","supabase_auth_admin","supabase_functions_admin","supabase_read_only_user","supabase_realtime_admin","supabase_replication_admin","supabase_storage_admin","pgbouncer","pgsodium_keyholder","pgsodium_keyiduser","pgsodium_keymaker","pgtle_admin"],n=["postgres","pgbouncer","supabase_admin","supabase_auth_admin","supabase_storage_admin","dashboard_user","authenticator","pg_database_owner","pg_read_all_data","pg_write_all_data"],l={canLogin:{disabled:!1,description:"User can login",grant_by_dashboard:!0},canCreateRole:{disabled:!1,description:"User can create roles",grant_by_dashboard:!0},canCreateDb:{disabled:!1,description:"User can create databases",grant_by_dashboard:!0},canBypassRls:{disabled:!1,description:"User bypasses every row level security policy",grant_by_dashboard:!0},isSuperuser:{disabled:!0,description:"User is a Superuser",grant_by_dashboard:!1},isReplicationRole:{disabled:!1,description:"User can initiate streaming replication and put the system in and out of backup mode",grant_by_dashboard:!0}}},59024:(e,t,s)=>{s.d(t,{A:()=>c});var a=s(80263),n=s(14360),l=s(83927),r=s.n(l),i=s(53239),o=s(34487);let c=e=>{let{queryId:t,language:s="pgsql",defaultValue:l="",readOnly:c=!1,contextmenu:d=!0,onInputChange:u=r()}=e,m=(0,n.useMonaco)(),x=(0,i.useRef)();return(0,i.useEffect)(()=>{if(m){let e=m.languages.registerDocumentFormattingEditProvider("pgsql",{async provideDocumentFormattingEdits(e){let t=e.getValue(),s=(0,o.A)(t);return[{range:e.getFullModelRange(),text:s}]}});return()=>{e.dispose()}}},[m]),(0,i.useEffect)(()=>{if(x.current){var e;null==(e=x.current)||e.changeViewZones(e=>{e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})})}},[t]),(0,a.jsx)(n.default,{className:"monaco-editor",theme:"supabase",defaultLanguage:s,defaultValue:l,path:t,loading:(0,a.jsx)(()=>(0,a.jsx)("h4",{className:"text-lg","data-sentry-component":"Loading","data-sentry-source-file":"SqlEditor.tsx",children:"Loading"}),{}),options:{readOnly:c,tabSize:2,fontSize:13,minimap:{enabled:!1},wordWrap:"on",fixedOverflowWidgets:!0,contextmenu:d},onMount:(e,t)=>{x.current=e,e.changeViewZones(e=>{e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})})},onChange:u,"data-sentry-element":"Editor","data-sentry-component":"SqlEditor","data-sentry-source-file":"SqlEditor.tsx"})}},60680:(e,t,s)=>{s.d(t,{Ay:()=>i});var a=s(80263),n=s(90709);s(53239);var l=s(70800);let r=e=>{let{open:t,children:s,className:l,...r}=e;return(0,a.jsx)(n.bL,{asChild:r.asChild,defaultOpen:r.defaultOpen,open:t,onOpenChange:r.onOpenChange,disabled:r.disabled,className:l,"data-sentry-element":"unknown","data-sentry-component":"Collapsible","data-sentry-source-file":"Collapsible.tsx",children:s})};r.Trigger=function(e){let{children:t,asChild:s}=e;return(0,a.jsx)(n.l9,{asChild:s,"data-sentry-element":"unknown","data-sentry-component":"Trigger","data-sentry-source-file":"Collapsible.tsx",children:t})},r.Content=function(e){let{asChild:t,children:s,className:r}=e,i=(0,l.A)("collapsible");return(0,a.jsx)(n.UC,{asChild:t,className:[i.content,r].join(" "),"data-sentry-element":"unknown","data-sentry-component":"Content","data-sentry-source-file":"Collapsible.tsx",children:s})};let i=r},72192:(e,t,s)=>{s.d(t,{tV:()=>d,_X:()=>c});var a=s(47319),n=s(56947),l=s(15629);let r={databaseRoles:e=>["projects",e,"database-roles"]},i=a.A.roles.list();async function o(e,t){let{projectRef:s,connectionString:a}=e,{result:n}=await (0,l.E)({projectRef:s,connectionString:a,sql:i.sql,queryKey:["database-roles"]},t);return n}let c=function(e){let{projectRef:t,connectionString:s}=e,{enabled:a=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.I)(r.databaseRoles(t),e=>{let{signal:a}=e;return o({projectRef:t,connectionString:s},a)},{enabled:a&&void 0!==t,...l})};function d(e,t){return e.invalidateQueries(r.databaseRoles(t))}},77569:(e,t,s)=>{s.d(t,{o:()=>E});var a=s(80263),n=s(24863),l=s(85563),r=s(5010),i=s(36975),o=s(59350),c=s(49434),d=s.n(c),u=s(16426),m=s.n(u),x=s(90437),p=s(63492),h=s(51500),f=s(15601),y=s.n(f),g=s(5483),j=s(40022),b=s(47142);let v=e=>{let{minimumVersion:t="15.6"}=e,{data:s}=(0,g.YA)();return(0,a.jsxs)(b.Z,{type:"warning",className:"mt-4",title:"Database upgrade needed",childProps:{description:{className:"flex flex-col gap-y-2"}},"data-sentry-element":"Admonition","data-sentry-component":"UpgradeDatabaseAlert","data-sentry-source-file":"UpgradeDatabaseAlert.tsx",children:[(0,a.jsx)("div",{className:"prose text-sm max-w-full",children:(0,a.jsxs)("p",{children:["This integration requires the ",(0,a.jsx)("code",{children:"pgmq"})," extension which is not available on this version of Postgres. The extension is available on version ",t," and higher."]})}),(0,a.jsx)(j.$,{color:"primary",className:"w-fit","data-sentry-element":"Button","data-sentry-source-file":"UpgradeDatabaseAlert.tsx",children:(0,a.jsx)(y(),{href:"/project/".concat(null==s?void 0:s.ref,"/settings/infrastructure"),"data-sentry-element":"Link","data-sentry-source-file":"UpgradeDatabaseAlert.tsx",children:"Upgrade database"})})]})};var w=s(23229);let N=()=>(0,a.jsx)("div",{className:"p-10","data-sentry-component":"Loading","data-sentry-source-file":"Integrations.constants.tsx",children:(0,a.jsx)(x.y,{"data-sentry-element":"GenericSkeletonLoader","data-sentry-source-file":"Integrations.constants.tsx"})}),k={name:"Supabase",websiteUrl:"https://supabase.com"},S=[{id:"queues",type:"postgres_extension",requiredExtensions:["pgmq"],missingExtensionsAlert:(0,a.jsx)(v,{minimumVersion:"15.6.1.143"}),name:"Queues",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.jsx)(n.A,{className:(0,h.cn)("inset-0 p-2 text-black w-full h-full",e),...t})},description:"Lightweight message queue in Postgres",docsUrl:"https://github.com/tembo-io/pgmq",author:{name:"pgmq",websiteUrl:"https://github.com/tembo-io/pgmq"},navigation:[{route:"overview",label:"Overview"},{route:"queues",label:"Queues",hasChild:!0,childIcon:(0,a.jsx)(n.A,{size:12,strokeWidth:1.5,className:(0,h.cn)("text-foreground w-full h-full")})},{route:"settings",label:"Settings"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview",a=arguments.length>2?arguments[2]:void 0;if(a)return d()(()=>Promise.all([s.e(4986),s.e(89),s.e(726),s.e(3730),s.e(7494),s.e(9014),s.e(4024),s.e(7795),s.e(1680),s.e(4444),s.e(6692),s.e(6616),s.e(7957),s.e(1444),s.e(5651),s.e(5390)]).then(s.bind(s,65540)).then(e=>e.QueueTab),{loadableGenerated:{webpack:()=>[65540]},loading:N});switch(t){case"overview":return d()(()=>Promise.all([s.e(726),s.e(6616),s.e(2621),s.e(1793)]).then(s.bind(s,37138)).then(e=>e.QueuesOverviewTab),{loadableGenerated:{webpack:()=>[37138]},loading:N});case"queues":return d()(()=>Promise.all([s.e(7494),s.e(6616),s.e(3386)]).then(s.bind(s,53386)).then(e=>e.QueuesTab),{loadableGenerated:{webpack:()=>[53386]},loading:N});case"settings":return d()(()=>Promise.all([s.e(7494),s.e(6616),s.e(7119)]).then(s.bind(s,47119)).then(e=>e.QueuesSettings),{loadableGenerated:{webpack:()=>[47119]},loading:N})}return null}},{id:"cron",type:"postgres_extension",requiredExtensions:["pg_cron"],name:"Cron",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.jsx)(l.A,{className:(0,h.cn)("inset-0 p-2 text-black w-full h-full",e),...t})},description:"Schedule recurring Jobs in Postgres.",docsUrl:"https://github.com/citusdata/pg_cron",author:{name:"Citus Data",websiteUrl:"https://github.com/citusdata/pg_cron"},navigation:[{route:"overview",label:"Overview"},{route:"jobs",label:"Jobs",hasChild:!0,childIcon:(0,a.jsx)(r.A,{size:12,strokeWidth:1.5,className:(0,h.cn)("text-foreground w-full h-full")})}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview",a=arguments.length>2?arguments[2]:void 0;if(a)return d()(()=>Promise.all([s.e(8199),s.e(726),s.e(9014),s.e(319),s.e(3742),s.e(1715),s.e(7104),s.e(8344)]).then(s.bind(s,18344)).then(e=>e.PreviousRunsTab),{loadableGenerated:{webpack:()=>[18344]},loading:N});switch(t){case"overview":return d()(()=>Promise.all([s.e(726),s.e(2621),s.e(6631)]).then(s.bind(s,68316)).then(e=>e.IntegrationOverviewTab),{loadableGenerated:{webpack:()=>[68316]},loading:N});case"jobs":return d()(()=>Promise.all([s.e(4986),s.e(89),s.e(8199),s.e(726),s.e(3730),s.e(7494),s.e(9014),s.e(4024),s.e(7795),s.e(3742),s.e(6359),s.e(1715),s.e(2621),s.e(7104),s.e(7246)]).then(s.bind(s,24344)).then(e=>e.CronjobsTab),{loadableGenerated:{webpack:()=>[24344]},loading:N})}return null}},{id:"vault",type:"postgres_extension",requiredExtensions:["supabase_vault"],missingExtensionsAlert:(0,a.jsx)(v,{}),name:"Vault",status:"alpha",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.jsx)(i.A,{className:(0,h.cn)("inset-0 p-2 text-black w-full h-full",e),...t})},description:"Application level encryption for your project",docsUrl:"https://supabase.com/docs",author:k,navigation:[{route:"overview",label:"Overview"},{route:"secrets",label:"Secrets"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview";switch(arguments.length>2&&arguments[2],t){case"overview":return d()(()=>Promise.all([s.e(726),s.e(2621),s.e(6631)]).then(s.bind(s,68316)).then(e=>e.IntegrationOverviewTab),{loadableGenerated:{webpack:()=>[68316]},loading:N});case"secrets":return d()(()=>Promise.all([s.e(726),s.e(7494),s.e(4024),s.e(849),s.e(4815)]).then(s.bind(s,30316)).then(e=>e.SecretsManagement),{loadableGenerated:{webpack:()=>[30316]},loading:N})}return null}},{id:"webhooks",type:"postgres_extension",name:"Database Webhooks",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.jsx)(o.A,{className:(0,h.cn)("inset-0 p-2 text-black w-full h-full",e),...t})},description:"Send real-time data from your database to another system when a table event occurs",docsUrl:"https://supabase.com/docs",author:k,requiredExtensions:[],navigation:[{route:"overview",label:"Overview"},{route:"webhooks",label:"Webhooks"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview";switch(arguments.length>2&&arguments[2],t){case"overview":return d()(()=>Promise.all([s.e(726),s.e(2621),s.e(4039)]).then(s.bind(s,940)).then(e=>e.WebhooksOverviewTab),{loadableGenerated:{webpack:()=>[940]},loading:N});case"webhooks":return d()(()=>Promise.all([s.e(726),s.e(4280),s.e(7494),s.e(6616),s.e(849),s.e(9434)]).then(s.bind(s,59434)).then(e=>e.WebhooksListTab),{loadableGenerated:{webpack:()=>[59434]},loading:N})}return null}},{id:"graphiql",type:"postgres_extension",requiredExtensions:["pg_graphql"],name:"GraphQL",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.jsx)(m(),{fill:!0,src:"".concat(p.o2,"/img/graphql.svg"),alt:"GraphiQL",className:(0,h.cn)("p-2",e),...t})},description:"Run GraphQL queries through our interactive in-browser IDE",docsUrl:"https://supabase.com/docs",author:k,navigation:[{route:"overview",label:"Overview"},{route:"graphiql",label:"GraphiQL"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview";switch(arguments.length>2&&arguments[2],t){case"overview":return d()(()=>Promise.all([s.e(726),s.e(2621),s.e(6631)]).then(s.bind(s,68316)).then(e=>e.IntegrationOverviewTab),{loadableGenerated:{webpack:()=>[68316]},loading:N});case"graphiql":return d()(()=>Promise.all([s.e(5708),s.e(4986),s.e(726),s.e(3730),s.e(9014),s.e(1680),s.e(6692),s.e(2067),s.e(1444),s.e(5957),s.e(2621),s.e(9459)]).then(s.bind(s,51044)).then(e=>e.GraphiQLTab),{loadableGenerated:{webpack:()=>[51044]},loading:N})}return null}}],E=[...w.V.map(e=>({id:e.name,type:"wrapper",name:"".concat(e.label," Wrapper"),icon:function(){let{className:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.jsx)(m(),{fill:!0,src:e.icon,alt:e.name,className:(0,h.cn)("p-2",t),...s})},requiredExtensions:["wrappers","supabase_vault"],description:e.description,docsUrl:e.docsUrl,meta:e,author:k,navigation:[{route:"overview",label:"Overview"},{route:"wrappers",label:"Wrappers"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview";switch(arguments.length>2&&arguments[2],t){case"overview":return d()(()=>Promise.all([s.e(4986),s.e(726),s.e(3730),s.e(2621),s.e(6333),s.e(8989)]).then(s.bind(s,79142)).then(e=>e.WrapperOverviewTab),{loadableGenerated:{webpack:()=>[79142]},loading:N});case"wrappers":return d()(()=>Promise.all([s.e(4986),s.e(726),s.e(3730),s.e(6333),s.e(5794)]).then(s.bind(s,57357)).then(e=>e.WrappersTab),{loadableGenerated:{webpack:()=>[57357]},loading:N})}return null}})),...S]},78154:(e,t,s)=>{s.d(t,{b:()=>c});var a=s(32144),n=s(80251),l=s(73969),r=s(65172),i=s(47114);async function o(e){let{projectRef:t,fileSizeLimit:s,features:a}=e,{data:n,error:l}=await (0,r.F6)("/platform/projects/{ref}/config/storage",{params:{path:{ref:t}},body:{fileSizeLimit:s,features:a}});return l&&(0,r.H4)(l),n}let c=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,a.jE)();return(0,n.n)(e=>o(e),{async onSuccess(t,s,a){let{projectRef:n}=s;await r.invalidateQueries(i.n.storage(n)),await (null==e?void 0:e(t,s,a))},async onError(e,s,a){void 0===t?l.oR.error("Failed to update storage settings: ".concat(e.message)):t(e,s,a)},...s})}},79467:(e,t,s)=>{s.d(t,{A:()=>d});var a=s(80263),n=s(53239),l=s(1848),r=s(70800),i=s(60115);let o=(0,n.createContext)({parentCallback:e=>{},type:"",name:"",activeId:"",parentSize:""});function c(e){var t;let{id:s=(t=46656*Math.random()|0,("00000"+(46656*Math.random()|0).toString(36)).slice(-3)+("00000"+t.toString(36)).slice(-3)),disabled:n,value:l,label:c,afterLabel:d,beforeLabel:u,description:m,name:x,checked:p,className:h,onChange:f,onBlur:y,hidden:g=!1,size:j="medium",align:b="vertical",optionalLabel:v,addOnBefore:w,children:N}=e,k=(0,r.A)("radio"),{handleBlur:S}=(0,i.x)();function E(e){S&&S(e),y&&y(e)}return(0,a.jsx)(o.Consumer,{"data-sentry-element":"unknown","data-sentry-component":"Radio","data-sentry-source-file":"Radio.tsx",children:e=>{let{parentCallback:t,type:r,name:i,activeId:o,parentSize:y}=e;j=y||j;let S=o===s||!!p||!1!==p&&void 0,A=[h,k.variants[r].container.base,"list"===r&&!g&&k.variants[r].container.size[j]];return A.push(k.variants[r].base),A.push(k.variants[r].size[j]),S?A.push(k.variants[r].active):A.push(k.variants[r].inactive),n&&A.push(k.disabled),"list"!==r&&(g=!0),(0,a.jsxs)("label",{htmlFor:s,className:A.join(" "),children:[(0,a.jsx)("input",{id:s,name:i||x,type:"radio",className:[k.base,k.size[j],g&&k.hidden,k.variants[r].radio_offset,""].join(" "),checked:S,disabled:n,value:l||s,onChange:e=>{t&&t(e),f&&f(e)},onBlur:E}),w,N||(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:[k.label.base,k.label[j],k.variants[r].container.align[b]].join(" "),children:[u&&(0,a.jsx)("div",{className:[k.label_before.base,k.label_before[j]].join(" "),children:u}),(0,a.jsx)("div",{children:c}),d&&(0,a.jsx)("div",{className:[k.label_after.base,k.label_after[j]].join(" "),children:d}),m&&(0,a.jsx)("div",{className:[k.description.base,k.description[j]].join(" "),children:m})]}),v&&(0,a.jsx)("div",{className:[k.optionalLabel.base,k.optionalLabel[j]].join(" "),children:v})]})]})}})}c.Group=function(e){let{id:t,layout:s,error:d,descriptionText:u,label:m,afterLabel:x,beforeLabel:p,labelOptional:h,children:f,className:y,type:g="list",options:j,value:b,name:v,onChange:w,size:N="medium",validation:k,groupClassName:S,labelsLayout:E="vertical"}=e,[A,C]=(0,n.useState)(""),_=(0,r.A)("radio"),{formContextOnChange:T,values:P,errors:I,touched:R,fieldLevelValidation:L}=(0,i.x)();return P&&!b&&(b=P[t||v]),d||(I&&!d&&(d=I[t||v]),d=R&&R[t||v]?d:void 0),(0,n.useEffect)(()=>{k&&L(t,k(b))},[]),(0,n.useEffect)(()=>{C(b)},[b]),(0,a.jsx)("fieldset",{name:v,className:y,"data-sentry-component":"RadioGroup","data-sentry-source-file":"Radio.tsx",children:(0,a.jsx)(l.H,{nonBoxInput:!0,label:m,afterLabel:x,beforeLabel:p,labelOptional:h,layout:s,id:t,error:d,descriptionText:u,size:N,labelLayout:E,"data-sentry-element":"FormLayout","data-sentry-source-file":"Radio.tsx",children:(0,a.jsx)("div",{className:S||_.variants[g].group,children:(0,a.jsx)(o.Provider,{value:{parentCallback:function(e){w&&w(e),T&&T(e),k&&L(t,k(e.target.value)),C(e.target.id)},type:g,name:v,activeId:A,parentSize:N},"data-sentry-element":"unknown","data-sentry-source-file":"Radio.tsx",children:j?j.map(e=>(0,a.jsx)(c,{id:e.id,label:e.label,beforeLabel:e.beforeLabel,afterLabel:e.afterLabel,value:e.value,description:e.description})):f})})})})};let d=c},80679:(e,t,s)=>{s.d(t,{A:()=>eA});var a=s(80263),n=s(60045),l=s(11192),r=s(15601),i=s.n(r),o=s(24400),c=s(53239),d=s(80535),u=s(37352),m=s(32981),x=s(52793),p=s.n(x),h=s(72259),f=s(87494),y=s(73969),g=s(19686),j=s(5588),b=s(73934),v=s(12578),w=s(85278),N=s(32144),k=s(80251),S=s(65172),E=s(33793);async function A(e){let{projectRef:t,id:s,type:a,isPublic:n,file_size_limit:l,allowed_mime_types:r}=e;if(!t)throw Error("projectRef is required");if(!s)throw Error("Bucket name is required");let i={id:s,type:a,public:n};"STANDARD"===a&&(l&&(i.file_size_limit=l),r&&(i.allowed_mime_types=r));let{data:o,error:c}=await (0,S.bE)("/platform/storage/{ref}/buckets",{params:{path:{ref:t}},body:i});return c&&(0,S.H4)(c),o}let C=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,N.jE)();return(0,k.n)(e=>A(e),{async onSuccess(t,s,n){let{projectRef:l}=s;await a.invalidateQueries(E.w.buckets(l)),await (null==e?void 0:e(t,s,n))},async onError(e,s,a){void 0===t?y.oR.error("Failed to create bucket: ".concat(e.message)):t(e,s,a)},...s})};var _=s(47221),T=s(57132),P=s(23385),I=s(63492),R=s(67120),L=s(47452),M=s(93210),D=s(4870),z=s(86254),F=s(37394),O=s(60680),B=s(51500),W=s(26860),U=s(19428),G=s(1012),q=s(40022),V=s(47142),H=s(61395),$=s(54498);let Y=g.Ay.object({name:g.Ay.string().trim().min(1,"Please provide a name for your bucket").regex(/^[a-z0-9.-]+$/,"The name of the bucket must only contain lowercase letters, numbers, dots, and hyphens").refine(e=>!e.endsWith(" "),"The name of the bucket cannot end with a whitespace").refine(e=>"public"!==e,'"public" is a reserved name. Please choose another name'),type:g.Ay.enum(["STANDARD","ANALYTICS"]).default("STANDARD"),public:g.Ay.boolean().default(!1),has_file_size_limit:g.Ay.boolean().default(!1),formatted_size_limit:g.Ay.coerce.number().min(0,"File size upload limit has to be at least 0").default(0),allowed_mime_types:g.Ay.string().trim().default("")}),J=e=>{var t,s,n;let{visible:l,onClose:r}=e,{ref:u}=(0,d.g)(),x=(0,o.useRouter)(),{data:g}=(0,P.s)(),{mutate:N}=(0,T.h)(),{mutateAsync:k,isLoading:S}=C({onError:()=>{}}),{mutateAsync:E,isLoading:A}=(0,_.Z)(),{data:J}=(0,w.I)({projectRef:u},{enabled:I.pe}),{value:Q,unit:K}=(0,$.Jb)(null!=(n=null==J?void 0:J.fileSizeLimit)?n:0),Z="".concat(Q," ").concat(K),[X,ee]=(0,c.useState)(b.s2.BYTES),[et,es]=(0,c.useState)(!1),ea=(0,f.mN)({resolver:(0,m.u)(Y),defaultValues:{name:"",public:!1,type:"STANDARD",has_file_size_limit:!1,formatted_size_limit:0,allowed_mime_types:""}}),en=p()(ea.watch("name")),el=ea.watch("public"),er="STANDARD"===ea.watch("type"),ei=ea.watch("has_file_size_limit"),eo=ea.watch("formatted_size_limit"),ec=(0,j.P)(),ed=async e=>{if(!u)return console.error("Project ref is required");if("ANALYTICS"===e.type&&!eu)return void y.oR.error("The Analytics catalog feature is not enabled for your project. Please contact support to enable it.");try{var t;let s=e.has_file_size_limit?(0,$.OG)(e.formatted_size_limit,X):void 0,a=e.allowed_mime_types.length>0?e.allowed_mime_types.split(",").map(e=>e.trim()):void 0;await k({projectRef:u,id:e.name,type:e.type,isPublic:e.public,file_size_limit:s,allowed_mime_types:a}),N({action:"storage_bucket_created",properties:{bucketType:e.type},groups:{project:null!=u?u:"Unknown",organization:null!=(t=null==g?void 0:g.slug)?t:"Unknown"}}),"ANALYTICS"===e.type&&"installed"===ec&&await E({bucketName:e.name}),y.oR.success("Successfully created bucket ".concat(e.name)),x.push("/project/".concat(u,"/storage/buckets/").concat(e.name)),r()}catch(e){y.oR.error("Failed to create bucket: ".concat(e.message))}};(0,c.useEffect)(()=>{l&&(ea.reset(),ee(b.s2.BYTES),es(!1))},[l,ea]);let eu=null==J||null==(s=J.features)||null==(t=s.icebergCatalog)?void 0:t.enabled;return(0,a.jsx)(R.A,{hideFooter:!0,visible:l,size:"medium",header:"Create storage bucket",onCancel:()=>r(),"data-sentry-element":"Modal","data-sentry-component":"CreateBucketModal","data-sentry-source-file":"CreateBucketModal.tsx",children:(0,a.jsx)(L.lV,{...ea,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreateBucketModal.tsx",children:(0,a.jsxs)("form",{onSubmit:ea.handleSubmit(ed),children:[(0,a.jsxs)(R.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"CreateBucketModal.tsx",children:[(0,a.jsx)(L.zB,{control:ea.control,name:"name",render:e=>{let{field:t}=e;return(0,a.jsx)(H.M,{label:"Name of bucket",labelOptional:"Buckets cannot be renamed once created.",description:"Only lowercase letters, numbers, dots, and hyphens",layout:"vertical",children:(0,a.jsx)(L.MJ,{children:(0,a.jsx)(M.p,{...t,placeholder:"Enter bucket name"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateBucketModal.tsx"}),(0,a.jsx)("div",{className:"flex flex-col gap-y-2 mt-6",children:(0,a.jsx)(L.zB,{control:ea.control,name:"type",render:e=>{let{field:t}=e;return(0,a.jsx)(H.M,{children:(0,a.jsx)(L.MJ,{children:(0,a.jsxs)(D.s,{id:"type",onValueChange:e=>t.onChange(e),value:t.value,children:[(0,a.jsx)(D.v,{value:"STANDARD",id:"STANDARD",label:"Standard bucket",showIndicator:!1,children:(0,a.jsx)("div",{className:"flex  gap-x-5",children:(0,a.jsx)("div",{className:"flex flex-col",children:(0,a.jsx)("p",{className:"text-foreground-light text-left",children:"Compatible with S3 buckets."})})})}),I.pe&&(0,a.jsxs)(D.v,{value:"ANALYTICS",id:"ANALYTICS",label:"Analytics bucket",showIndicator:!1,disabled:!eu,children:[(0,a.jsx)("div",{className:"flex  gap-x-5",children:(0,a.jsx)("div",{className:"flex flex-col",children:(0,a.jsx)("p",{className:"text-foreground-light text-left",children:"Stores Iceberg files and is optimized for analytical workloads."})})}),!eu&&(0,a.jsxs)("div",{className:"w-full flex gap-x-2 py-2 items-center",children:[(0,a.jsx)(z.id,{}),(0,a.jsxs)("span",{className:"text-xs text-left text-foreground-lighter",children:["This is currently in alpha and not enabled for your project. Sign up"," ",(0,a.jsx)(v.g,{href:"https://forms.supabase.com/analytics-buckets",children:"here"}),"."]})]})]})]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateBucketModal.tsx"})})]}),(0,a.jsx)(R.A.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"CreateBucketModal.tsx"}),er?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(R.A.Content,{className:"!px-0 !pb-0",children:(0,a.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,a.jsx)(L.zB,{control:ea.control,name:"public",render:e=>{let{field:t}=e;return(0,a.jsx)(H.M,{className:"px-5",children:(0,a.jsx)(L.MJ,{children:(0,a.jsx)(F.A,{id:"public",checked:t.value,onChange:t.onChange,layout:"flex",label:"Public bucket",descriptionText:"Anyone can read any object without any authorization"})})})}}),el&&(0,a.jsxs)(V.Z,{type:"warning",className:"rounded-none border-x-0 border-b-0 mb-0 [&>div>p]:!leading-normal",title:"Public buckets are not protected",children:[(0,a.jsx)("p",{className:"mb-2",children:"Users can read objects in public buckets without any authorization."}),(0,a.jsx)("p",{children:"Row level security (RLS) policies are still required for other operations such as object uploads and deletes."})]})]})}),(0,a.jsx)(R.A.Separator,{}),(0,a.jsxs)(O.Ay,{open:et,onOpenChange:()=>es(!et),children:[(0,a.jsx)(O.Ay.Trigger,{asChild:!0,children:(0,a.jsxs)("div",{className:"w-full cursor-pointer py-3 px-5 flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm",children:"Additional restrictions"}),(0,a.jsx)(h.A,{size:18,strokeWidth:2,className:(0,B.cn)("text-foreground-light",et&&"rotate-180")})]})}),(0,a.jsx)(O.Ay.Content,{className:"py-4",children:(0,a.jsxs)("div",{className:"w-full space-y-5 px-5",children:[(0,a.jsxs)("div",{className:"space-y-5",children:[(0,a.jsx)(L.zB,{control:ea.control,name:"has_file_size_limit",render:e=>{let{field:t}=e;return(0,a.jsx)(H.M,{children:(0,a.jsx)(L.MJ,{children:(0,a.jsx)(F.A,{id:"has_file_size_limit",checked:t.value,onChange:t.onChange,layout:"flex",label:"Restrict file upload size for bucket",descriptionText:"Prevent uploading of file sizes greater than a specified limit"})})})}}),ei&&(0,a.jsxs)("div",{className:"grid grid-cols-12 col-span-12 gap-x-2 gap-y-1",children:[(0,a.jsx)("div",{className:"col-span-8",children:(0,a.jsx)(L.zB,{control:ea.control,name:"formatted_size_limit",render:e=>{let{field:t}=e;return(0,a.jsxs)(H.M,{children:[(0,a.jsx)(L.MJ,{children:(0,a.jsx)(M.p,{type:"number",step:1,...t,onKeyPress:e=>{(e.charCode<48||e.charCode>57)&&e.preventDefault()}})}),(0,a.jsxs)("span",{className:"text-foreground-light text-xs",children:["Equivalent to"," ",(0,$.OG)(eo,X).toLocaleString()," ","bytes."]})]})}})}),(0,a.jsx)("div",{className:"col-span-4",children:(0,a.jsx)(W.A,{id:"size_limit_units",value:X,onChange:ee,children:Object.values(b.s2).map(e=>(0,a.jsx)(W.A.Option,{label:e,value:e,children:(0,a.jsx)("div",{children:e})},e))})}),I.pe&&(0,a.jsx)("div",{className:"col-span-12",children:(0,a.jsxs)("p",{className:"text-foreground-light text-sm",children:["Note: Individual bucket uploads will still be capped at the"," ",(0,a.jsx)(i(),{href:"/project/".concat(u,"/storage/settings"),className:"font-bold underline",children:"global upload limit"})," ","of ",Z]})})]})]}),(0,a.jsx)(L.zB,{control:ea.control,name:"allowed_mime_types",render:e=>{let{field:t}=e;return(0,a.jsx)(H.M,{label:"Allowed MIME types",labelOptional:"Comma separated values",description:"Wildcards are allowed, e.g. image/*. Leave blank to allow any MIME type.",layout:"vertical",children:(0,a.jsx)(L.MJ,{children:(0,a.jsx)(M.p,{...t,placeholder:"e.g image/jpeg, image/png, audio/mpeg, video/mp4, etc"})})})}})]})})]})]}):(0,a.jsx)(R.A.Content,{children:"installed"===ec?(0,a.jsxs)(U.J,{className:"text-foreground-lighter leading-1 flex flex-col gap-y-2",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{children:"Supabase will setup a "}),(0,a.jsxs)("a",{href:"".concat(I.o2,"/project/").concat(u,"/integrations/iceberg_wrapper/overview"),target:"_blank",className:"underline text-foreground-light",children:["foreign data wrapper",en&&(0,a.jsxs)("span",{className:"text-brand",children:[" ","".concat(en,"_fdw")]})]}),(0,a.jsxs)("span",{children:[" ","for easier access to the data. This action will also create"," ",(0,a.jsxs)("a",{href:"".concat(I.o2,"/project/").concat(u,"/storage/access-keys"),target:"_blank",className:"underline text-foreground-light",children:["S3 Access Keys",en&&(0,a.jsxs)(a.Fragment,{children:[" ","named ",(0,a.jsxs)("span",{className:"text-brand",children:[" ","".concat(en,"_keys")]})]})]}),(0,a.jsx)("span",{children:" and "}),(0,a.jsxs)("a",{href:"".concat(I.o2,"/project/").concat(u,"/integrations/vault/secrets"),target:"_blank",className:"underline text-foreground-light",children:["four Vault Secrets",en&&(0,a.jsxs)(a.Fragment,{children:[" ","prefixed with"," ",(0,a.jsxs)("span",{className:"text-brand",children:[" ","".concat(en,"_vault_")]})]})]}),"."]})]}),(0,a.jsxs)("p",{children:["As a final step, you'll need to create an"," ",(0,a.jsx)("span",{className:"text-foreground-light",children:"Iceberg namespace"})," before you connect the Iceberg data to your database."]})]}):(0,a.jsxs)(G.Fc,{variant:"warning",children:[(0,a.jsx)(z.id,{}),(0,a.jsx)(G.XL,{children:"You need to install the Iceberg wrapper extension to connect your Analytic bucket to your database."}),(0,a.jsx)(G.TN,{className:"flex flex-col gap-y-2",children:(0,a.jsxs)("p",{children:["You need to install the ",(0,a.jsx)("span",{className:"text-brand",children:"wrappers"})," extension (with the minimum version of ",(0,a.jsx)("span",{children:"0.5.3"}),") if you want to connect your Analytics bucket to your database."]})})]})}),(0,a.jsx)(R.A.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"CreateBucketModal.tsx"}),(0,a.jsxs)(R.A.Content,{className:"flex items-center space-x-2 justify-end","data-sentry-element":"unknown","data-sentry-source-file":"CreateBucketModal.tsx",children:[(0,a.jsx)(q.$,{type:"default",htmlType:"button",disabled:S||A,onClick:()=>r(),"data-sentry-element":"Button","data-sentry-source-file":"CreateBucketModal.tsx",children:"Cancel"}),(0,a.jsx)(q.$,{type:"primary",htmlType:"submit",loading:S||A,disabled:S||A,"data-sentry-element":"Button","data-sentry-source-file":"CreateBucketModal.tsx",children:"Create"})]})]})})})};var Q=s(27642),K=s(95708);async function Z(e){let{projectRef:t,id:s,isPublic:a,file_size_limit:n,allowed_mime_types:l}=e;if(!t)throw Error("projectRef is required");if(!s)throw Error("Bucket name is requried");let r={public:a};void 0!==n&&(r.file_size_limit=n),void 0!==l&&(r.allowed_mime_types=l);let{data:i,error:o}=await (0,S.F6)("/platform/storage/{ref}/buckets/{id}",{params:{path:{id:s,ref:t}},body:r});return o&&(0,S.H4)(o),i}let X=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,N.jE)();return(0,k.n)(e=>Z(e),{async onSuccess(t,s,n){let{projectRef:l}=s;await a.invalidateQueries(E.w.buckets(l)),await (null==e?void 0:e(t,s,n))},async onError(e,s,a){void 0===t?y.oR.error("Failed to update bucket: ".concat(e.message)):t(e,s,a)},...s})},ee=e=>{var t;let{visible:s,bucket:n,onClose:l}=e,{ref:r}=(0,d.g)(),{mutate:o,isLoading:u}=X({onSuccess:()=>{y.oR.success('Successfully updated bucket "'.concat(null==n?void 0:n.name,'"')),l()}}),{data:m}=(0,w.I)({projectRef:r},{enabled:I.pe&&s}),{value:x,unit:p}=(0,$.Jb)(null!=(t=null==m?void 0:m.fileSizeLimit)?t:0),f="".concat(x," ").concat(p),[g,j]=(0,c.useState)(b.s2.BYTES),[N,k]=(0,c.useState)(!1),S=async e=>void 0===n?console.error("Bucket is required"):void 0===r?console.error("Project ref is required"):void o({projectRef:r,id:n.id,isPublic:e.public,file_size_limit:e.has_file_size_limit?(0,$.OG)(e.formatted_size_limit,g):null,allowed_mime_types:e.allowed_mime_types.length>0?e.allowed_mime_types.split(",").map(e=>e.trim()):null});return(0,c.useEffect)(()=>{if(s){var e;let{unit:t}=(0,$.Jb)(null!=(e=null==n?void 0:n.file_size_limit)?e:0);j(t),k(!1)}},[s]),(0,a.jsx)(R.A,{hideFooter:!0,visible:s,size:"medium",header:'Edit bucket "'.concat(null==n?void 0:n.name,'"'),onCancel:l,"data-sentry-element":"Modal","data-sentry-component":"EditBucketModal","data-sentry-source-file":"EditBucketModal.tsx",children:(0,a.jsx)(Q.A,{validateOnBlur:!1,initialValues:{},validate:e=>{let t={};return e.has_file_size_limit&&e.formatted_size_limit<0&&(t.formatted_size_limit="File size upload limit has to be at least 0"),t},onSubmit:S,"data-sentry-element":"Form","data-sentry-source-file":"EditBucketModal.tsx",children:e=>{let{values:t,resetForm:o}=e,d=(null==n?void 0:n.public)!==t.public,m=(null==n?void 0:n.public)&&!t.public,x=!(null==n?void 0:n.public)&&t.public;return(0,c.useEffect)(()=>{if(s&&void 0!==n){var e,t,a;let{value:s}=(0,$.Jb)(null!=(e=n.file_size_limit)?e:0),l={name:null!=(t=n.name)?t:"",public:n.public,file_size_limit:n.file_size_limit,allowed_mime_types:(null!=(a=n.allowed_mime_types)?a:[]).join(", "),has_file_size_limit:null!==n.file_size_limit,formatted_size_limit:null!=s?s:0};o({values:l,initialValues:l})}},[s]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(R.A.Content,{className:(0,B.cn)("!px-0",d&&"!pb-0"),children:[(0,a.jsx)(K.A,{disabled:!0,id:"name",name:"name",type:"text",className:"w-full px-5",layout:"vertical",label:"Name of bucket",labelOptional:"Buckets cannot be renamed once created."}),(0,a.jsxs)("div",{className:(0,B.cn)("flex flex-col gap-y-2 mt-6"),children:[(0,a.jsx)(F.A,{id:"public",name:"public",layout:"flex",label:"Public bucket",className:"px-5",descriptionText:"Anyone can read any object without any authorization"}),d&&(0,a.jsxs)(V.Z,{type:"warning",className:"rounded-none border-x-0 border-b-0 mb-0 [&>div>p]:!leading-normal",title:x?"Warning: Making bucket public":m?"Warning: Making bucket private":"",children:[(0,a.jsx)("p",{children:x?"This will make all objects in your bucket publicly accessible.":m?"All objects in your bucket will be private and only accessible via signed URLs, or downloaded with the right authorisation headers.":""}),m&&(0,a.jsxs)("p",{children:["Assets cached in the CDN may still be publicly accessible. You can consider"," ",(0,a.jsx)(v.g,{href:"https://supabase.com/docs/guides/storage/cdn/smart-cdn#cache-eviction",children:"purging the cache"})," ","or moving your assets to a new bucket."]})]})]})]}),(0,a.jsxs)(O.Ay,{open:N,onOpenChange:()=>k(!N),children:[(0,a.jsx)(O.Ay.Trigger,{asChild:!0,children:(0,a.jsxs)("div",{className:"w-full cursor-pointer py-3 px-5 flex items-center justify-between border-t border-default",children:[(0,a.jsx)("p",{className:"text-sm",children:"Additional configuration"}),(0,a.jsx)(h.A,{size:18,strokeWidth:2,className:(0,B.cn)("text-foreground-light",N&&"rotate-180")})]})}),(0,a.jsx)(O.Ay.Content,{className:"py-4",children:(0,a.jsxs)("div",{className:"w-full space-y-4 px-5",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(F.A,{id:"has_file_size_limit",name:"has_file_size_limit",layout:"flex",label:"Restrict file upload size for bucket",descriptionText:"Prevent uploading of file sizes greater than a specified limit"}),t.has_file_size_limit&&(0,a.jsxs)("div",{className:"grid grid-cols-12 col-span-12 gap-x-2 gap-y-1",children:[(0,a.jsx)("div",{className:"col-span-8",children:(0,a.jsx)(K.A,{type:"number",step:1,id:"formatted_size_limit",name:"formatted_size_limit",disabled:!1,onKeyPress:e=>{(e.charCode<48||e.charCode>57)&&e.preventDefault()},descriptionText:"Equivalent to ".concat((0,$.OG)(t.formatted_size_limit,g).toLocaleString()," bytes.")})}),(0,a.jsx)("div",{className:"col-span-4",children:(0,a.jsx)(W.A,{id:"size_limit_units",disabled:!1,value:g,onChange:j,children:Object.values(b.s2).map(e=>(0,a.jsx)(W.A.Option,{label:e,value:e,children:(0,a.jsx)("div",{children:e})},e))})}),I.pe&&(0,a.jsx)("div",{className:"col-span-12 mt-2",children:(0,a.jsxs)("p",{className:"text-foreground-light text-sm",children:["Note: Individual bucket upload will still be capped at the"," ",(0,a.jsx)(i(),{href:"/project/".concat(r,"/storage/settings"),className:"font-bold underline",children:"global upload limit"})," ","of ",f]})})]})]}),(0,a.jsx)(K.A,{id:"allowed_mime_types",name:"allowed_mime_types",layout:"vertical",label:"Allowed MIME types",placeholder:"e.g image/jpeg, image/png, audio/mpeg, video/mp4, etc",labelOptional:"Comma separated values",descriptionText:"Wildcards are allowed, e.g. image/*. Leave blank to allow any MIME type."})]})})]}),(0,a.jsx)(R.A.Separator,{}),(0,a.jsxs)(R.A.Content,{className:"flex items-center space-x-2 justify-end",children:[(0,a.jsx)(q.$,{type:"default",disabled:u,onClick:()=>l(),children:"Cancel"}),(0,a.jsx)(q.$,{type:"primary",htmlType:"submit",loading:u,disabled:u,children:"Save"})]})]})}})})};async function et(e){let{projectRef:t,id:s}=e;if(!t)throw Error("projectRef is required");if(!s)throw Error("Bucket name is requried");let{data:a,error:n}=await (0,S.bE)("/platform/storage/{ref}/buckets/{id}/empty",{params:{path:{id:s,ref:t}}});return n&&(0,S.H4)(n),a}let es=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,N.jE)();return(0,k.n)(e=>et(e),{async onSuccess(t,s,n){let{projectRef:l}=s;await a.invalidateQueries(E.w.buckets(l)),await (null==e?void 0:e(t,s,n))},async onError(e,s,a){void 0===t?y.oR.error("Failed to empty bucket: ".concat(e.message)):t(e,s,a)},...s})};var ea=s(34424),en=s(50204);let el=e=>{let{visible:t=!1,bucket:s,onClose:n}=e,{ref:l}=(0,d.g)(),{fetchFolderContents:r}=(0,ea.$)(),{mutate:i,isLoading:o}=es({onSuccess:async()=>{void 0!==s&&(await r({bucketId:s.id,folderId:s.id,folderName:s.name,index:-1}),y.oR.success("Successfully deleted bucket ".concat(s.name)),n())}}),c=async()=>l?s?void i({projectRef:l,id:s.id}):console.error("No bucket is selected"):console.error("Project ref is required");return(0,a.jsx)(en.A,{variant:"destructive",size:"small",title:"Confirm to delete all contents from ".concat(null==s?void 0:s.name),confirmLabel:"Empty bucket",visible:t,loading:o,onCancel:()=>n(),onConfirm:c,alert:{title:"This action cannot be undone",description:"The contents of your bucket cannot be recovered once deleted"},"data-sentry-element":"ConfirmationModal","data-sentry-component":"EmptyBucketModal","data-sentry-source-file":"EmptyBucketModal.tsx",children:(0,a.jsxs)("p",{className:"text-sm",children:['Are you sure you want to empty the bucket "',null==s?void 0:s.name,'"?']})})};var er=s(88602),ei=s(90437),eo=s(86349),ec=s(75019),ed=s(5483),eu=s(43242),em=s(4601),ex=s(83927),ep=s.n(ex),eh=s(57624),ef=s(26587),ey=s(89080),eg=s(74680),ej=s(17089),eb=s(2119),ev=s(78721),ew=s(71139);let eN=e=>{let{bucket:t,projectRef:s="",isSelected:l=!1,onSelectEmptyBucket:r=ep(),onSelectDeleteBucket:o=ep(),onSelectEditBucket:c=ep()}=e,d=(0,ec.SE)(n.aG.STORAGE_WRITE,"*");return(0,a.jsxs)("div",{className:(0,B.cn)("group flex items-center justify-between rounded-md",l&&"text-foreground bg-surface-100"),"data-sentry-component":"BucketRow","data-sentry-source-file":"BucketRow.tsx",children:[(0,a.jsx)(i(),{href:"/project/".concat(s,"/storage/buckets/").concat(encodeURIComponent(t.id)),className:"py-1 px-3 grow","data-sentry-element":"Link","data-sentry-source-file":"BucketRow.tsx",children:(0,a.jsxs)("div",{className:"flex items-center justify-between space-x-2 truncate w-full",children:[(0,a.jsx)("p",{className:"text-sm group-hover:text-foreground transition truncate ".concat(l?"text-foreground":"text-foreground-light"),title:t.name,children:t.name}),t.public&&(0,a.jsx)(eb.E,{variant:"warning",children:"Public"}),"ANALYTICS"===t.type&&(0,a.jsxs)(ev.m_,{children:[(0,a.jsx)(ev.k$,{asChild:!0,children:(0,a.jsx)(eh.A,{className:"text-foreground-lighter",size:"20"})}),(0,a.jsx)(ev.ZI,{children:(0,a.jsx)("p",{children:"Analytics bucket"})})]})]})}),d&&l?(0,a.jsxs)(ew.rI,{children:[(0,a.jsx)(ew.ty,{asChild:!0,children:(0,a.jsx)(q.$,{type:"text",icon:(0,a.jsx)(ef.A,{}),className:"mr-1 h-6 w-6"})}),(0,a.jsxs)(ew.SQ,{side:"bottom",align:"start",children:["ANALYTICS"!==t.type&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(ew._2,{className:"space-x-2",onClick:()=>c(),children:[(0,a.jsx)(ey.A,{size:14}),(0,a.jsx)("p",{children:"Edit bucket"})]},"toggle-private"),(0,a.jsx)(ew.mB,{}),(0,a.jsxs)(ew._2,{className:"space-x-2",onClick:()=>r(),children:[(0,a.jsx)(eg.A,{size:14}),(0,a.jsx)("p",{children:"Empty bucket"})]},"empty-bucket")]}),(0,a.jsxs)(ew._2,{className:"space-x-2",onClick:()=>o(),children:[(0,a.jsx)(ej.A,{size:14}),(0,a.jsx)("p",{children:"Delete bucket"})]},"delete-bucket")]})]}):(0,a.jsx)("div",{className:"w-7 mr-1"})]},t.id)},ek=()=>{let e=(0,o.useRouter)(),{ref:t,bucketId:s}=(0,d.g)(),{data:r}=(0,ed.YA)(),m=(0,ea.$)(),x=(null==r?void 0:r.parent_project_ref)!==void 0,[p,h]=(0,c.useState)(""),[f,y]=(0,c.useState)(!1),[g,j]=(0,c.useState)(),[b,v]=(0,c.useState)(),[w,N]=(0,c.useState)(),k=(0,ec.SE)(n.aG.STORAGE_WRITE,"*"),S=e.pathname.split("/")[4],{data:E=[],error:A,isLoading:C,isError:_,isSuccess:T}=(0,eo.p)({projectRef:t}),P="alphabetical"===m.sortBucket?E.sort((e,t)=>e.name.toLowerCase().trim().localeCompare(t.name.toLowerCase().trim())):E.sort((e,t)=>new Date(t.created_at)>new Date(e.created_at)?-1:1),I=p.length>1?P.filter(e=>e.name.includes(p.trim())):P,R=(null==A?void 0:A.message.includes("Tenant config"))&&x;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(eu.Ay,{type:"pills",className:"mt-6 flex flex-grow flex-col","data-sentry-element":"Menu","data-sentry-source-file":"StorageMenu.tsx",children:[(0,a.jsxs)("div",{className:"mb-6 mx-5 flex flex-col gap-y-1.5",children:[(0,a.jsx)(er.G,{block:!0,type:"default",icon:(0,a.jsx)(l.A,{}),disabled:!k,style:{justifyContent:"start"},onClick:()=>y(!0),tooltip:{content:{side:"bottom",text:k?void 0:"You need additional permissions to create buckets"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"StorageMenu.tsx",children:"New bucket"}),(0,a.jsx)(em.a0,{className:"px-0","data-sentry-element":"InnerSideBarFilters","data-sentry-source-file":"StorageMenu.tsx",children:(0,a.jsx)(em.RK,{name:"search-buckets","aria-labelledby":"Search buckets",placeholder:"Search buckets...",value:p,onChange:e=>{h(e.target.value)},"data-sentry-element":"InnerSideBarFilterSearchInput","data-sentry-source-file":"StorageMenu.tsx",children:(0,a.jsxs)(em.i9,{value:m.sortBucket,onValueChange:e=>m.setSortBucket(e),"data-sentry-element":"InnerSideBarFilterSortDropdown","data-sentry-source-file":"StorageMenu.tsx",children:[(0,a.jsx)(em.Pl,{value:"alphabetical",className:"flex gap-2","data-sentry-element":"InnerSideBarFilterSortDropdownItem","data-sentry-source-file":"StorageMenu.tsx",children:"Alphabetical"},"alphabetical"),(0,a.jsx)(em.Pl,{value:"created-at","data-sentry-element":"InnerSideBarFilterSortDropdownItem","data-sentry-source-file":"StorageMenu.tsx",children:"Created at"},"created-at")]})})})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"mx-3",children:[(0,a.jsx)(eu.Ay.Group,{title:(0,a.jsx)("span",{className:"uppercase font-mono",children:"All buckets"}),"data-sentry-element":"unknown","data-sentry-source-file":"StorageMenu.tsx"}),C&&(0,a.jsxs)("div",{className:"space-y-2 mx-2",children:[(0,a.jsx)(ei.A,{className:"!py-2.5"}),(0,a.jsx)(ei.A,{className:"!py-2.5"}),(0,a.jsx)(ei.A,{className:"!py-2.5"})]}),_&&(0,a.jsx)("div",{className:"px-2",children:(0,a.jsxs)(G.Fc,{variant:R?"default":"warning",children:[(0,a.jsx)(G.XL,{className:"text-xs tracking-normal",children:R?"Storage is not available on preview branches for now":"Failed to fetch buckets"}),(0,a.jsx)(G.TN,{className:"text-xs",children:R?"We're actively looking into making this available on preview branches":"Please refresh to try again"})]})}),T&&(0,a.jsxs)(a.Fragment,{children:[0===E.length&&(0,a.jsx)(em.Q5,{className:"mx-2",title:"No buckets available",description:"Buckets that you create will appear here"}),p.length>0&&0===I.length&&(0,a.jsx)(em.Q5,{className:"mx-2",title:"No results found",description:'Your search for "'.concat(p,'" did not return any results')}),I.map((e,n)=>{let l=s===e.id;return(0,a.jsx)(eN,{bucket:e,projectRef:t,isSelected:l,onSelectEmptyBucket:()=>v(e),onSelectDeleteBucket:()=>N(e),onSelectEditBucket:()=>j(e)},"".concat(n,"_").concat(e.id))})]})]}),(0,a.jsxs)("div",{className:"w-full bg-dash-sidebar px-3 py-6 sticky bottom-0 border-t border-border",children:[(0,a.jsx)(eu.Ay.Group,{title:(0,a.jsx)("span",{className:"uppercase font-mono",children:"Configuration"}),"data-sentry-element":"unknown","data-sentry-source-file":"StorageMenu.tsx"}),(0,a.jsx)(i(),{href:"/project/".concat(t,"/storage/policies"),"data-sentry-element":"Link","data-sentry-source-file":"StorageMenu.tsx",children:(0,a.jsx)(eu.Ay.Item,{rounded:!0,active:"policies"===S,"data-sentry-element":"unknown","data-sentry-source-file":"StorageMenu.tsx",children:(0,a.jsx)("p",{className:"truncate",children:"Policies"})})}),(0,a.jsx)(i(),{href:"/project/".concat(t,"/storage/settings"),"data-sentry-element":"Link","data-sentry-source-file":"StorageMenu.tsx",children:(0,a.jsx)(eu.Ay.Item,{rounded:!0,active:"settings"===S,"data-sentry-element":"unknown","data-sentry-source-file":"StorageMenu.tsx",children:(0,a.jsx)("p",{className:"truncate",children:"Settings"})})})]})]})]}),(0,a.jsx)(J,{visible:f,onClose:()=>y(!1),"data-sentry-element":"CreateBucketModal","data-sentry-source-file":"StorageMenu.tsx"}),(0,a.jsx)(ee,{visible:void 0!==g,bucket:g,onClose:()=>j(void 0),"data-sentry-element":"EditBucketModal","data-sentry-source-file":"StorageMenu.tsx"}),(0,a.jsx)(el,{visible:void 0!==b,bucket:b,onClose:()=>v(void 0),"data-sentry-element":"EmptyBucketModal","data-sentry-source-file":"StorageMenu.tsx"}),(0,a.jsx)(u.vd,{visible:void 0!==w,bucket:w,onClose:()=>N(void 0),"data-sentry-element":"DeleteBucketModal","data-sentry-source-file":"StorageMenu.tsx"})]})};var eS=s(52361),eE=s(7737);let eA=(0,eS.r)(e=>{let{title:t,children:s}=e;return(0,a.jsx)(eE.A,{stickySidebarBottom:!0,title:t||"Storage",product:"Storage",productMenu:(0,a.jsx)(ek,{}),"data-sentry-element":"ProjectLayout","data-sentry-component":"StorageLayout","data-sentry-source-file":"StorageLayout.tsx",children:s})})},85278:(e,t,s)=>{s.d(t,{I:()=>o});var a=s(56947),n=s(65172),l=s(47114),r=s(63492);async function i(e,t){let{projectRef:s}=e;if(!s)throw Error("projectRef is required");let{data:a,error:l}=await (0,n.Jt)("/platform/projects/{ref}/config/storage",{params:{path:{ref:s}},signal:t});return l&&(0,n.H4)(l),a}let o=function(e){let{projectRef:t}=e,{enabled:s=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(l.n.storage(t),e=>{let{signal:s}=e;return i({projectRef:t},s)},{enabled:s&&r.pe&&void 0!==t,...n})}},91435:(e,t,s)=>{s.d(t,{z:()=>d});var a=s(89811),n=s(56947),l=s(65172),r=s(5483),i=s(63492),o=s(28140);async function c(e,t,s){let{projectRef:n,connectionString:r}=e;if(!n)throw Error("projectRef is required");let i=new Headers(s);r&&i.set("x-connection-encrypted",r);let{data:o,error:c}=await (0,l.Jt)("/platform/pg-meta/{ref}/extensions",{params:{header:{"x-connection-encrypted":r,"x-pg-application-name":a.r},path:{ref:n}},headers:i,signal:t});return c&&(0,l.H4)(c),o}let d=function(e){let{projectRef:t,connectionString:s}=e,{enabled:a=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:d}=(0,r.YA)(),u=(null==d?void 0:d.status)===i.BU.ACTIVE_HEALTHY;return(0,n.I)(o.I.list(t),e=>{let{signal:a}=e;return c({projectRef:t,connectionString:s},a)},{enabled:a&&void 0!==t&&u,...l})}},98969:(e,t,s)=>{s.d(t,{A:()=>l});var a=s(80263),n=s(87610);let l=e=>{let{resourceText:t,isFullPage:s=!1}=e,l=()=>(0,a.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200","data-sentry-component":"NoPermissionMessage","data-sentry-source-file":"NoPermission.tsx",children:(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)(n.A,{size:20,"data-sentry-element":"AlertCircle","data-sentry-source-file":"NoPermission.tsx"})}),(0,a.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",t]}),(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return s?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsx)("div",{className:"w-[550px]",children:(0,a.jsx)(l,{})})}):(0,a.jsx)(l,{})}}}]);